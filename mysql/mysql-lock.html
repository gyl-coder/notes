


<!DOCTYPE html>
<html lang="en" class="with-v3-banner">
  <head>
    <title>Mysql ÈîÅÁõ∏ÂÖ≥ ‚Äî Notes</title>
    <meta charset="utf-8">
    <meta name="description" content="Notes - Personal review warehouse">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <link rel="alternate" hreflang="x-default" href="https://vuejs.org/mysql/mysql-lock.html">
    <link rel="alternate" hreflang="zh" href="https://cn.vuejs.org/mysql/mysql-lock.html">
    <link rel="alternate" hreflang="ja" href="https://jp.vuejs.org/mysql/mysql-lock.html">
    <link rel="alternate" hreflang="ru" href="https://ru.vuejs.org/mysql/mysql-lock.html">
    <link rel="alternate" hreflang="ko" href="https://kr.vuejs.org/mysql/mysql-lock.html">
    <link rel="alternate" hreflang="pt-BR" href="https://br.vuejs.org/mysql/mysql-lock.html">
    <link rel="alternate" hreflang="fr" href="https://fr.vuejs.org/mysql/mysql-lock.html">
    <link rel="alternate" hreflang="es" href="https://es.vuejs.org/mysql/mysql-lock.html">

    <meta property="og:type" content="article">
    <meta property="og:title" content="Mysql ÈîÅÁõ∏ÂÖ≥ ‚Äî Notes">
    <meta property="og:description" content="Notes - Personal review warehouse">
    <meta property="og:image" content="https://vuejs.org//images/logo.png">

    <meta name="twitter:card" content="summary">
    <meta name="twitter:title" content="Mysql ÈîÅÁõ∏ÂÖ≥ ‚Äî Notes">
    <meta name="twitter:description" content="Notes - Personal review warehouse">
    <meta name="twitter:image" content="https://vuejs.org/images/logo.png">

    <link rel="apple-touch-icon" sizes="57x57" href="/images/icons/apple-icon-57x57.png">
    <link rel="apple-touch-icon" sizes="60x60" href="/images/icons/apple-icon-60x60.png">
    <link rel="apple-touch-icon" sizes="72x72" href="/images/icons/apple-icon-72x72.png">
    <link rel="apple-touch-icon" sizes="76x76" href="/images/icons/apple-icon-76x76.png">
    <link rel="apple-touch-icon" sizes="114x114" href="/images/icons/apple-icon-114x114.png">
    <link rel="apple-touch-icon" sizes="120x120" href="/images/icons/apple-icon-120x120.png">
    <link rel="apple-touch-icon" sizes="144x144" href="/images/icons/apple-icon-144x144.png">
    <link rel="apple-touch-icon" sizes="152x152" href="/images/icons/apple-icon-152x152.png">
    <link rel="apple-touch-icon" sizes="180x180" href="/images/icons/apple-icon-180x180.png">
    <link rel="icon" type="image/png" sizes="192x192"  href="/images/icons/android-icon-192x192.png">
    <link rel="icon" type="image/png" sizes="32x32" href="/images/icons/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="96x96" href="/images/icons/favicon-96x96.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/images/icons/favicon-16x16.png">
    <meta name="msapplication-TileImage" content="/images/icons/ms-icon-144x144.png">
    <link rel="icon" href="/images/logo.png" type="image/png">

    <meta name="msapplication-TileColor" content="#4fc08d">
    <meta name="theme-color" content="#4fc08d">

    <meta name="msapplication-config" content="browserconfig.xml">
    <link rel="manifest" href="/manifest.json">

    <link href="https://fonts.googleapis.com" rel="preconnect" crossorigin>
    <link href="https://fonts.gstatic.com" rel="preconnect" crossorigin>
    <link href="https://maxcdn.bootstrapcdn.com" rel="preconnect" crossorigin>

    <link href="https://fonts.googleapis.com/css?family=Source+Sans+Pro:300,400,600|Roboto Mono&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css?family=Dosis:500&text=Vue.js&display=swap" rel="stylesheet">

    <link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" rel="stylesheet">

    <!-- main page styles -->
    
<link rel="stylesheet" href="/css/page.css">


    <!-- this needs to be loaded before guide's inline scripts -->
    <script src="/js/vue.js"></script>

    

    <script>
      Vue.config.productionTip = false
      window.PAGE_TYPE = "api"
    </script>

    <!-- ga -->
    <script>
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

      ga('create', 'UA-46852172-1', 'vuejs.org');
      ga('send', 'pageview');
    </script>

    <!-- vimeo analytics -->
    <script type="text/javascript" defer="defer" src="https://extend.vimeocdn.com/ga/72160148.js"></script>
  <meta name="generator" content="Hexo 5.4.0"></head>
  <body class="docs">
    <div id="mobile-bar" >
      <a class="menu-button"></a>
      <a class="logo" href="/"></a>
    </div>
    <div>
  <div id="v3-banner">
    <span class="hidden-sm">Welcome to yanliang's notes</span>
  </div>

  <header id="header">
    <a id="logo" href="/">
      <img src="/images/logo.png" alt="vue logo">
      <span>Notes - personal review warehouse</span>
    </a>
    <ul id="nav">
      <li>
  <form id="search-form">
    <input type="text" id="search-query-nav" class="search-query st-default-search-input" aria-label="Search">
  </form>
</li>
<li class="nav-dropdown-container learn">
  <a class="nav-link">‚≠êÔ∏èJava</a><span class="arrow"></span>
  <ul class="nav-dropdown">
    <li><h4>Documentation</h4></li>
    <li>
      <ul>
        <li><a href="/java/oop/" class="nav-link">OOP</a></li>
        <li><a href="/v2/api/" class="nav-link">API</a></li>
        <li><a href="/v2/style-guide/" class="nav-link">Style Guide</a></li>
        <li><a href="/v2/examples/" class="nav-link">Examples</a></li>
        <li><a href="/v2/cookbook/" class="nav-link">Cookbook</a></li>
      </ul>
    </li>
    <li><h4>Video Courses</h4></li>
    <li>
      <ul>
        <li>
          <a href="https://www.vuemastery.com/courses/" class="nav-link" target="_blank" rel="sponsored noopener">
            Vue Mastery
          </a>
        </li>
        <li>
          <a
            href="https://vueschool.io/?friend=vuejs&utm_source=Vuejs.org&utm_medium=Link&utm_content=Navbar%20Dropdown"
            class="nav-link"
            target="_blank" rel="sponsored noopener"
          >
            Vue School
          </a>
        </li>
      </ul>
    </li>
  </ul>
</li>

<li class="nav-dropdown-container learn">
  <a class="nav-link">ÁΩëÁªú</a><span class="arrow"></span>
  <ul class="nav-dropdown">
    <!-- <li><h4>Documentation</h4></li> -->
    <li>
      <ul>
        <li><a href="/network">Review List</a></li>
        <li><a href="/network/tcp/">üî•TCP</a></li>
        <li><a href="/network/http/">HTTP</a></li>
        <li><a href="/network/ip/">IP</a></li>
      </ul>
    </li>
    <li><h4>Video Courses</h4></li>
    <li>
      <ul>
        <li>
          <a href="https://www.vuemastery.com/courses/" class="nav-link" target="_blank" rel="sponsored noopener">
            Vue Mastery
          </a>
        </li>
        <li>
          <a
            href="https://vueschool.io/?friend=vuejs&utm_source=Vuejs.org&utm_medium=Link&utm_content=Navbar%20Dropdown"
            class="nav-link"
            target="_blank" rel="sponsored noopener"
          >
            Vue School
          </a>
        </li>
      </ul>
    </li>
  </ul>
</li>

<li>
  <a href="/os/">Êìç‰ΩúÁ≥ªÁªü</a>
</li>
<li>
  <a href="/mysql/">üíºÊï∞ÊçÆÂ∫ì</a>
</li>
<li>
  <a target="_blank" rel="noopener" href="https://codetop.cc/#/home">‚ù§Ô∏èÁÆóÊ≥ï</a>
</li>
<li class="nav-dropdown-container resources">
  <a href="#" class="nav-link">Resources</a><span class="arrow"></span>
  <ul class="nav-dropdown">
    <li><a href="/resources/partners.html" class="nav-link">Partners</a></li>
    <li><a href="/resources/themes.html" class="nav-link">Themes</a></li>
    <li><a href="https://github.com/vuejs/awesome-vue" class="nav-link" target="_blank" rel="noopener">Awesome Vue</a></li>
    <li><a href="https://awesomejs.dev/for/vue/" class="nav-link" target="_blank" rel="noopener">Browse packages for Vue</a></li>
  </ul>
</li>

<!-- <li>
  <a href="/partners" class="nav-link ">Partners</a>
</li> -->
<li class="nav-dropdown-container support-vue">
  <a href="/support-vuejs/" class="nav-link">Support Vue</a><span class="arrow"></span>
  <ul class="nav-dropdown">
    <li><a href="/support-vuejs/#One-time-Donations" class="nav-link">One-time Donations</a></li>
    <li><a href="/support-vuejs/#Recurring-Pledges" class="nav-link">Recurring Pledges</a></li>
    <li><a href="https://vue.threadless.com" target="_blank" rel="noopener" class="nav-link">T-Shirt Shop</a></li>
  </ul>
</li>

<li class="nav-dropdown-container language">
  <a class="nav-link">Translations</a><span class="arrow"></span>
  <ul class="nav-dropdown">
    <li><a target="_blank" rel="noopener" href="https://cn.vuejs.org/mysql/mysql-lock.html" class="nav-link">‰∏≠Êñá</a></li>
    <li><a target="_blank" rel="noopener" href="https://jp.vuejs.org/mysql/mysql-lock.html" class="nav-link">Êó•Êú¨Ë™û</a></li>
    <li><a target="_blank" rel="noopener" href="https://ru.vuejs.org/mysql/mysql-lock.html" class="nav-link">–†—É—Å—Å–∫–∏–π</a></li>
    <li><a target="_blank" rel="noopener" href="https://kr.vuejs.org/mysql/mysql-lock.html" class="nav-link">ÌïúÍµ≠Ïñ¥</a></li>
    <li><a target="_blank" rel="noopener" href="https://br.vuejs.org/mysql/mysql-lock.html" class="nav-link">Portugu√™s</a></li>
    <li><a target="_blank" rel="noopener" href="https://fr.vuejs.org/mysql/mysql-lock.html" class="nav-link">Fran√ßais</a></li>
    <li><a target="_blank" rel="noopener" href="https://vi.vuejs.org/mysql/mysql-lock.html" class="nav-link">Ti·∫øng Vi·ªát</a></li>
    <li><a target="_blank" rel="noopener" href="https://es.vuejs.org/mysql/mysql-lock.html" class="nav-link">Espa√±ol</a></li>
    <li><a target="_blank" rel="noopener" href="https://docs.vuejs.id/mysql/mysql-lock.html" class="nav-link">Bahasa Indonesia</a></li>
  </ul>
</li>


    </ul>
  </header>
</div>

    
      <div id="main" class="fix-sidebar">
        
  

<div class="sidebar">
  <div class="sidebar-inner">
    
    <div class="list">
      <!-- <div id="sidebar-sponsors-special">
  <div class="main-sponsor">
    <span>Special Sponsor</span>
    <div>
    <a href="https://autocode.com/" target="_blank" rel="sponsored noopener" class="logo">
      <img src="/images/autocode.svg" alt="Autocode">
    </a>
    </div>
  </div>
</div>

 -->
      
        <!-- <h2>
          
          API
          
            <select class="version-select">
              <option value="v3">3.x</option>
              <option value="SELF" selected>2.x</option>
              <option value="v1">1.0</option>
              <option value="012">0.12</option>
              <option value="011">0.11</option>
            </select>
          
        </h2> -->
        <ul class="menu-root">
  
</ul>

      
    </div>
  </div>
</div>
<!-- 
<div id="sidebar-sponsors-platinum-right">
  <div class="main-sponsor">
    <span>Platinum Sponsors</span>
    <div>
    <a href="https://vueschool.io/?utm_source=Vuejs.org&utm_medium=Banner&utm_campaign=Sponsored%20Banner&utm_content=V1" target="_blank" rel="sponsored noopener" class="logo">
      <img src="/images/vueschool.png" alt="VueSchool">
    </a>
    <a href="https://vehikl.com/" target="_blank" rel="sponsored noopener" class="logo">
      <img src="/images/vehikl.png" alt="Vehikl">
    </a>
    <a href="https://retool.com/?utm_source=sponsor&utm_campaign=vue" target="_blank" rel="sponsored noopener" class="logo">
      <img src="/images/retool.png" alt="Retool">
    </a>
    <a href="https://passionatepeople.io/" target="_blank" rel="sponsored noopener" class="logo">
      <img src="/images/passionate_people.png" alt="Passionate People">
    </a>
    <a href="https://www.storyblok.com" target="_blank" rel="sponsored noopener" class="logo">
      <img src="/images/storyblok.png" alt="Storyblok">
    </a>
    <a href="https://ionicframework.com/vue?utm_source=partner&utm_medium=referral&utm_campaign=vuesponsorship&utm_content=vuedocs" target="_blank" rel="sponsored noopener" class="logo">
      <img src="/images/ionic.png" alt="Ionic">
    </a>
    <a href="https://nuxtjs.org/" target="_blank" rel="sponsored noopener" class="logo">
      <img src="/images/nuxt.png" alt="Nuxt">
    </a>
    </div>
  </div>
  <a class="become-backer" href="/support-vuejs">
    Become a Sponsor
  </a>
</div>

 -->


<div class="content api with-sidebar ">
  <p class="tip warning v3-warning">
    Welcome to yanliang's notes.
  </p>

  
    
      
<div id="ad">
  <script
    async
    type="text/javascript"
    src="//cdn.carbonads.com/carbon.js?serve=CEBDT27Y&placement=vuejsorg"
    id="_carbonads_js">
  </script>
</div>


    
  
  
    <h1>Mysql ÈîÅÁõ∏ÂÖ≥</h1>
  
  
    <h2 id="Mysql-ÈîÅ"><a href="#Mysql-ÈîÅ" class="headerlink" title="Mysql ÈîÅ"></a>Mysql ÈîÅ</h2><p>Âπ∂Âèë‰∫ãÂä°ËÆøÈóÆÁõ∏ÂêåËÆ∞ÂΩïÁöÑÊÉÖÂÜµÂ§ßËá¥ÂèØ‰ª•ÂàÜ‰∏∫‰∏âÁßçÔºöËØªËØª„ÄÅËØªÂÜôÂíåÂÜôÂÜô„ÄÇ</p>
<p>ËØªËØªÁöÑÊÉÖÂÜµÂπ∂‰∏ç‰ºö‰∫ßÁîüÂπ∂ÂèëÈóÆÈ¢òÔºåÁúüÊ≠£‰ºö‰∫ßÁîüÈóÆÈ¢òÁöÑÊòØÂπ∂ÂèëÁöÑËØªÂÜôÊàñËÄÖÂÜôÂÜô„ÄÇÂπ∂ÂèëÁöÑÂÜôÂÜôÂèØËÉΩ‰ºö‰∫ßÁîüËÑèÂÜôÂíå‰∏¢Â§±Êõ¥Êñ∞ÁöÑÈóÆÈ¢òÔºåÁî±‰∫éËøôÁ±ªÈóÆÈ¢òÊØîËæÉ‰∏•ÈáçÔºåÊï∞ÊçÆÂ∫ì‰ºöÈÄöËøáÂä†ÈîÅÁöÑÊñπÂºèÈòªÂ°ûÂπ∂ÂèëÁöÑ‰øÆÊîπÔºåÂõ†Ê≠§Âú®‰ªª‰ΩïÈöîÁ¶ªÁ∫ßÂà´‰∏ãÊï∞ÊçÆÂ∫ìÈÉΩ‰∏ç‰ºöÂá∫Áé∞ËÑèÂÜôÂíå‰∏¢Â§±Êõ¥Êñ∞ÁöÑÊÉÖÂÜµÔºå‰ΩÜÊòØÂú®Â∫îÁî®Â±ÇÈù¢ÔºåËøòÊòØÊúâÂèØËÉΩÂá∫Áé∞ÈÄªËæëÊÑè‰πâ‰∏äÁöÑ‰∏¢Â§±Êõ¥Êñ∞„ÄÇ</p>
<p>Âπ∂ÂèëÁöÑËØªÂÜôÂèØËÉΩ‰ºö‰∫ßÁîüËÑèËØª„ÄÅ‰∏çÂèØÈáçÂ§çËØª‰ª•ÂèäÂπªËØªÁöÑÈóÆÈ¢ò„ÄÇÂ§ÑÁêÜËøôÁ±ªÈóÆÈ¢òÊúâ‰∏§ÁßçÂèØÈÄâÁöÑÊñπÊ°àÔºå‰∏ÄÁßçÊòØÂØπÂÜôÊìç‰ΩúÂä†ÈîÅÔºåËØªÊìç‰ΩúÂàôÂà©Áî® MVCC Êú∫Âà∂„ÄÇ</p>
<p>Âú® READ COMMITTED ÈöîÁ¶ªÁ∫ßÂà´‰∏≠Ôºå‰∏Ä‰∏™‰∫ãÂä°‰∏≠ÊØèÊ¨°ÊâßË°åÊôÆÈÄöÁöÑ SELECT Êìç‰ΩúÈÉΩ‰ºöÁîüÊàê‰∏Ä‰∏™ ReadViewÔºåËøôÊ†∑Â∞±‰øùËØÅ‰∫ÜÊØèÊ¨°ÁöÑËØªÊìç‰ΩúÈÉΩÂè™ËÉΩËØªÂà∞Â∑≤ÁªèÊèê‰∫§ÁöÑ‰∫ãÂä°ÁöÑÊõ¥Êîπ„ÄÇËÄåÂú® REPEATABLE READ ÈöîÁ¶ªÁ∫ßÂà´‰∏≠Ôºå‰∏Ä‰∏™‰∫ãÂä°‰∏≠Âè™ÊúâÁ¨¨‰∏ÄÊ¨°ÊâßË°åÊôÆÈÄöÁöÑ SELECT Êìç‰ΩúÊâç‰ºöÁîüÊàê‰∏Ä‰∏™ ReadViewÔºå‰πãÂêéÁöÑËØªÊìç‰ΩúÈÉΩ‰ºöÂ§çÁî®ËØ• ReadViewÔºåÂõ†Ê≠§‰πüÂ∞±ÈÅøÂÖç‰∫Ü‰∏çÂèØÈáçÂ§çËØªÂíåÂπªËØªÁöÑÈóÆÈ¢ò„ÄÇ</p>
<p>Âè¶‰∏ÄÁßçÂ∞±ÊòØÂØπËØªÊìç‰ΩúÂíåÂÜôÊìç‰ΩúÈÉΩÂä†ÈîÅÔºåÂ¶ÇÊûú‰∏Ä‰∫õ‰∏öÂä°Âú∫ÊôØ‰∏≠‰∏çÂÖÅËÆ∏ËØªÂèñËÆ∞ÂΩïÁöÑÊóßÁâàÊú¨ÔºåËÄåÊòØÊØèÊ¨°ÈÉΩÈúÄË¶ÅËØªÂèñËÆ∞ÂΩïÁöÑÊúÄÊñ∞ÁâàÊú¨ÔºåÈÇ£‰πàÂ∞±ÈúÄË¶ÅÂú®ËØªÁöÑÊó∂ÂÄôÂä†ÈîÅÔºåÂêåÊó∂ÂÜôÊìç‰Ωú‰πüÈúÄË¶ÅÂä†ÈîÅÔºåËøô‰πüÂ∞±ÊÑèÂë≥ÁùÄËØªÂÜôÊìç‰Ωú‰πüÂÉèÂÜôÂÜôÊìç‰ΩúÈÇ£Ê†∑ÊéíÈòüÊâßË°å„ÄÇÂæàÊòéÊòæÔºåÂõ†‰∏∫‰ΩøÁî® MVCC ÂèØ‰ª•‰ΩøËØªÂÜôÊìç‰ΩúÂπ∂ÂèëÊâßË°åÔºåÂõ†Ê≠§ÊÄßËÉΩÊõ¥Â•Ω„ÄÇÂú®‰∏ÄËà¨ÊÉÖÂÜµ‰∏ãÔºåÊàë‰ª¨ÈÉΩÈááÁî®ÈªòËÆ§ÁöÑÊñπÂºèÔºå‰πüÂ∞±ÊòØËØªÊìç‰ΩúÂà©Áî® MVCCÔºåÂÜôÊìç‰ΩúÂä†ÈîÅ„ÄÇÂΩì‰∏Ä‰∫õ‰∏öÂä°ÈúÄË¶ÅÁöÑÊó∂ÂÄôÔºåÂÜçÊâãÂä®ÁªôËØªÊìç‰ΩúÂä†ÈîÅ„ÄÇ</p>
<h3 id="MySQL-‰∏≠ÁöÑÊï∞ÊçÆÊìç‰Ωú"><a href="#MySQL-‰∏≠ÁöÑÊï∞ÊçÆÊìç‰Ωú" class="headerlink" title="MySQL ‰∏≠ÁöÑÊï∞ÊçÆÊìç‰Ωú"></a>MySQL ‰∏≠ÁöÑÊï∞ÊçÆÊìç‰Ωú</h3><p><a target="_blank" rel="noopener" href="https://zhuanlan.zhihu.com/p/141862443">https://zhuanlan.zhihu.com/p/141862443</a></p>
<p>Âú® MySQL ‰∏≠ÔºåËØªÊìç‰ΩúÂàÜ‰∏∫‰∏§Áßç„ÄÇ‰∏ÄÁßçÊòØÂø´ÁÖßËØªÔºàSnapshot ReadÔºâÔºå‰πüÂè´ÂÅö‰∏ÄËá¥ÊÄßËØªÔºàConsistent ReadÔºâÊàñËÄÖ‰∏ÄËá¥ÊÄßÊó†ÈîÅËØª„ÄÇÂø´ÁÖßËØªÈÄöËøá MySQL ÁöÑ MVCC Êú∫Âà∂ÂÆûÁé∞Ôºå‰∏çÈúÄË¶ÅÂä†ÈîÅÔºåËØªÂèñÁöÑÊòØÂΩìÂâçËÆ∞ÂΩïÁöÑÂø´ÁÖß„ÄÇÊâÄÊúâÊôÆÈÄöÁöÑ SELECTÔºàplain SELECTÔºâËØ≠Âè•Âú®ËØªÊèê‰∫§ÂíåÂèØÈáçÂ§çËØªÈöîÁ¶ªÁ∫ßÂà´‰∏ãÈÉΩÊòØÂø´ÁÖßËØª„ÄÇ</p>
<p>Âè¶‰∏ÄÁßçÂ∞±ÊòØÈîÅÂÆöËØªÔºàLocking ReadÔºâÔºå‰πüÂè´ÂÅöÂΩìÂâçËØªÔºàCurrent ReadÔºâ„ÄÇÂΩìÂâçËØªÂèØ‰ª•Áúã‰ΩúÊòØ‰∏ÄÁßçÁâπÊÆäÁöÑËØªÊìç‰ΩúÔºåÂÆÉËØªÂèñÁöÑÊòØÊúÄÊñ∞ÁöÑËÆ∞ÂΩïÔºåÂåÖÊã¨ÈöêÂê´ÂΩìÂâçËØªÈÄªËæëÁöÑÊèíÂÖ•„ÄÅÊõ¥Êñ∞ÂíåÂà†Èô§Ôºå‰ª•Âèä‰∏Ä‰∫õÊâãÂ∑•Ê∑ªÂä†ÈîÅÁöÑËØªÈÉΩÊòØÂΩìÂâçËØª„ÄÇ‰ΩøÁî® <code>SELECT ... LOCK IN SHARE MODE</code> ËØ≠Âè•‰ºö‰∏∫ËØªÂèñÂà∞ÁöÑÊï∞ÊçÆÂä†ÂÖ• S ÈîÅÔºåËøôÊ†∑Âà´ÁöÑ‰∫ãÂä°ÂèØ‰ª•ÁªßÁª≠Ëé∑ÂèñËøô‰∫õËÆ∞ÂΩïÁöÑ S ÈîÅÔºå‰ΩÜÊòØ‰∏çËÉΩËé∑ÂèñËøô‰∫õËÆ∞ÂΩïÁöÑ X ÈîÅ„ÄÇ‰ΩøÁî® <code>SELECT ... FOR UPDATE</code> ËØ≠Âè•‰ºö‰∏∫ËØªÂèñÂà∞ÁöÑÊï∞ÊçÆÂä†ÂÖ• X ÈîÅÔºåËøôÊ†∑Âà´ÁöÑ‰∫ãÂä°Â∞±Êó†Ê≥ïÂÜçËé∑ÂèñËøô‰∫õËÆ∞ÂΩïÁöÑ S ÈîÅÂíå X ÈîÅ„ÄÇ</p>
<p>Âú® MySQL ‰∏≠ÔºåÂÜôÊìç‰ΩúÊó†ÈùûÂ∞±ÊòØ DELETE„ÄÅUPDATE Âíå INSERT Ëøô‰∏âÁßç„ÄÇÂØπ‰∏ÄÊù°ËÆ∞ÂΩïËøõË°å DELETE Êìç‰ΩúÁöÑËøáÁ®ãÂÆûÈôÖ‰∏äÊòØÂÖàÂú® B+Ê†ë‰∏≠ÂÆö‰ΩçÂà∞ËøôÊù°ËÆ∞ÂΩïÁöÑ‰ΩçÁΩÆÔºåÁÑ∂ÂêéËé∑ÂèñËØ•ËÆ∞ÂΩïÁöÑ X ÈîÅÔºåÊúÄÂêéÂÜçÊâßË°åËÆæÁΩÆÂà†Èô§Ê†áËÆ∞‰ΩçÁöÑÊìç‰Ωú„ÄÇÂõ†Ê≠§Êàë‰ª¨ÂèØ‰ª•ÊääÂà†Èô§Êìç‰ΩúÁúã‰ΩúÊòØ‰∏Ä‰∏™Ëé∑Âèñ X ÈîÅÁöÑÈîÅÂÆöËØª„ÄÇ</p>
<p>ÂØπ‰∏ÄÊù°ËÆ∞ÂΩïËøõË°å UPDATE Êìç‰ΩúÊó∂ÂèØ‰ª•ÂàÜ‰∏∫‰∏âÁßçÊÉÖÂÜµ„ÄÇÁ¨¨‰∏ÄÁßçÂ∞±ÊòØÊ≤°Êúâ‰øÆÊîπËØ•ËÆ∞ÂΩïÁöÑÈîÆÂÄºÔºåÂπ∂‰∏îÊõ¥Êñ∞ÂêéÁöÑÂàóÂç†Áî®ÁöÑÂ≠òÂÇ®Á©∫Èó¥Ê≤°ÊúâÂèëÁîüÂèòÂåñÔºåÈÇ£‰πàÂè™ÈúÄË¶ÅÂú® B+Ê†ë‰∏≠ÂÆö‰ΩçËØ•ËÆ∞ÂΩïÔºåÁÑ∂ÂêéËé∑ÂèñËØ•ËÆ∞ÂΩïÁöÑ X ÈîÅÔºåÊúÄÂêéÂÆåÊàê‰øÆÊîπÊìç‰ΩúÂç≥ÂèØ„ÄÇÂõ†Ê≠§Ëøô‰∏™ËøáÁ®ãÂèØ‰ª•Áúã‰ΩúÊòØ‰∏Ä‰∏™Ëé∑Âèñ X ÈîÅÁöÑÈîÅÂÆöËØª„ÄÇÁ¨¨‰∫åÁßçÂ∞±ÊòØÊ≤°Êúâ‰øÆÊîπËØ•ËÆ∞ÂΩïÁöÑÈîÆÂÄºÔºå‰ΩÜÊòØÊõ¥Êñ∞ÂêéËá≥Â∞ëÊúâ‰∏Ä‰∏™ÂàóÂç†Áî®ÁöÑÂ≠òÂÇ®Á©∫Èó¥ÂèëÁîü‰∫ÜÂèòÂåñÔºåÈÇ£‰πàÂ∞±ÈúÄË¶ÅÂú® B+Ê†ë‰∏≠ÂÆö‰ΩçËØ•ËÆ∞ÂΩïÔºåÁÑ∂ÂêéËé∑ÂèñËØ•ËÆ∞ÂΩïÁöÑ X ÈîÅÔºåÊé•‰∏ãÊù•Â∞ÜËØ•ËÆ∞ÂΩïÂà†Èô§ÊéâÔºåÊúÄÂêéÂÜçÊèíÂÖ•‰∏ÄÊù°Êñ∞ÁöÑËÆ∞ÂΩï„ÄÇËøô‰∏™ÂÆö‰ΩçËÆ∞ÂΩïÁöÑËøáÁ®ãÂèØ‰ª•Áúã‰ΩúÊòØ‰∏Ä‰∏™Ëé∑Âèñ X ÈîÅÁöÑÈîÅÂÆöËØªÔºåËÄåÊé•‰∏ãÊù•Êñ∞ÊèíÂÖ•ÁöÑËÆ∞ÂΩïÁî± INSERT Êìç‰ΩúÊèê‰æõÁöÑÈöêÂºèÈîÅÊù•‰øùÊä§„ÄÇÁ¨¨‰∏âÁßçÂ∞±ÊòØ‰øÆÊîπ‰∫ÜËØ•ËÆ∞ÂΩïÁöÑÈîÆÂÄºÔºåÊ≠§Êó∂Áõ∏ÂΩì‰∫éÂú®ÂéüËÆ∞ÂΩï‰∏äÂÅö‰∫Ü DELETE Êìç‰ΩúÂêéÂèàËøõË°å‰∫Ü‰∏ÄÊ¨° INSERT Êìç‰Ωú„ÄÇ</p>
<p>ÂØπ‰∫é INSERT Êìç‰ΩúÊù•ËØ¥ÔºåÊñ∞ÊèíÂÖ•‰∏ÄÊù°ËÆ∞ÂΩïÁöÑÊìç‰Ωú‰ºöÈÄöËøáÈöêÂºèÈîÅÊù•‰øùÊä§ËøôÊù°ÊèíÂÖ•ÁöÑËÆ∞ÂΩïÂú®Êú¨‰∫ãÂä°Êèê‰∫§‰πãÂâç‰∏ç‰ºöË¢´ÂÖ∂‰ªñ‰∫ãÂä°ËÆøÈóÆ„ÄÇ</p>
<h3 id="MySQL-‰∏≠ÁöÑÈîÅÂàÜÁ±ª"><a href="#MySQL-‰∏≠ÁöÑÈîÅÂàÜÁ±ª" class="headerlink" title="MySQL ‰∏≠ÁöÑÈîÅÂàÜÁ±ª"></a>MySQL ‰∏≠ÁöÑÈîÅÂàÜÁ±ª</h3><p><strong>‰ªéÈîÅÁöÑÂ±ûÊÄßÊù•ÂàÜ</strong>ÔºåÈîÅÂàÜ‰∏∫‰∏§ÁßçÔºöÂÖ±‰∫´ÈîÅÔºàS ÈîÅÔºâÂíåÁã¨Âç†ÈîÅÔºàX ÈîÅÔºâ„ÄÇ‰∏Ä‰∏™‰∫ãÂä°Ëé∑ÂèñÂà∞‰∫Ü‰∏Ä‰∫õËÆ∞ÂΩïÁöÑ S ÈîÅÔºåÂÖ∂‰ªñ‰∫ãÂä°ËøòÂèØ‰ª•ÁªßÁª≠Ëé∑ÂèñËøô‰∫õËÆ∞ÂΩïÁöÑ S ÈîÅÔºå‰ΩÜÊòØ‰∏çÂèØ‰ª•Ëé∑ÂèñËøô‰∫õËÆ∞ÂΩïÁöÑ X ÈîÅ„ÄÇËÄåÂΩì‰∏Ä‰∏™‰∫ãÂä°Ëé∑ÂèñÂà∞‰∫Ü‰∏Ä‰∫õËÆ∞ÂΩïÁöÑ X ÈîÅÔºåÈÇ£‰πàÂÖ∂‰ªñ‰∫ãÂä°Â∞±‰∏çËÉΩÂÜçËé∑ÂèñËøô‰∫õËÆ∞ÂΩïÁöÑ S ÈîÅÂíå X ÈîÅ„ÄÇ‰πüÂ∞±ÊòØ S ÈîÅÂíå X ÈîÅ‰∫íÊñ•ÔºåÂêåÊó∂ X ÈîÅ‰∏é X ÈîÅ‰πü‰∫íÊñ•ÔºåÂè™Êúâ S ÈîÅ‰∏é S ÈîÅËÉΩÂ§üÂÖ±Â≠ò„ÄÇ</p>
<ul>
<li><p>ÂÖ±‰∫´ÈîÅ‰πüÁß∞‰∏∫SÔºàShare LockÔºâÈîÅÔºåÁî®‰∫éÊâÄÊúâÁöÑÂè™ËØªÊï∞ÊçÆÊìç‰Ωú„ÄÇÂÖ±‰∫´ÈîÅÊòØÈùûÁã¨Âç†ÁöÑÔºåÂÖÅËÆ∏Â§ö‰∏™Âπ∂Âèë‰∫ãÂä°ËØªÂèñÂÖ∂ÈîÅÂÆöÁöÑËµÑÊ∫ê„ÄÇÂÆÉÂÖ∑Êúâ‰ª•‰∏ãÊÄßË¥®ÔºöÂ§ö‰∏™‰∫ãÂä°ÂèØÂ∞ÅÈîÅ‰∏Ä‰∏™ÂÖ±‰∫´È°µÔºõ‰ªª‰Ωï‰∫ãÂä°ÈÉΩ‰∏çËÉΩ‰øÆÊîπËØ•È°µÔºõÈÄöÂ∏∏ÊòØËØ•È°µË¢´ËØªÂèñÂÆåÊØïÔºåSÈîÅÁ´ãÂç≥Ë¢´ÈáäÊîæ„ÄÇÂú®SQL Server‰∏≠ÔºåÈªòËÆ§ÊÉÖÂÜµ‰∏ãÔºåÊï∞ÊçÆË¢´ËØªÂèñÂêéÔºåÁ´ãÂç≥ÈáäÊîæÂÖ±‰∫´ÈîÅ„ÄÇ</p>
</li>
<li><p>Êéí‰ªñÈîÅÔºàExclusive LockÔºå‰πüÂè´XÈîÅÔºâ‰πüÂè´ÂÜôÈîÅÔºàXÔºâ„ÄÇË°®Á§∫ÂØπÊï∞ÊçÆËøõË°åÂÜôÊìç‰Ωú„ÄÇÂ¶ÇÊûú‰∏Ä‰∏™‰∫ãÂä°ÂØπÂØπË±°Âä†‰∫ÜÊéí‰ªñÈîÅÔºåÂÖ∂‰ªñ‰∫ãÂä°Â∞±‰∏çËÉΩÂÜçÁªôÂÆÉÂä†‰ªª‰ΩïÈîÅ‰∫Ü„ÄÇÊéí‰ªñÈîÅÂÖ∑Êúâ‰ª•‰∏ãÂá†ÁÇπÊÄßË¥®Ôºö‰ªÖÂÖÅËÆ∏‰∏Ä‰∏™‰∫ãÂä°Â∞ÅÈîÅÊ≠§È°µÔºõÂÖ∂‰ªñ‰ªª‰Ωï‰∫ãÂä°ÂøÖÈ°ªÁ≠âÂà∞XÈîÅË¢´ÈáäÊîæÊâçËÉΩÂØπËØ•È°µËøõË°åËÆøÈóÆÔºõXÈîÅ‰∏ÄÁõ¥Âà∞‰∫ãÂä°ÁªìÊùüÊâçËÉΩË¢´ÈáäÊîæ„ÄÇ</p>
</li>
</ul>
<p><strong>‰ªéÈîÅÁöÑÁ≤íÂ∫¶Êù•ÂàÜ</strong>ÔºåÈîÅÂèØ‰ª•ÂàÜ‰∏∫Ë°åÈîÅÂíåË°®ÈîÅ„ÄÇÂ¶ÇÊûúÁªô‰∏Ä‰∏™Ë°®Âä†‰∫Ü S ÈîÅÔºåÈÇ£‰πàÂÖ∂‰ªñ‰∫ãÂä°ÂèØ‰ª•ÁªßÁª≠Ëé∑ÂèñËØ•Ë°®ÊàñËÄÖËØ•Ë°®‰∏≠Êüê‰∫õËÆ∞ÂΩïÁöÑ S ÈîÅÔºå‰ΩÜÊòØ‰∏çËÉΩËé∑ÂèñËØ•Ë°®ÊàñËÄÖËØ•Ë°®‰∏≠Êüê‰∫õËÆ∞ÂΩïÁöÑ X ÈîÅ„ÄÇËÄåÂ¶ÇÊûúÁªô‰∏Ä‰∏™Ë°®Âä†‰∫Ü X ÈîÅÔºåÈÇ£‰πàÂÖ∂‰ªñ‰∫ãÂä°Êó¢‰∏çËÉΩÁªôËØ•Ë°®ÊàñËÄÖËØ•Ë°®‰∏≠ÁöÑÊüê‰∫õËÆ∞ÂΩïÂä† S ÈîÅÔºå‰πü‰∏çËÉΩÁªôËØ•Ë°®ÊàñËÄÖËØ•Ë°®‰∏≠ÁöÑÊüê‰∫õËÆ∞ÂΩïÂä† X ÈîÅ„ÄÇ</p>
<p>ÊúâÁöÑÊó∂ÂÄôÊàë‰ª¨ÈúÄË¶ÅÂú®ÁªôË°®‰∏äÈîÅ‰πãÂâçÊ£ÄÊü•Ë°®‰∏≠ÊúâÊ≤°ÊúâË°åÈîÅÔºåÊ≠§Êó∂‰∏çÂèØËÉΩ‰æùÊ¨°ÈÅçÂéÜÊØè‰∏ÄÊù°ËÆ∞ÂΩïÔºåÂõ†Ê≠§ InnoDB Êèê‰æõ‰∫Ü‰∏ÄÁßçÁß∞‰∏∫ÊÑèÂêëÈîÅÁöÑË°®ÈîÅ„ÄÇÊÑèÂêëÈîÅÂèØ‰ª•ÂàÜ‰∏∫ÊÑèÂêëÂÖ±‰∫´ÈîÅÔºàIntention Shared LockÔºâÂíåÊÑèÂêëÁã¨Âç†ÈîÅÔºàIntention Exclusive LockÔºâ„ÄÇ</p>
<p>ÊÑèÂêëÂÖ±‰∫´ÈîÅ‰πüÂè´ IS ÈîÅÔºåÂΩì‰∫ãÂä°ÂáÜÂ§áÁªôÊüêÊù°ËÆ∞ÂΩïÂä† S ÈîÅÊó∂ÔºåÈúÄË¶ÅÂÖàÁªôË°®Âä†‰∏Ä‰∏™ IS ÈîÅ„ÄÇËÄåÊÑèÂêëÁã¨Âç†ÈîÅ‰πüÂè´ IX ÈîÅÔºåÂΩì‰∫ãÂä°ÂáÜÂ§áÁªôÊüêÊù°ËÆ∞ÂΩïÂä† X ÈîÅÊó∂ÔºåÈúÄË¶ÅÂÖàÁªôË°®Âä†‰∏Ä‰∏™ IX ÈîÅ„ÄÇÊúâ‰∫ÜËøô‰∏§ÁßçÈîÅÔºåÂ¶ÇÊûúÊàë‰ª¨ÈúÄË¶ÅÁªôË°®Âä† S ÈîÅÔºåÈÇ£‰πàÂ∞±ÈúÄË¶ÅÊ£ÄÊü•ËØ•Ë°®ÊúâÊ≤°Êúâ IX ÈîÅÔºåÂ¶ÇÊûúÊ≤°ÊúâÂàôÂèØ‰ª•ÁªôË°®Âä† S ÈîÅÔºåÂê¶ÂàôÈúÄË¶ÅÁ≠â IX ÈîÅÈáäÊîæ„ÄÇÂêåÊ†∑ÔºåÂ¶ÇÊûúÊàë‰ª¨ÈúÄË¶ÅÁªôË°®Âä† X ÈîÅÔºåÈúÄË¶ÅÂÖàÁúãËØ•Ë°®ÊúâÊ≤°Êúâ IS ÈîÅÂíå IX ÈîÅÔºåÂ¶ÇÊûúÊ≤°ÊúâÂàôÂèØ‰ª•Áõ¥Êé•ÁªôË°®Âä† X ÈîÅÔºåÂê¶ÂàôÈúÄË¶ÅÁ≠âÂæÖÈîÅÈáäÊîæ„ÄÇ</p>
<p>ËôΩÁÑ∂ IS Âíå IX ÊòØË°®ÈîÅÔºå‰ΩÜÊòØÂÆÉ‰ª¨‰ªÖ‰ªÖÊòØ‰∏∫‰∫ÜÂú®ÁªôË°®Âä†ÈîÅÊó∂ÂèØ‰ª•Âø´ÈÄüÂà§Êñ≠Ë°®‰∏≠ÁöÑËÆ∞ÂΩïÊòØÂê¶‰∏äÈîÅÔºåÂõ†Ê≠§ IS ‰∏é IX ÊòØÂèØ‰ª•ÂÖ±Â≠òÁöÑ„ÄÇ</p>
<h3 id="InnoDB-‰∏≠ÁöÑË°®ÈîÅ"><a href="#InnoDB-‰∏≠ÁöÑË°®ÈîÅ" class="headerlink" title="InnoDB ‰∏≠ÁöÑË°®ÈîÅ"></a>InnoDB ‰∏≠ÁöÑË°®ÈîÅ</h3><p>InnoDB ‰∏≠ÁöÑË°®ÈîÅÈô§‰∫Ü‰πãÂâçÊâÄËØ¥ÁöÑ S ÈîÅÂíå X ÈîÅÔºåIS ÈîÅÂíå IX ÈîÅÔºåËøòÊúâ AUTO-INC ÈîÅÔºåËØ•ÈîÅÂè™ÊúâÂú®Êüê‰∏™ÂàóÊ∑ªÂä†‰∫Ü AUTO_INCREMENT Â±ûÊÄßÔºå‰πãÂêéÊèíÂÖ•ËÆ∞ÂΩïÊó∂Êâç‰ºö‰ΩøÁî®„ÄÇ</p>
<p>Âú®ÂØπÊüê‰∏™Ë°®ÊâßË°åÂ¢ûÂà†ÊîπÊü•Êìç‰ΩúÊó∂ÔºåInnoDB Â≠òÂÇ®ÂºïÊìéÊòØ‰∏ç‰ºö‰∏∫ËØ•Ë°®Ê∑ªÂä† S ÈîÅÊàñËÄÖ X ÈîÅÁöÑ„ÄÇÂè™ÊúâÂú®‰∏Ä‰∫õÁâπÊÆäÂú∫ÊôØ‰∏ãÊâç‰ºö‰ΩøÁî®ÔºåÊØîÂ¶ÇÂ¥©Ê∫ÉÊÅ¢Â§ç„ÄÇÂΩìÁÑ∂Êàë‰ª¨‰πüÂèØ‰ª•ÊâãÂ∑•Ëé∑ÂèñÔºåÊØîÂ¶ÇÂÖàËÆæÁΩÆ <code>autocommit=0, innodb_table_locks=1</code>ÔºåÁÑ∂ÂêéÈÄöËøá <code>LOCK TABLES t READ</code> Âíå <code>LOCK TABLES t WRITE</code> Êù•ÂàÜÂà´Ëé∑ÂèñË°® t ÁöÑ S ÈîÅÂíå X ÈîÅ„ÄÇÂè¶Â§ñÂØπ‰∫é‰∏Ä‰∫õ DDL Êìç‰ΩúÔºåÊØîÂ¶Ç ALTER TABLE„ÄÅDROP TABLE Á≠âÊìç‰ΩúÔºåÂÖ∂ÂÆûÊòØÂú® MySQL ÁöÑ Server Â±Ç‰ΩøÁî®‰∫Ü‰∏ÄÁßçÁß∞‰∏∫ÂÖÉÊï∞ÊçÆÈîÅÔºàMetadata LocksÔºâÁöÑ‰∏úË•øÊù•ÂÆûÁé∞ÁöÑ„ÄÇ</p>
<h3 id="InnoDB-‰∏≠ÁöÑË°åÈîÅ"><a href="#InnoDB-‰∏≠ÁöÑË°åÈîÅ" class="headerlink" title="InnoDB ‰∏≠ÁöÑË°åÈîÅ"></a>InnoDB ‰∏≠ÁöÑË°åÈîÅ</h3><p>InnoDB ‰∏≠ÁöÑË°åÈîÅÊúâÂæàÂ§öÁßçÔºåÂåÖÊã¨ÊôÆÈÄöÁöÑËÆ∞ÂΩïÈîÅÔºàÂÆòÊñπÂêçÁß∞‰∏∫ <code>LOCK_REC_NOT_GAP</code>Ôºâ„ÄÅGAP ÈîÅÔºàÂèàÂè´Èó¥ÈöôÈîÅÔºåÂÆòÊñπÂêçÁß∞‰∏∫ <code>LOCK_GAP</code>Ôºâ„ÄÅNext-Key LockÔºàÂÆòÊñπÂêçÁß∞‰∏∫ <code>LOCK_ORDINARY</code>Ôºâ„ÄÅÊèíÂÖ•ÊÑèÂêëÈîÅÔºàÂÆòÊñπÁß∞‰∏∫ <code>LOCK_INSERT_INTENTION</code>Ôºâ„ÄÇ</p>
<p>Êé•‰∏ãÊù•‰∏∫‰∫ÜËØ¥ÊòéÊñπ‰æøÔºåÂÖàÂàõÂª∫‰∏Ä‰∏™Ë°®Ôºö</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">CREATE TABLE hero (</span><br><span class="line">    number INT,</span><br><span class="line">    name VARCHAR(100),</span><br><span class="line">    country VARCHAR(100),</span><br><span class="line">    PRIMARY KEY (number)</span><br><span class="line">) Engine&#x3D;InnoDB CHARSET&#x3D;utf8;</span><br><span class="line"></span><br><span class="line">INSERT INTO hero VALUES</span><br><span class="line">    (1, &#39;lÂàòÂ§á&#39;, &#39;ËúÄ&#39;),</span><br><span class="line">    (3, &#39;zËØ∏Ëëõ‰∫Æ&#39;, &#39;ËúÄ&#39;),</span><br><span class="line">    (8, &#39;cÊõπÊìç&#39;, &#39;È≠è&#39;),</span><br><span class="line">    (15, &#39;xËçÄÂΩß&#39;, &#39;È≠è&#39;),</span><br><span class="line">    (20, &#39;sÂ≠ôÊùÉ&#39;, &#39;Âê¥&#39;);</span><br></pre></td></tr></table></figure>

<h2 id="Record-Lock"><a href="#Record-Lock" class="headerlink" title="Record Lock"></a>Record Lock</h2><p>ÊôÆÈÄöÁöÑËÆ∞ÂΩïÈîÅÂè™‰ºöÈîÅ‰ΩèÂΩìÂâçË°åÔºåÂÆÉÊúâ S ÈîÅÂíå X ÈîÅ‰πãÂàÜÔºåÂÆÉ‰ª¨‰πãÈó¥ÁöÑÂÖ≥Á≥ª‰∏é‰πãÂâçËÆ≤ÁöÑ‰∏ÄÊ†∑ÔºåS ÈîÅ‰πãÈó¥ÂèØ‰ª•ÂÖ±Â≠òÔºåS ÈîÅ‰∏é X ÈîÅ‰πãÈó¥„ÄÅX ÈîÅ‰∏é X ÈîÅ‰πãÈó¥‰∏çËÉΩÂÖ±Â≠ò„ÄÇÂú® READ COMMITTED ÈöîÁ¶ªÁ∫ßÂà´‰∏ãÁöÑÂΩìÂâçËØªÂ§ßÂ§ö‰ΩøÁî®ËØ•ÈîÅÔºåÂú® REPEATABLE READ ÈöîÁ¶ªÁ∫ßÂà´‰∏ãÔºåÂîØ‰∏ÄÁ¥¢Âºï‰∏äÁöÑÁ≠âÂÄºÂΩìÂâçËØª‰πü‰ºöÁªôÁ¥¢ÂºïÈîÆÂØπÂ∫îÁöÑË°åÂä†ÊôÆÈÄöÁöÑËÆ∞ÂΩïÈîÅ„ÄÇÊØîÂ¶Ç‰∏ãÈù¢Ëøô‰∏™‰æãÂ≠êÔºö</p>
<table>
<thead>
<tr>
<th align="left">Time</th>
<th align="left">Session A</th>
<th align="left">Session B</th>
</tr>
</thead>
<tbody><tr>
<td align="left">1</td>
<td align="left"><code>BEGIN;</code></td>
<td align="left"></td>
</tr>
<tr>
<td align="left">2</td>
<td align="left"><code>SELECT * FROM hero WHERE number = 8 FOR UPDATE;</code></td>
<td align="left"></td>
</tr>
<tr>
<td align="left">3</td>
<td align="left"></td>
<td align="left"><code>BEGIN;</code></td>
</tr>
<tr>
<td align="left">4</td>
<td align="left"></td>
<td align="left"><code>INSERT INTO hero VALUES (4, &#39;gÂÖ≥ÁæΩ&#39;, &#39;ËúÄ&#39;);</code></td>
</tr>
<tr>
<td align="left">5</td>
<td align="left"></td>
<td align="left"><code>COMMIT;</code></td>
</tr>
<tr>
<td align="left">6</td>
<td align="left"><code>COMMIT;</code></td>
<td align="left"></td>
</tr>
</tbody></table>
<p>Áî±‰∫é number ÊòØ‰∏ªÈîÆÔºåÂõ†Ê≠§Âú®‰ºöËØù A ‰∏≠Âè™‰ºöÁªô number = 8 ÁöÑËÆ∞ÂΩïÂä† X ÈîÅÔºåËÄå‰∏çÊòØ <code>(3, 8)</code> Ëøô‰∏™ËåÉÂõ¥ÔºåËøôÊ†∑‰ºöËØù B ‰∏≠ÁöÑÊèíÂÖ•Êìç‰ΩúÂèØ‰ª•Á´ãÂç≥ÊâßË°åËÄå‰∏ç‰ºöÈòªÂ°û„ÄÇ</p>
<p>Â¶ÇÊûúÂä†ÈîÅÊü•ËØ¢Êó∂‰ΩøÁî®ÁöÑÊòØËæÖÂä©Á¥¢ÂºïÔºåÈÇ£‰πàÂ∞±ÈúÄË¶ÅÂàÜÂà´ÈîÅÂÆöËæÖÂä©Á¥¢ÂºïÂíåËÅöÁ∞áÁ¥¢ÂºïÔºåÊàë‰ª¨ÂÅáËÆæ‰∏äÈù¢ÁöÑ‰æãÂ≠ê‰∏≠ name ÊòØËæÖÂä©Á¥¢Âºï„ÄÇ</p>
<table>
<thead>
<tr>
<th align="left">Time</th>
<th align="left">Session A</th>
<th align="left">Session B</th>
</tr>
</thead>
<tbody><tr>
<td align="left">1</td>
<td align="left"><code>BEGIN;</code></td>
<td align="left"></td>
</tr>
<tr>
<td align="left">2</td>
<td align="left"><code>SELECT * FROM hero WHERE name = &#39;cÊõπÊìç&#39; FOR UPDATE;</code></td>
<td align="left"></td>
</tr>
<tr>
<td align="left">3</td>
<td align="left"></td>
<td align="left"><code>BEGIN;</code></td>
</tr>
<tr>
<td align="left">4</td>
<td align="left"></td>
<td align="left"><code>INSERT INTO hero VALUES (4, &#39;b&#39;, &#39;ËúÄ&#39;); # ÈòªÂ°û</code></td>
</tr>
<tr>
<td align="left">5</td>
<td align="left"></td>
<td align="left"><code>INSERT INTO hero VALUES (4, &#39;d&#39;, &#39;ËúÄ&#39;); # ÈòªÂ°û</code></td>
</tr>
<tr>
<td align="left">6</td>
<td align="left"></td>
<td align="left"><code>INSERT INTO hero VALUES (4, &#39;t&#39;, &#39;ËúÄ&#39;); # Á´ãÂç≥ÊâßË°å</code></td>
</tr>
<tr>
<td align="left">7</td>
<td align="left"></td>
<td align="left"><code>COMMIT;</code></td>
</tr>
<tr>
<td align="left">8</td>
<td align="left"><code>COMMIT;</code></td>
<td align="left"></td>
</tr>
</tbody></table>
<p>‰∏äÈù¢ÁöÑ‰æãÂ≠ê‰∏≠ÔºåÂØπ‰∫éËÅöÁ∞áÁ¥¢ÂºïÔºåÂÖ∂‰ªÖÂØπÂàó number = 8 ÁöÑË°åÂä†ÊôÆÈÄöÁöÑËÆ∞ÂΩïÈîÅÔºõËÄåÂØπ‰∫éËæÖÂä©Á¥¢ÂºïÔºåÂÖ∂‰ΩøÁî®ÁöÑÊòØ Next-Key ÈîÅÔºåÈîÅÂÆöÁöÑËåÉÂõ¥‰∏∫ <code>(-‚àû, cÊõπÊìç)</code>ÔºåÈúÄË¶ÅÊ≥®ÊÑèÁöÑÊòØÔºåInnoDB Â≠òÂÇ®ÂºïÊìéËøò‰ºöÂØπËæÖÂä©Á¥¢ÂºïÁöÑ‰∏ã‰∏Ä‰∏™ÈîÆÂÄºÂä†ÂÖ• GAP LockÔºåÂç≥ËøòÊúâ‰∏Ä‰∏™ËæÖÂä©Á¥¢ÂºïËåÉÂõ¥‰∏∫ <code>(cÊõπÊìç, sÂ≠ôÊùÉ)</code> ÁöÑÈîÅ„ÄÇ</p>
<blockquote>
<p>Âú®ËæÖÂä©Á¥¢Âºï‰∏≠Ôºå‚ÄúcÊõπÊìç‚ÄùÁöÑÂâçÈù¢Ê≤°ÊúâÈîÆÂÄºÔºåÂõ†Ê≠§Ëøô‰∏™Èó¥ÈöôÊòØ‰ªéË¥üÊó†Á©∑ÂºÄÂßã„ÄÇÂêéÈù¢ÁöÑÈîÆÂÄºÊòØ‚ÄúsÂ≠ôÊùÉ‚ÄùÔºåÂéüÂõ†ÊòØÂú®Â∑≤ÊúâÁöÑÊï∞ÊçÆÂΩì‰∏≠Ôºåname ÂàóÊåâÁÖßÂ≠óÂÖ∏È°∫Â∫èÊéíÂ∫èÔºåc Â≠óÊØçÁöÑ‰∏ã‰∏Ä‰∏™Â∞±ÊòØ s„ÄÇÁî±‰∫é t Â≠óÊØç‰∏çÂú®Ëøô‰∏™ËåÉÂõ¥ÂÜÖÔºåÂõ†Ê≠§ÂèØ‰ª•Á´ãÂç≥ÊâßË°å„ÄÇÂè™ÊúâÂΩìÈ¶ñÂ≠óÊØçÁõ∏ÂêåÊó∂ÔºåÊâç‰ºö‰ΩøÁî®ÂêéÈù¢ÁöÑÊï∞ÊçÆÁªßÁª≠ÊéíÂ∫è„ÄÇ</p>
</blockquote>
<h2 id="GAP-Lock"><a href="#GAP-Lock" class="headerlink" title="GAP Lock"></a>GAP Lock</h2><p>Áî±‰∫éÂú®‰∫ãÂä°Á¨¨‰∏ÄÊ¨°ÊâßË°åËØªÂèñÊìç‰ΩúÊó∂ÔºåÈÇ£‰∫õÂπªÂΩ±ËÆ∞ÂΩïÂπ∂‰∏çÂ≠òÂú®ÔºåÂõ†Ê≠§Êàë‰ª¨Êó†Ê≥ïÁªôËøô‰∫õËÆ∞ÂΩïÂä†‰∏äÊôÆÈÄöÁöÑËÆ∞ÂΩïÈîÅÔºåËøôÊó∂Â∞±ÂèØ‰ª•‰ΩøÁî® GAP ÈîÅ„ÄÇÂ¶ÇÊûúÊàë‰ª¨Áªô number ‰∏∫ 8 ÁöÑÈÇ£Êù°ËÆ∞ÂΩïÂä†‰∏Ä‰∏™ GAP ÈîÅÔºåÈÇ£‰πàÂ∞±‰∏çÂÖÅËÆ∏Âà´ÁöÑ‰∫ãÂä°Âú® number ÂÄº‰∏∫ 8 ÁöÑËÆ∞ÂΩïÂâçÁöÑ<strong>Èó¥Èöô</strong>ÊèíÂÖ•Êñ∞ÁöÑËÆ∞ÂΩïÔºå‰πüÂ∞±ÊòØ <code>(3, 8)</code> Ëøô‰∏™Âå∫Èó¥ÂÜÖÊòØ‰∏çÂÖÅËÆ∏Á´ãÂç≥ÊèíÂÖ•Êñ∞ËÆ∞ÂΩïÁöÑ„ÄÇÊØîÂ¶Ç‰∏Ä‰∏™ number ‰∏∫ 4 ËÆ∞ÂΩïÂ∞±Êó†Ê≥ïÊèíÂÖ•Âà∞ËØ•Èó¥Èöô‰∏≠„ÄÇ</p>
<p>ÂèØ‰ª•ÁúãÂà∞ÔºåÁªô‰∏ÄÊù°ËÆ∞ÂΩïÊ∑ªÂä†‰∏Ä‰∏™ <strong>GAP ÈîÅÔºåÂè™ÊòØ‰∏çÂÖÅËÆ∏ÂÖ∂‰ªñ‰∫ãÂä°Âú®ËøôÊù°ËÆ∞ÂΩïÂâçÁöÑÈó¥ÈöôÊèíÂÖ•Êñ∞ËÆ∞ÂΩï</strong>ÔºåÈÇ£‰πàÂ¶ÇÊûúÂêëÊúÄÂêé‰∏ÄÊù°ËÆ∞ÂΩï‰πãÂêéÁöÑÈó¥ÈöôÊèíÂÖ•Êñ∞ËÆ∞ÂΩïÂèàËØ•ÊÄé‰πàÂäûÂë¢ÔºüÁ≠îÊ°àÂ∞±ÊòØÁªôË°®‰∏≠ÊúÄÂêé‰∏ÄÊù°ËÆ∞ÂΩïÔºå‰πüÂ∞±ÊòØ number ÂÄº‰∏∫ 20 ÁöÑËÆ∞ÂΩïÊâÄÂú®È°µÈù¢ÁöÑ Supremum ËÆ∞ÂΩïÂä†‰∏ä‰∏Ä‰∏™ GAP ÈîÅ„ÄÇÁî±‰∫é Supremum ËÆ∞ÂΩïÊÄªÊòØÊØîËØ•Êï∞ÊçÆÈ°µ‰∏≠ÊúÄÂ§ßÁöÑË°åËÆ∞ÂΩïËøòÂ§ßÔºåÂõ†Ê≠§ÂèØ‰ª•ÈòªÊ≠¢ÂÖ∂‰ªñ‰∫ãÂä°Âêë <code>(20, +‚àû)</code> Ëøô‰∏™Âå∫Èó¥ÊèíÂÖ•Êñ∞ËÆ∞ÂΩï„ÄÇ</p>
<h2 id="Next-Key-Lock"><a href="#Next-Key-Lock" class="headerlink" title="Next-Key Lock"></a>Next-Key Lock</h2><p>Êàë‰ª¨ËØ¥ MySQL Âú® REPEATABLE READ ÈöîÁ¶ªÁ∫ßÂà´‰∏ãÊòØÂèØ‰ª•Ëß£ÂÜ≥ÂπªËØªÈóÆÈ¢òÁöÑÔºåÂÖ∑‰ΩìÊù•ËØ¥ÊòØÈÄöËøá MVCC Êú∫Âà∂Ëß£ÂÜ≥‰∫ÜÂø´ÁÖßËØªÊó∂ÂèØËÉΩ‰∫ßÁîüÁöÑÂπªËØªÈóÆÈ¢òÔºåÈÄöËøá Next-Key Lock Ëß£ÂÜ≥‰∫Ü‰ΩøÁî®ÂΩìÂâçËØªÊó∂ÂèØËÉΩ‰∫ßÁîüÁöÑÂπªËØªÈóÆÈ¢ò„ÄÇ</p>
<p>Next-Key ÈîÅÊú¨Ë¥®‰∏äÂ∞±ÊòØ‰∏Ä‰∏™ÊôÆÈÄöÁöÑËÆ∞ÂΩïÈîÅ‰∏é‰∏Ä‰∏™ GAP ÈîÅÁöÑÁªìÂêàÔºåÂÆÉÊó¢ËÉΩ‰øùÊä§ËØ•Êù°ËÆ∞ÂΩïÔºåÂèàËÉΩÈòªÊ≠¢ÂÖ∂‰ªñ‰∫ãÂä°Â∞ÜÊñ∞ËÆ∞ÂΩïÊèíÂÖ•Âà∞ÂΩìÂâçËÆ∞ÂΩïÂâçËæπÁöÑÈó¥Èöô‰∏≠„ÄÇÂõ†Ê≠§Âú®‰∏äÈù¢Êèê‰æõÁöÑÊï∞ÊçÆ‰∏≠ÔºåÂèØ‰ª•Ë¢´ Next-Key Lock ÈîÅ‰ΩèÁöÑÂå∫Èó¥ÂåÖÊã¨Ôºö(-‚àû, 1]„ÄÅ(1, 3]„ÄÅ(3, 8]„ÄÅ(8, 15]„ÄÅ(15, 20]„ÄÅ(20, +‚àû)„ÄÇ‰∏ãÈù¢ÈÄöËøá‰∏Ä‰∏™‰æãÂ≠êÊù•ËØ¥Êòé InnoDB ÊòØÂ¶Ç‰Ωï‰ΩøÁî® Next-Key ÈîÅÊù•ÈÅøÂÖçÂΩìÂâçËØªÂèØËÉΩÂá∫Áé∞ÁöÑÂπªËØªÈóÆÈ¢òÁöÑÔºö</p>
<table>
<thead>
<tr>
<th align="left">Time</th>
<th align="left">Session A</th>
<th align="left">Session B</th>
</tr>
</thead>
<tbody><tr>
<td align="left">1</td>
<td align="left"><code>BEGIN;</code></td>
<td align="left"></td>
</tr>
<tr>
<td align="left">2</td>
<td align="left"><code>SELECT * FROM hero WHERE number &gt; 3 FOR UPDATE;</code></td>
<td align="left"></td>
</tr>
<tr>
<td align="left">3</td>
<td align="left"></td>
<td align="left"><code>BEGIN;</code></td>
</tr>
<tr>
<td align="left">4</td>
<td align="left"></td>
<td align="left"><code>INSERT INTO hero VALUES (4, &#39;gÂÖ≥ÁæΩ&#39;, &#39;ËúÄ&#39;);</code></td>
</tr>
<tr>
<td align="left">5</td>
<td align="left"></td>
<td align="left"><code>COMMIT;</code></td>
</tr>
<tr>
<td align="left">6</td>
<td align="left"><code>SELECT * FORM hero WHERE number &gt; 3 FOR UPDATE;</code></td>
<td align="left"></td>
</tr>
</tbody></table>
<p>‰ºöËØù A ‰∏≠ÁöÑÊü•ËØ¢ËØ≠Âè•ÔºåÈîÅÁöÑËåÉÂõ¥‰∏∫ <code>(3, +‚àû)</code>ÔºåËøôÂ∞±ÊÑèÂë≥ÁùÄÂú®‰ºöËØù B ‰∏≠ÁöÑÊèíÂÖ•Êìç‰Ωú‰ºöË¢´ÈòªÂ°ûÔºåËøôÊ†∑Â∞±ÂèØ‰ª•ÈÅøÂÖçÂá∫Áé∞ÂπªÂΩ±Ë°å„ÄÇ</p>
<h2 id="Insert-Intention-Lock"><a href="#Insert-Intention-Lock" class="headerlink" title="Insert Intention Lock"></a>Insert Intention Lock</h2><p>‰∏Ä‰∏™‰∫ãÂä°Âú®ÊèíÂÖ•‰∏ÄÊù°ËÆ∞ÂΩïÊó∂ÈúÄË¶ÅÂà§Êñ≠ÊèíÂÖ•‰ΩçÁΩÆÊòØÂê¶Ë¢´Âà´ÁöÑ‰∫ãÂä°Ê∑ªÂä†‰∫Ü GAP ÈîÅÊàñËÄÖ Next-key ÈîÅÔºåÂ¶ÇÊûúÊúâÔºåÈÇ£‰πàÂ∞±ÈúÄË¶ÅÁ≠âÂæÖÈîÅÈáäÊîæ„ÄÇËØ•‰∫ãÂä°Âú®Á≠âÂæÖÁöÑÂêåÊó∂Ôºå‰πü‰ºöÁîüÊàê‰∏Ä‰∏™ÈîÅÁªìÊûÑÔºåË°®ÊòéËØ•‰∫ãÂä°ÊÉ≥Âú®Êüê‰∏™Èó¥Èöô‰∏≠ÊèíÂÖ•Êñ∞ËÆ∞ÂΩïÔºå‰ΩÜÊòØÁé∞Âú®Â§Ñ‰∫éÁ≠âÂæÖÁä∂ÊÄÅÔºåËøô‰∏™ÈîÅÂ∞±ÊòØÊèíÂÖ•ÊÑèÂêëÈîÅ„ÄÇÊèíÂÖ•ÊÑèÂêëÈîÅÂπ∂‰∏ç‰ºöÈòªÊ≠¢Âà´ÁöÑ‰∫ãÂä°ÁªßÁª≠Ëé∑ÂèñËØ•ËÆ∞ÂΩï‰∏ä‰ªª‰ΩïÁ±ªÂûãÁöÑÈîÅ„ÄÇ</p>
<h2 id="InnoDBÂºïÊìéÁöÑË°åÈîÅÊòØÊÄé‰πàÂÆûÁé∞ÁöÑ"><a href="#InnoDBÂºïÊìéÁöÑË°åÈîÅÊòØÊÄé‰πàÂÆûÁé∞ÁöÑ" class="headerlink" title="InnoDBÂºïÊìéÁöÑË°åÈîÅÊòØÊÄé‰πàÂÆûÁé∞ÁöÑ?"></a>InnoDBÂºïÊìéÁöÑË°åÈîÅÊòØÊÄé‰πàÂÆûÁé∞ÁöÑ?</h2><p>InnoDBË°åÈîÅÊòØÈÄöËøáÁªôÁ¥¢Âºï‰∏äÁöÑÁ¥¢ÂºïÈ°πÂä†ÈîÅÊù•ÂÆûÁé∞ÁöÑÔºåËøô‰∏ÄÁÇπMySQL‰∏éOracle‰∏çÂêåÔºåOracleÊòØÈÄöËøáÂú®Êï∞ÊçÆÂùó‰∏≠ÂØπÁõ∏Â∫îÊï∞ÊçÆË°åÂä†ÈîÅÊù•ÂÆûÁé∞ÁöÑ„ÄÇInnoDBËøôÁßçË°åÈîÅÂÆûÁé∞ÁâπÁÇπÊÑèÂë≥ÁùÄÔºöÂè™ÊúâÈÄöËøáÁ¥¢ÂºïÊù°‰ª∂Ê£ÄÁ¥¢Êï∞ÊçÆÔºåInnoDBÊâç‰ΩøÁî®Ë°åÁ∫ßÈîÅÔºåÂê¶ÂàôÔºåInnoDBÂ∞Ü‰ΩøÁî®Ë°®ÈîÅÔºÅ</p>

  
  
  <div class="footer">
      <script src="//m.servedby-buysellads.com/monetization.js" type="text/javascript"></script>
<div id="bsa-native"></div>
<script>
_bsa.init('custom', 'CKYD62QM', 'placement:vuejsorg',
  {
    target: '#bsa-native',
    template: '<a class="native-box" href="##statlink##"><div class="native-sponsor">Sponsor</div><div class="native-text"><strong>##company##</strong> ‚Äî ##description##</div></a>'
  }
);
</script>


    Caught a mistake or want to contribute to the documentation?
    <a href="https://github.com/vuejs/vuejs.org/blob/master/src/mysql/mysql-lock.md" rel="noopener" target="_blank">
      Edit this on GitHub!
    </a>
    <!-- Deployed on
    <a href="https://url.netlify.com/HJ8X2mxP8" rel="noopener" target="_blank">
      Netlify
    </a>. -->
  </div>
</div>

      </div>
      <script src="/js/smooth-scroll.min.js"></script>
    

    <!-- main custom script for sidebars, version selects etc. -->
    <script src="/js/css.escape.js"></script>
    <script src="/js/common.js"></script>

    <!-- search -->
    <link href="https://cdn.jsdelivr.net/docsearch.js/1/docsearch.min.css" rel='stylesheet' type='text/css'>
    
<link rel="stylesheet" href="/css/search.css">

    <script src="https://cdn.jsdelivr.net/docsearch.js/1/docsearch.min.js"></script>
    <script>
    [
      '#search-query-nav',
      '#search-query-sidebar',
      '#search-query-menu'
    ].forEach(function (selector) {
      if (!document.querySelector(selector)) return
      // search index defaults to v2
      var match = window.location.pathname.match(/^\/(v\d+)/)
      var version = match ? match[1] : 'v2'
      docsearch({
      appId: 'BH4D9OD16A',
      apiKey: '85cc3221c9f23bfbaa4e3913dd7625ea',
      indexName: 'vuejs',
      inputSelector: selector,
      algoliaOptions: { facetFilters: ["version:" + version] },
      autocompleteOptions: { hint: false, appendTo: 'body'}
      })
    })
    </script>
  </body>
</html>
