


<!DOCTYPE html>
<html lang="en" class="with-v3-banner">
  <head>
    <title>Notes</title>
    <meta charset="utf-8">
    <meta name="description" content="Notes - Personal review warehouse">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <link rel="alternate" hreflang="x-default" href="https://vuejs.org/data/Java/java_concurrent.html">
    <link rel="alternate" hreflang="zh" href="https://cn.vuejs.org/data/Java/java_concurrent.html">
    <link rel="alternate" hreflang="ja" href="https://jp.vuejs.org/data/Java/java_concurrent.html">
    <link rel="alternate" hreflang="ru" href="https://ru.vuejs.org/data/Java/java_concurrent.html">
    <link rel="alternate" hreflang="ko" href="https://kr.vuejs.org/data/Java/java_concurrent.html">
    <link rel="alternate" hreflang="pt-BR" href="https://br.vuejs.org/data/Java/java_concurrent.html">
    <link rel="alternate" hreflang="fr" href="https://fr.vuejs.org/data/Java/java_concurrent.html">
    <link rel="alternate" hreflang="es" href="https://es.vuejs.org/data/Java/java_concurrent.html">

    <meta property="og:type" content="article">
    <meta property="og:title" content="Notes">
    <meta property="og:description" content="Notes - Personal review warehouse">
    <meta property="og:image" content="https://vuejs.org//images/logo.png">

    <meta name="twitter:card" content="summary">
    <meta name="twitter:title" content="Notes">
    <meta name="twitter:description" content="Notes - Personal review warehouse">
    <meta name="twitter:image" content="https://vuejs.org/images/logo.png">

    <link rel="apple-touch-icon" sizes="57x57" href="/images/icons/apple-icon-57x57.png">
    <link rel="apple-touch-icon" sizes="60x60" href="/images/icons/apple-icon-60x60.png">
    <link rel="apple-touch-icon" sizes="72x72" href="/images/icons/apple-icon-72x72.png">
    <link rel="apple-touch-icon" sizes="76x76" href="/images/icons/apple-icon-76x76.png">
    <link rel="apple-touch-icon" sizes="114x114" href="/images/icons/apple-icon-114x114.png">
    <link rel="apple-touch-icon" sizes="120x120" href="/images/icons/apple-icon-120x120.png">
    <link rel="apple-touch-icon" sizes="144x144" href="/images/icons/apple-icon-144x144.png">
    <link rel="apple-touch-icon" sizes="152x152" href="/images/icons/apple-icon-152x152.png">
    <link rel="apple-touch-icon" sizes="180x180" href="/images/icons/apple-icon-180x180.png">
    <link rel="icon" type="image/png" sizes="192x192"  href="/images/icons/android-icon-192x192.png">
    <link rel="icon" type="image/png" sizes="32x32" href="/images/icons/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="96x96" href="/images/icons/favicon-96x96.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/images/icons/favicon-16x16.png">
    <meta name="msapplication-TileImage" content="/images/icons/ms-icon-144x144.png">
    <link rel="icon" href="/images/logo.png" type="image/png">

    <meta name="msapplication-TileColor" content="#4fc08d">
    <meta name="theme-color" content="#4fc08d">

    <meta name="msapplication-config" content="browserconfig.xml">
    <link rel="manifest" href="/manifest.json">

    <link href="https://fonts.googleapis.com" rel="preconnect" crossorigin>
    <link href="https://fonts.gstatic.com" rel="preconnect" crossorigin>
    <link href="https://maxcdn.bootstrapcdn.com" rel="preconnect" crossorigin>

    <link href="https://fonts.googleapis.com/css?family=Source+Sans+Pro:300,400,600|Roboto Mono&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css?family=Dosis:500&text=Vue.js&display=swap" rel="stylesheet">

    <link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" rel="stylesheet">

    <!-- main page styles -->
    
<link rel="stylesheet" href="/css/page.css">


    <!-- this needs to be loaded before guide's inline scripts -->
    <script src="/js/vue.js"></script>

    

    <script>
      Vue.config.productionTip = false
      window.PAGE_TYPE = ""
    </script>

    <!-- ga -->
    <script>
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

      ga('create', 'UA-46852172-1', 'vuejs.org');
      ga('send', 'pageview');
    </script>

    <!-- vimeo analytics -->
    <script type="text/javascript" defer="defer" src="https://extend.vimeocdn.com/ga/72160148.js"></script>
  <meta name="generator" content="Hexo 5.4.0"></head>
  <body class="docs">
    <div id="mobile-bar" >
      <a class="menu-button"></a>
      <a class="logo" href="/"></a>
    </div>
    <div>
  <div id="v3-banner">
    <span class="hidden-sm">Welcome to yanliang's notes</span>
  </div>

  <header id="header">
    <a id="logo" href="/">
      <img src="/images/logo.png" alt="vue logo">
      <span>Notes - personal review warehouse</span>
    </a>
    <ul id="nav">
      <li>
  <form id="search-form">
    <input type="text" id="search-query-nav" class="search-query st-default-search-input" aria-label="Search">
  </form>
</li>
<li class="nav-dropdown-container learn">
  <a class="nav-link">‚≠êÔ∏èJava</a><span class="arrow"></span>
  <ul class="nav-dropdown">
    <li><h4>Documentation</h4></li>
    <li>
      <ul>
        <li><a href="/java/oop/" class="nav-link">OOP</a></li>
        <li><a href="/v2/api/" class="nav-link">API</a></li>
        <li><a href="/v2/style-guide/" class="nav-link">Style Guide</a></li>
        <li><a href="/v2/examples/" class="nav-link">Examples</a></li>
        <li><a href="/v2/cookbook/" class="nav-link">Cookbook</a></li>
      </ul>
    </li>
    <li><h4>Video Courses</h4></li>
    <li>
      <ul>
        <li>
          <a href="https://www.vuemastery.com/courses/" class="nav-link" target="_blank" rel="sponsored noopener">
            Vue Mastery
          </a>
        </li>
        <li>
          <a
            href="https://vueschool.io/?friend=vuejs&utm_source=Vuejs.org&utm_medium=Link&utm_content=Navbar%20Dropdown"
            class="nav-link"
            target="_blank" rel="sponsored noopener"
          >
            Vue School
          </a>
        </li>
      </ul>
    </li>
  </ul>
</li>

<li class="nav-dropdown-container learn">
  <a class="nav-link">ÁΩëÁªú</a><span class="arrow"></span>
  <ul class="nav-dropdown">
    <!-- <li><h4>Documentation</h4></li> -->
    <li>
      <ul>
        <li><a href="/network">Review List</a></li>
        <li><a href="/network/tcp/">üî•TCP</a></li>
        <li><a href="/network/http/">HTTP</a></li>
        <li><a href="/network/ip/">IP</a></li>
      </ul>
    </li>
    <li><h4>Video Courses</h4></li>
    <li>
      <ul>
        <li>
          <a href="https://www.vuemastery.com/courses/" class="nav-link" target="_blank" rel="sponsored noopener">
            Vue Mastery
          </a>
        </li>
        <li>
          <a
            href="https://vueschool.io/?friend=vuejs&utm_source=Vuejs.org&utm_medium=Link&utm_content=Navbar%20Dropdown"
            class="nav-link"
            target="_blank" rel="sponsored noopener"
          >
            Vue School
          </a>
        </li>
      </ul>
    </li>
  </ul>
</li>

<li>
  <a href="/os/">Êìç‰ΩúÁ≥ªÁªü</a>
</li>
<li>
  <a href="/mysql/">üíºÊï∞ÊçÆÂ∫ì</a>
</li>
<li>
  <a target="_blank" rel="noopener" href="https://codetop.cc/#/home">‚ù§Ô∏èÁÆóÊ≥ï</a>
</li>
<li class="nav-dropdown-container resources">
  <a href="#" class="nav-link">Resources</a><span class="arrow"></span>
  <ul class="nav-dropdown">
    <li><a href="/resources/partners.html" class="nav-link">Partners</a></li>
    <li><a href="/resources/themes.html" class="nav-link">Themes</a></li>
    <li><a href="https://github.com/vuejs/awesome-vue" class="nav-link" target="_blank" rel="noopener">Awesome Vue</a></li>
    <li><a href="https://awesomejs.dev/for/vue/" class="nav-link" target="_blank" rel="noopener">Browse packages for Vue</a></li>
  </ul>
</li>

<!-- <li>
  <a href="/partners" class="nav-link ">Partners</a>
</li> -->
<li class="nav-dropdown-container support-vue">
  <a href="/support-vuejs/" class="nav-link">Support Vue</a><span class="arrow"></span>
  <ul class="nav-dropdown">
    <li><a href="/support-vuejs/#One-time-Donations" class="nav-link">One-time Donations</a></li>
    <li><a href="/support-vuejs/#Recurring-Pledges" class="nav-link">Recurring Pledges</a></li>
    <li><a href="https://vue.threadless.com" target="_blank" rel="noopener" class="nav-link">T-Shirt Shop</a></li>
  </ul>
</li>

<li class="nav-dropdown-container language">
  <a class="nav-link">Translations</a><span class="arrow"></span>
  <ul class="nav-dropdown">
    <li><a target="_blank" rel="noopener" href="https://cn.vuejs.org/data/Java/java_concurrent.html" class="nav-link">‰∏≠Êñá</a></li>
    <li><a target="_blank" rel="noopener" href="https://jp.vuejs.org/data/Java/java_concurrent.html" class="nav-link">Êó•Êú¨Ë™û</a></li>
    <li><a target="_blank" rel="noopener" href="https://ru.vuejs.org/data/Java/java_concurrent.html" class="nav-link">–†—É—Å—Å–∫–∏–π</a></li>
    <li><a target="_blank" rel="noopener" href="https://kr.vuejs.org/data/Java/java_concurrent.html" class="nav-link">ÌïúÍµ≠Ïñ¥</a></li>
    <li><a target="_blank" rel="noopener" href="https://br.vuejs.org/data/Java/java_concurrent.html" class="nav-link">Portugu√™s</a></li>
    <li><a target="_blank" rel="noopener" href="https://fr.vuejs.org/data/Java/java_concurrent.html" class="nav-link">Fran√ßais</a></li>
    <li><a target="_blank" rel="noopener" href="https://vi.vuejs.org/data/Java/java_concurrent.html" class="nav-link">Ti·∫øng Vi·ªát</a></li>
    <li><a target="_blank" rel="noopener" href="https://es.vuejs.org/data/Java/java_concurrent.html" class="nav-link">Espa√±ol</a></li>
    <li><a target="_blank" rel="noopener" href="https://docs.vuejs.id/data/Java/java_concurrent.html" class="nav-link">Bahasa Indonesia</a></li>
  </ul>
</li>


    </ul>
  </header>
</div>

    
      <div id="main" class="fix-sidebar">
        
  <div class="sidebar">
    <ul class="main-menu">
      <li>
  <form id="search-form">
    <input type="text" id="search-query-sidebar" class="search-query st-default-search-input" aria-label="Search">
  </form>
</li>
<li class="nav-dropdown-container learn">
  <a class="nav-link">‚≠êÔ∏èJava</a><span class="arrow"></span>
  <ul class="nav-dropdown">
    <li><h4>Documentation</h4></li>
    <li>
      <ul>
        <li><a href="/java/oop/" class="nav-link">OOP</a></li>
        <li><a href="/v2/api/" class="nav-link">API</a></li>
        <li><a href="/v2/style-guide/" class="nav-link">Style Guide</a></li>
        <li><a href="/v2/examples/" class="nav-link">Examples</a></li>
        <li><a href="/v2/cookbook/" class="nav-link">Cookbook</a></li>
      </ul>
    </li>
    <li><h4>Video Courses</h4></li>
    <li>
      <ul>
        <li>
          <a href="https://www.vuemastery.com/courses/" class="nav-link" target="_blank" rel="sponsored noopener">
            Vue Mastery
          </a>
        </li>
        <li>
          <a
            href="https://vueschool.io/?friend=vuejs&utm_source=Vuejs.org&utm_medium=Link&utm_content=Navbar%20Dropdown"
            class="nav-link"
            target="_blank" rel="sponsored noopener"
          >
            Vue School
          </a>
        </li>
      </ul>
    </li>
  </ul>
</li>

<li class="nav-dropdown-container learn">
  <a class="nav-link">ÁΩëÁªú</a><span class="arrow"></span>
  <ul class="nav-dropdown">
    <!-- <li><h4>Documentation</h4></li> -->
    <li>
      <ul>
        <li><a href="/network">Review List</a></li>
        <li><a href="/network/tcp/">üî•TCP</a></li>
        <li><a href="/network/http/">HTTP</a></li>
        <li><a href="/network/ip/">IP</a></li>
      </ul>
    </li>
    <li><h4>Video Courses</h4></li>
    <li>
      <ul>
        <li>
          <a href="https://www.vuemastery.com/courses/" class="nav-link" target="_blank" rel="sponsored noopener">
            Vue Mastery
          </a>
        </li>
        <li>
          <a
            href="https://vueschool.io/?friend=vuejs&utm_source=Vuejs.org&utm_medium=Link&utm_content=Navbar%20Dropdown"
            class="nav-link"
            target="_blank" rel="sponsored noopener"
          >
            Vue School
          </a>
        </li>
      </ul>
    </li>
  </ul>
</li>

<li>
  <a href="/os/">Êìç‰ΩúÁ≥ªÁªü</a>
</li>
<li>
  <a href="/mysql/">üíºÊï∞ÊçÆÂ∫ì</a>
</li>
<li>
  <a target="_blank" rel="noopener" href="https://codetop.cc/#/home">‚ù§Ô∏èÁÆóÊ≥ï</a>
</li>
<li class="nav-dropdown-container resources">
  <a href="#" class="nav-link">Resources</a><span class="arrow"></span>
  <ul class="nav-dropdown">
    <li><a href="/resources/partners.html" class="nav-link">Partners</a></li>
    <li><a href="/resources/themes.html" class="nav-link">Themes</a></li>
    <li><a href="https://github.com/vuejs/awesome-vue" class="nav-link" target="_blank" rel="noopener">Awesome Vue</a></li>
    <li><a href="https://awesomejs.dev/for/vue/" class="nav-link" target="_blank" rel="noopener">Browse packages for Vue</a></li>
  </ul>
</li>

<!-- <li>
  <a href="/partners" class="nav-link ">Partners</a>
</li> -->
<li class="nav-dropdown-container support-vue">
  <a href="/support-vuejs/" class="nav-link">Support Vue</a><span class="arrow"></span>
  <ul class="nav-dropdown">
    <li><a href="/support-vuejs/#One-time-Donations" class="nav-link">One-time Donations</a></li>
    <li><a href="/support-vuejs/#Recurring-Pledges" class="nav-link">Recurring Pledges</a></li>
    <li><a href="https://vue.threadless.com" target="_blank" rel="noopener" class="nav-link">T-Shirt Shop</a></li>
  </ul>
</li>

<li class="nav-dropdown-container language">
  <a class="nav-link">Translations</a><span class="arrow"></span>
  <ul class="nav-dropdown">
    <li><a target="_blank" rel="noopener" href="https://cn.vuejs.org/data/Java/java_concurrent.html" class="nav-link">‰∏≠Êñá</a></li>
    <li><a target="_blank" rel="noopener" href="https://jp.vuejs.org/data/Java/java_concurrent.html" class="nav-link">Êó•Êú¨Ë™û</a></li>
    <li><a target="_blank" rel="noopener" href="https://ru.vuejs.org/data/Java/java_concurrent.html" class="nav-link">–†—É—Å—Å–∫–∏–π</a></li>
    <li><a target="_blank" rel="noopener" href="https://kr.vuejs.org/data/Java/java_concurrent.html" class="nav-link">ÌïúÍµ≠Ïñ¥</a></li>
    <li><a target="_blank" rel="noopener" href="https://br.vuejs.org/data/Java/java_concurrent.html" class="nav-link">Portugu√™s</a></li>
    <li><a target="_blank" rel="noopener" href="https://fr.vuejs.org/data/Java/java_concurrent.html" class="nav-link">Fran√ßais</a></li>
    <li><a target="_blank" rel="noopener" href="https://vi.vuejs.org/data/Java/java_concurrent.html" class="nav-link">Ti·∫øng Vi·ªát</a></li>
    <li><a target="_blank" rel="noopener" href="https://es.vuejs.org/data/Java/java_concurrent.html" class="nav-link">Espa√±ol</a></li>
    <li><a target="_blank" rel="noopener" href="https://docs.vuejs.id/data/Java/java_concurrent.html" class="nav-link">Bahasa Indonesia</a></li>
  </ul>
</li>


    </ul>
  </div>

<div class="content  ">
  <p class="tip warning v3-warning">
    Welcome to yanliang's notes.
  </p>

  
  
  
    <p>[TOC]</p>
<p><img src="../img/java/7.png"></p>
<h2 id="CAS"><a href="#CAS" class="headerlink" title="CAS"></a>CAS</h2><p>Conmpare And SwapÔºàÊØîËæÉÂíå‰∫§Êç¢Ôºâ</p>
<h3 id="CASËß£ÂÜ≥‰ªÄ‰πàÈóÆÈ¢òÔºü"><a href="#CASËß£ÂÜ≥‰ªÄ‰πàÈóÆÈ¢òÔºü" class="headerlink" title="CASËß£ÂÜ≥‰ªÄ‰πàÈóÆÈ¢òÔºü"></a>CASËß£ÂÜ≥‰ªÄ‰πàÈóÆÈ¢òÔºü</h3><p>ÂΩìÂ§ö‰∏™Á∫øÁ®ãÂØπÂêå‰∏Ä‰∏™Êï∞ÊçÆËøõË°åÊìç‰ΩúÁöÑÊó∂ÂÄôÔºåÂ¶ÇÊûúÊ≤°ÊúâÂêåÊ≠•Â∞±‰ºö‰∫ßÁîüÁ∫øÁ®ãÂÆâÂÖ®ÈóÆÈ¢ò„ÄÇ‰∏∫‰∫ÜËß£ÂÜ≥Á∫øÁ®ãÁ∫øÁ®ãÂÆâÂÖ®ÈóÆÈ¢òÔºåÊàë‰ª¨ÈúÄË¶ÅÂä†‰∏äÂêåÊ≠•‰ª£Á†ÅÂùóÔºåÊìç‰ΩúÔºåÂ¶ÇÂä†‰∏äsynchronized„ÄÇ‰ΩÜÊòØÊüê‰∫õÊÉÖÂÜµ‰∏ãËøôÂπ∂‰∏çÊòØÊúÄ‰ºòÈÄâÊã©„ÄÇ</p>
<p>synchronizedÂÖ≥ÈîÆÂ≠ó‰ºöËÆ©Ê≤°ÊúâÂæóÂà∞ÈîÅËµÑÊ∫êÁöÑÁ∫øÁ®ãËøõÂÖ•BLOCKEDÁä∂ÊÄÅÔºåËÄåÂêéÂú®‰∫âÂ§∫Âà∞ÈîÅËµÑÊ∫êÂêéÊÅ¢Â§ç‰∏∫RUNNABLEÁä∂ÊÄÅÔºåËøô‰∏™ËøáÁ®ã‰∏≠Ê∂âÂèäÂà∞Êìç‰ΩúÁ≥ªÁªüÁî®Êà∑Ê®°ÂºèÂíåÂÜÖÊ†∏Ê®°ÂºèÁöÑËΩ¨Êç¢Ôºå‰ª£‰ª∑ÊØîËæÉÈ´ò„ÄÇËøô‰∏™ËøáÁ®ãÊòØ‰∏Ä‰∏™‰∏≤Ë°åÁöÑËøáÁ®ãÔºåÊïàÁéáÂæà‰Ωé„ÄÇ</p>
<p>Â∞ΩÁÆ°JAVA 1.6‰∏∫synchronizedÂÅö‰∫Ü‰ºòÂåñÔºåÂ¢ûÂä†‰∫Ü‰ªéÂÅèÂêëÈîÅÂà∞ËΩªÈáèÁ∫ßÈîÅÂÜçÂà∞ÈáçÈáèÁ∫ßÈîÅÁöÑËøáËøáÂ∫¶Ôºå‰ΩÜÊòØÂú®ÊúÄÁªàËΩ¨Âèò‰∏∫ÈáçÈáèÁ∫ßÈîÅ‰πãÂêéÔºåÊÄßËÉΩ‰ªçÁÑ∂ÊØîËæÉ‰Ωé„ÄÇÊâÄ‰ª•Èù¢ÂØπËøôÁßçÊÉÖÂÜµÔºåÊàë‰ª¨Â∞±ÂèØ‰ª•‰ΩøÁî®java‰∏≠ÁöÑ‚ÄúÂéüÂ≠êÊìç‰ΩúÁ±ª‚Äù„ÄÇ</p>
<p>ËÄåÂéüÂ≠êÊìç‰ΩúÁ±ªÁöÑÂ∫ïÂ±ÇÊ≠£ÊòØÁî®Âà∞‰∫Ü‚ÄúCASÊú∫Âà∂‚Äù„ÄÇ</p>
<p>CASÊòØËã±ÊñáÂçïËØçCompare and SwapÁöÑÁº©ÂÜôÔºåÁøªËØëËøáÊù•Â∞±ÊòØÊØîËæÉÂπ∂ÊõøÊç¢„ÄÇ</p>
<p>CASÊìç‰ΩúÂåÖÂê´‰∏â‰∏™Êìç‰ΩúÊï∞‚Äî‚ÄîÂÜÖÂ≠ò‰ΩçÁΩÆ„ÄÅÈ¢ÑÊúüÂéüÂÄºÂèäÊñ∞ÂÄº„ÄÇÊâßË°åCASÊìç‰ΩúÁöÑÊó∂ÂÄôÔºåÂ∞ÜÂÜÖÂ≠ò‰ΩçÁΩÆÁöÑÂÄº‰∏éÈ¢ÑÊúüÂéüÂÄºÊØîËæÉÔºåÂ¶ÇÊûúÁõ∏ÂåπÈÖçÔºåÈÇ£‰πàÂ§ÑÁêÜÂô®‰ºöËá™Âä®Â∞ÜËØ•‰ΩçÁΩÆÂÄºÊõ¥Êñ∞‰∏∫Êñ∞ÂÄºÔºåÂê¶ÂàôÔºåÂ§ÑÁêÜÂô®‰∏çÂÅö‰ªª‰ΩïÊìç‰Ωú„ÄÇÊàë‰ª¨ÈÉΩÁü•ÈÅìÔºåCASÊòØ‰∏ÄÊù°CPUÁöÑÂéüÂ≠êÊåá‰ª§ÔºàcmpxchgÊåá‰ª§ÔºâÔºå‰∏ç‰ºöÈÄ†ÊàêÊâÄË∞ìÁöÑÊï∞ÊçÆ‰∏ç‰∏ÄËá¥ÈóÆÈ¢òÔºåUnsafeÊèê‰æõÁöÑCASÊñπÊ≥ïÔºàÂ¶ÇcompareAndSwapXXXÔºâÂ∫ïÂ±ÇÂÆûÁé∞Âç≥‰∏∫CPUÊåá‰ª§cmpxchg„ÄÇ</p>
<p>‰ªéÊÄùÊÉ≥‰∏äÊù•ËØ¥ÔºåsynchronizedÂ±û‰∫éÊÇ≤ËßÇÈîÅÔºåÊÇ≤ËßÇÁöÑËÆ§‰∏∫Á®ãÂ∫è‰∏≠ÁöÑÂπ∂ÂèëÊÉÖÂÜµ‰∏•ÈáçÔºåÊâÄ‰ª•‰∏•Èò≤Ê≠ªÂÆàÔºåCASÂ±û‰∫é‰πêËßÇÈîÅÔºå‰πêËßÇÂú∞ËÆ§‰∏∫Á®ãÂ∫è‰∏≠ÁöÑÂπ∂ÂèëÊÉÖÂÜµ‰∏çÈÇ£‰πà‰∏•ÈáçÔºåÊâÄ‰ª•ËÆ©Á∫øÁ®ã‰∏çÊñ≠ÂéªÈáçËØïÊõ¥Êñ∞„ÄÇ</p>
<h3 id="CASÂ≠òÂú®ÁöÑÈóÆÈ¢ò"><a href="#CASÂ≠òÂú®ÁöÑÈóÆÈ¢ò" class="headerlink" title="CASÂ≠òÂú®ÁöÑÈóÆÈ¢ò"></a>CASÂ≠òÂú®ÁöÑÈóÆÈ¢ò</h3><p>1Ôºâ CPUÂºÄÈîÄËøáÂ§ß</p>
<p>‚Äã        Âú®Âπ∂ÂèëÈáèÊØîËæÉÈ´òÁöÑÊÉÖÂÜµ‰∏ãÔºåÂ¶ÇÊûúËÆ∏Â§öÁ∫øÁ®ãÂèçÂ§çÂ∞ùËØïÊõ¥Êñ∞Êüê‰∏Ä‰∏™ÂèòÈáèÔºåÂç¥Âèà‰∏ÄÁõ¥Êõ¥Êñ∞‰∏çÊàêÂäüÔºåÂæ™ÁéØÂæÄÂ§çÔºå‰ºöÁªôCPUÂ∏¶Êù•ÂæàÂà∞ÁöÑÂéãÂäõ„ÄÇ</p>
<p>2Ôºâ ‰∏çËÉΩ‰øùËØÅ‰ª£Á†ÅÂùóÁöÑÂéüÂ≠êÊÄß</p>
<p>‚Äã        CASÊú∫Âà∂ÊâÄ‰øùËØÅÁöÑÁü•ËØÜ‰∏Ä‰∏™ÂèòÈáèÁöÑÂéüÂ≠êÊÄßÊìç‰ΩúÔºåËÄå‰∏çËÉΩ‰øùËØÅÊï¥‰∏™‰ª£Á†ÅÂùóÁöÑÂéüÂ≠êÊÄß„ÄÇÊØîÂ¶ÇÈúÄË¶Å‰øùËØÅ3‰∏™ÂèòÈáèÂÖ±ÂêåËøõË°åÂéüÂ≠êÊÄßÁöÑÊõ¥Êñ∞ÔºåÂ∞±‰∏çÂæó‰∏ç‰ΩøÁî®synchronized‰∫Ü„ÄÇ</p>
<p>3Ôºâ ABAÈóÆÈ¢ò</p>
<p>‚Äã        ËøôÊòØCASÊú∫Âà∂ÊúÄÂ§ßÁöÑÈóÆÈ¢òÊâÄÂú®„ÄÇ</p>
<h3 id="Â¶Ç‰ΩïËß£ÂÜ≥ABAÈóÆÈ¢òÔºü"><a href="#Â¶Ç‰ΩïËß£ÂÜ≥ABAÈóÆÈ¢òÔºü" class="headerlink" title="Â¶Ç‰ΩïËß£ÂÜ≥ABAÈóÆÈ¢òÔºü"></a>Â¶Ç‰ΩïËß£ÂÜ≥ABAÈóÆÈ¢òÔºü</h3><p>Ê∑ªÂä†‰øÆÊîπÁâàÊú¨Âè∑  </p>
<p>AtomicStampedReference Â∏¶Êó∂Èó¥Êà≥ÁöÑÂéüÂ≠êÂºïÁî®</p>
<h3 id="CASÁöÑÂ∫îÁî®"><a href="#CASÁöÑÂ∫îÁî®" class="headerlink" title="CASÁöÑÂ∫îÁî®"></a>CASÁöÑÂ∫îÁî®</h3><p>CASÂú®java.util.concurrent.atomicÁõ∏ÂÖ≥Á±ª„ÄÅJava AQS„ÄÅCurrentHashMapÁ≠âÂÆûÁé∞‰∏äÊúâÈùûÂ∏∏ÂπøÊ≥õÁöÑÂ∫îÁî®„ÄÇ</p>
<h2 id="AQS"><a href="#AQS" class="headerlink" title="AQS"></a>AQS</h2><p>AQS ÁöÑÂÖ®Áß∞‰∏∫ÔºàAbstractQueuedSynchronizerÔºâÊäΩË±°ÁöÑÂêåÊ≠•ÈòüÂàó„ÄÇAQS ÊòØ‰∏Ä‰∏™Áî®Êù•ÊûÑÂª∫ÈîÅÂíåÂêåÊ≠•Âô®ÁöÑÊ°ÜÊû∂Ôºå‰ΩøÁî® AQS ËÉΩÁÆÄÂçï‰∏îÈ´òÊïàÂú∞ÊûÑÈÄ†Âá∫Â∫îÁî®ÂπøÊ≥õÁöÑÂ§ßÈáèÁöÑÂêåÊ≠•Âô®ÔºåÊØîÂ¶ÇÊàë‰ª¨ÊèêÂà∞ÁöÑ <code>ReentrantLock</code>Ôºå<code>Semaphore</code>ÔºåÂÖ∂‰ªñÁöÑËØ∏Â¶Ç <code>ReentrantReadWriteLock</code>Ôºå<code>SynchronousQueue</code>Ôºå<code>FutureTask</code> Á≠âÁ≠âÁöÜÊòØÂü∫‰∫é AQS ÁöÑ„ÄÇÂΩìÁÑ∂ÔºåÊàë‰ª¨Ëá™Â∑±‰πüËÉΩÂà©Áî® AQS ÈùûÂ∏∏ËΩªÊùæÂÆπÊòìÂú∞ÊûÑÈÄ†Âá∫Á¨¶ÂêàÊàë‰ª¨Ëá™Â∑±ÈúÄÊ±ÇÁöÑÂêåÊ≠•Âô®„ÄÇ</p>
<h3 id="ÂéüÁêÜ"><a href="#ÂéüÁêÜ" class="headerlink" title="ÂéüÁêÜ"></a>ÂéüÁêÜ</h3><p>AQS ÊòØ‰∏Ä‰∏™ÊäΩË±°Á±ªÔºå‰∏çËÉΩÂÆû‰æãÂåñ„ÄÇÂè™ËÉΩË¢´ÁªßÊâøÁÑ∂ÂêéÈáçÂÜôÊåáÂÆöÁöÑÊñπÊ≥ïÔºàÁ∫øÁ®ãËé∑ÂèñËµÑÊ∫êÂíåÈáäÊîæËµÑÊ∫êÁöÑÊñπÂºèÔºâ„ÄÇ</p>
<p>AQS ‰∏≠Áª¥Êä§‰∫Ü‰∏Ä‰∏™ state Â≠óÊÆµÔºå<strong>Áî®Êù•Ë°®Á§∫ÂêåÊ≠•Áä∂ÊÄÅ</strong>ÔºåÁî±volatile‰øÆÈ•∞ÔºåÁî®‰∫éÂ±ïÁ§∫ÂΩìÂâçÂÖ±‰∫´ËµÑÊ∫êÁöÑËé∑ÈîÅÊÉÖÂÜµ„ÄÇÂπ∂‰∏îÊèê‰æõ‰∫ÜÁõ∏Â∫îÁöÑ get setÊñπÊ≥ï‰ª•ÂèäÁî®casÂÆûÁé∞ÁöÑsetÊñπÊ≥ïÔºåAQSÂè™ÊòØÊèê‰æõ‰∫ÜÁõ∏Â∫îÁöÑÊñπÊ≥ïÔºàÂπ∂‰∏îÊòØfinalÁ±ªÂûãÁöÑÔºåÂ≠êÁ±ªÊó†Ê≥ïÈáçÂÜôÔºâÔºåÂÖ∑‰Ωì‰ªÄ‰πàÊó∂Èó¥Ë∞ÉÁî®ÔºåÊúâÂÖ∑‰ΩìÁöÑÂêåÊ≠•Âô®Êù•ÂÜ≥ÂÆö„ÄÇ</p>
<blockquote>
<ul>
<li>ÂØπ‰∫éReentrantLockÁöÑÂÆûÁé∞Êù•ËØ¥ÔºåstateÂèØ‰ª•Áî®Êù•Ë°®Á§∫ÂΩìÂâçÁ∫øÁ®ãËé∑ÂèñÈîÅÁöÑÂèØÈáçÂÖ•Ê¨°Êï∞Ôºõ</li>
<li>ÂØπ‰∫éËØªÂÜôÈîÅReentrantReadWriteLockÊù•ËØ¥ÔºåstateÁöÑÈ´ò16‰ΩçË°®Á§∫ËØªÁä∂ÊÄÅÔºå‰πüÂ∞±ÊòØËé∑ÂèñËØ•ËØªÈîÅÁöÑÊ¨°Êï∞Ôºå‰Ωé16‰ΩçË°®Á§∫Ëé∑ÂèñÂà∞ÂÜôÈîÅÁöÑÁ∫øÁ®ãÁöÑÂèØÈáçÂÖ•Ê¨°Êï∞Ôºõ</li>
<li>ÂØπ‰∫ésemaphoreÊù•ËØ¥ÔºåstateÁî®Êù•Ë°®Á§∫ÂΩìÂâçÂèØÁî®‰ø°Âè∑ÁöÑ‰∏™Êï∞Ôºõ</li>
<li>ÂØπ‰∫éCountDownlatchÊù•ËØ¥ÔºåstateÁî®Êù•Ë°®Á§∫ËÆ°Êï∞Âô®ÂΩìÂâçÁöÑÂÄº„ÄÇ</li>
</ul>
</blockquote>
<p>AQS Áª¥Êä§‰∫Ü‰∏Ä‰∏™CLHÂèò‰ΩìÁöÑËôöÊãüÂèåÂêëÈòüÂàóÔºàFIFOÔºâÔºåÂ∞ÜÊöÇÊó∂Ëé∑Âèñ‰∏çÂà∞ÈîÅÁöÑÁ∫øÁ®ãÂä†ÂÖ•Âà∞ÈòüÂàó‰∏≠„ÄÇÂπ∂‰∏îÂÆûÁé∞‰∫Ü‰∏ÄÂ•óÈòªÂ°ûÂíåÂî§ÈÜíÊú∫Âà∂„ÄÇAQSÊ†∏ÂøÉÊÄùÊÉ≥ÊòØÔºåÂ¶ÇÊûúË¢´ËØ∑Ê±ÇÁöÑÂÖ±‰∫´ËµÑÊ∫êÁ©∫Èó≤ÔºåÈÇ£‰πàÂ∞±Â∞ÜÂΩìÂâçËØ∑Ê±ÇËµÑÊ∫êÁöÑÁ∫øÁ®ãËÆæÁΩÆ‰∏∫ÊúâÊïàÁöÑÂ∑•‰ΩúÁ∫øÁ®ãÔºåÂ∞ÜÂÖ±‰∫´ËµÑÊ∫êËÆæÁΩÆ‰∏∫ÈîÅÂÆöÁä∂ÊÄÅÔºõÂ¶ÇÊûúÂÖ±‰∫´ËµÑÊ∫êË¢´Âç†Áî®ÔºåÂ∞±ÈúÄË¶Å‰∏ÄÂÆöÁöÑÈòªÂ°ûÁ≠âÂæÖÂî§ÈÜíÊú∫Âà∂Êù•‰øùËØÅÈîÅÂàÜÈÖç„ÄÇËøô‰∏™Êú∫Âà∂‰∏ªË¶ÅÁî±ËØ•ÈòüÂàóÂÆûÁé∞„ÄÇ</p>
<p>Âè¶Â§ñÔºåAQSËøòÂÆö‰πâ‰∫Ü‰∏§ÁªÑËé∑ÂèñÂíåÈáäÊîæËµÑÊ∫êÁöÑÊñπÊ≥ïÔºåÁã¨Âç†ÂºèËé∑Âèñ/ÈáäÊîæËµÑÊ∫êÁöÑÊñπÊ≥ï tryAcquireÂíåtryReleaseÔºå‰ª•ÂèäÂÖ±‰∫´ÂºèËé∑Âèñ/ÈáäÊîæËµÑÊ∫êÁöÑÊñπÊ≥ïtryAcquireShared Âíå tryReleaseShared„ÄÇAQSÈíàÂØπËøô‰∏§ÁªÑÊñπÊ≥ïÊ≤°ÊúâÈªòËÆ§ÂÆûÁé∞ÔºåÂè™ÊòØÂÆö‰πâ‰∫Ü‰∏§Â•óÊ®°ÊùøÊñπÊ≥ïÔºåÁî±ÂÖ∑‰ΩìÊòØÂêåÊ≠•Âô®Êù•ÂÆûÁé∞„ÄÇ</p>
<blockquote>
<p><strong>ÊÄªÁªìËµ∑Êù•Â≠êÁ±ªÁöÑ‰ªªÂä°ÊúâÔºö</strong></p>
<ol>
<li>ÈÄöËøá<code>CAS</code>Êìç‰ΩúÁª¥Êä§ÂÖ±‰∫´ÂèòÈáè<code>state</code>„ÄÇ</li>
<li>ÈáçÂÜôËµÑÊ∫êÁöÑËé∑ÂèñÊñπÂºè„ÄÇ</li>
<li>ÈáçÂÜôËµÑÊ∫êÈáäÊîæÁöÑÊñπÂºè„ÄÇ</li>
</ol>
</blockquote>
<p><img src="../img/java/32.png"></p>
<p>AQSÊòØ‰∏Ä‰∏™FIFOÁöÑÂèåÂêëÈòüÂàóÔºåÂÖ∂ÂÜÖÈÉ®ÈÄöËøáËäÇÁÇπheadÂíåtailËÆ∞ÂΩïÈòüÈ¶ñÂíåÈòüÂ∞æÂÖÉÁ¥†ÔºåÈòüÂàóÂÖÉÁ¥†ÁöÑÁ±ªÂûã‰∏∫Node„ÄÇNode ‰∏≠ÊúâÂ¶Ç‰∏ãÂá†‰∏™ÂèòÈáèÔºö</p>
<ul>
<li>threadÂèòÈáèÔºöÁî®Êù•Â≠òÊîæËøõÂÖ•AQSÈòüÂàóÈáåÈù¢ÁöÑÁ∫øÁ®ã</li>
<li>SHAREDÔºöÁî®Êù•Ê†áËÆ∞ËØ•Á∫øÁ®ãÊòØËé∑ÂèñÂÖ±‰∫´ËµÑÊ∫êÊó∂Ë¢´ÈòªÂ°ûÊåÇËµ∑ÂêéÊîæÂÖ•AQSÈòüÂàóÁöÑ</li>
<li>EXCLUSIVEÔºöÁî®Êù•Ê†áËÆ∞Á∫øÁ®ãÊòØËé∑ÂèñÁã¨Âç†ËµÑÊ∫êÊó∂Ë¢´ÊåÇËµ∑ÂêéÊîæÂÖ•AQSÈòüÂàóÁöÑ</li>
<li>waitStatusÔºöËÆ∞ÂΩïÂΩìÂâçÁ∫øÁ®ãÁ≠âÂæÖÁä∂ÊÄÅÔºåÂèØ‰ª•‰∏∫CANCELLEDÔºàÁ∫øÁ®ãË¢´ÂèñÊ∂à‰∫ÜÔºâ„ÄÅSIGNALÔºàÁ∫øÁ®ãÈúÄË¶ÅË¢´Âî§ÈÜíÔºâ„ÄÅCONDITIONÔºàÁ∫øÁ®ãÂú®Êù°‰ª∂ÈòüÂàóÈáåÈù¢Á≠âÂæÖÔºâ„ÄÅPROPAGATEÔºàÈáäÊîæÂÖ±‰∫´ËµÑÊ∫êÊó∂ÈúÄË¶ÅÈÄöÁü•ÂÖ∂‰ªñËäÇÁÇπÔºâ</li>
<li>prevÔºöËÆ∞ÂΩïÂΩìÂâçËäÇÁÇπÁöÑÂâçÈ©±ËäÇÁÇπ</li>
<li>nextÔºöËÆ∞ÂΩïÂΩìÂâçËäÇÁÇπÁöÑÂêéÁªßËäÇÁÇπ„ÄÇ</li>
</ul>
<p>ÂØπ‰∫éAQSÊù•ËØ¥ÔºåÁ∫øÁ®ãÂêåÊ≠•ÁöÑÂÖ≥ÈîÆÊòØÂØπÁä∂ÊÄÅÂÄºstateËøõË°åÊìç‰Ωú„ÄÇÊ†πÊçÆstateÊòØÂê¶Â±û‰∫é‰∏Ä‰∏™Á∫øÁ®ãÔºåÊìç‰ΩústateÁöÑÊñπÂºèÂàÜ‰∏∫Áã¨Âç†ÊñπÂºèÂíåÂÖ±‰∫´ÊñπÂºè„ÄÇ</p>
<ul>
<li>Âú®Áã¨Âç†ÊñπÂºè‰∏ãËé∑ÂèñÂíåÈáäÊîæËµÑÊ∫ê‰ΩøÁî®ÁöÑÊñπÊ≥ï‰∏∫Ôºö void acquireÔºàint argÔºâvoid acquireInterruptiblyÔºàint argÔºâboolean releaseÔºàint argÔºâ„ÄÇ</li>
<li>Âú®ÂÖ±‰∫´ÊñπÂºè‰∏ãËé∑ÂèñÂíåÈáäÊîæËµÑÊ∫êÁöÑÊñπÊ≥ï‰∏∫Ôºö void acquireSharedÔºàint argÔºâvoidacquireSharedInterruptiblyÔºàint argÔºâboolean releaseSharedÔºàint argÔºâ„ÄÇ</li>
</ul>
<p><strong>Âú®Áã¨Âç†ÊñπÂºè‰∏ãÔºåËé∑Âèñ‰∏éÈáäÊîæËµÑÊ∫êÁöÑÊµÅÁ®ãÂ¶Ç‰∏ãÔºö</strong></p>
<ol>
<li>ÂΩì‰∏Ä‰∏™Á∫øÁ®ãË∞ÉÁî®acquireÔºàint argÔºâÊñπÊ≥ïËé∑ÂèñÁã¨Âç†ËµÑÊ∫êÊó∂Ôºå‰ºöÈ¶ñÂÖà‰ΩøÁî®tryAcquireÊñπÊ≥ïÂ∞ùËØïËé∑ÂèñËµÑÊ∫êÔºåÂÖ∑‰ΩìÊòØËÆæÁΩÆÁä∂ÊÄÅÂèòÈáèstateÁöÑÂÄºÔºåÊàêÂäüÂàôÁõ¥Êé•ËøîÂõûÔºåÂ§±Ë¥•ÂàôÂ∞ÜÂΩìÂâçÁ∫øÁ®ãÂ∞ÅË£Ö‰∏∫Á±ªÂûã‰∏∫Node.EXCLUSIVEÁöÑNodeËäÇÁÇπÂêéÊèíÂÖ•Âà∞AQSÈòªÂ°ûÈòüÂàóÁöÑÂ∞æÈÉ®ÔºåÂπ∂Ë∞ÉÁî®LockSupport.parkÔºàthisÔºâÊñπÊ≥ïÊåÇËµ∑Ëá™Â∑±„ÄÇ</li>
<li>ÂΩì‰∏Ä‰∏™Á∫øÁ®ãË∞ÉÁî®releaseÔºàint argÔºâÊñπÊ≥ïÊó∂‰ºöÂ∞ùËØï‰ΩøÁî®tryReleaseÊìç‰ΩúÈáäÊîæËµÑÊ∫êÔºåËøôÈáåÊòØËÆæÁΩÆÁä∂ÊÄÅÂèòÈáèstateÁöÑÂÄºÔºåÁÑ∂ÂêéË∞ÉÁî®LockSupport.unparkÔºàthreadÔºâÊñπÊ≥ïÊøÄÊ¥ªAQSÈòüÂàóÈáåÈù¢Ë¢´ÈòªÂ°ûÁöÑ‰∏Ä‰∏™Á∫øÁ®ãÔºàthreadÔºâ„ÄÇË¢´ÊøÄÊ¥ªÁöÑÁ∫øÁ®ãÂàô‰ΩøÁî®tryAcquireÂ∞ùËØïÔºåÁúãÂΩìÂâçÁä∂ÊÄÅÂèòÈáèstateÁöÑÂÄºÊòØÂê¶ËÉΩÊª°Ë∂≥Ëá™Â∑±ÁöÑÈúÄË¶ÅÔºåÊª°Ë∂≥ÂàôËØ•Á∫øÁ®ãË¢´ÊøÄÊ¥ªÔºåÁÑ∂ÂêéÁªßÁª≠Âêë‰∏ãËøêË°åÔºåÂê¶ÂàôËøòÊòØ‰ºöË¢´ÊîæÂÖ•AQSÈòüÂàóÂπ∂Ë¢´ÊåÇËµ∑„ÄÇ</li>
</ol>
<p>ÈúÄË¶ÅÊ≥®ÊÑèÁöÑÊòØÔºåAQSÁ±ªÂπ∂Ê≤°ÊúâÊèê‰æõÂèØÁî®ÁöÑtryAcquireÂíåtryReleaseÊñπÊ≥ïÔºåÊ≠£Â¶ÇAQSÊòØÈîÅÈòªÂ°ûÂíåÂêåÊ≠•Âô®ÁöÑÂü∫Á°ÄÊ°ÜÊû∂‰∏ÄÊ†∑ÔºåtryAcquireÂíåtryReleaseÈúÄË¶ÅÁî±ÂÖ∑‰ΩìÁöÑÂ≠êÁ±ªÊù•ÂÆûÁé∞„ÄÇÂ≠êÁ±ªÂú®ÂÆûÁé∞tryAcquireÂíåtryReleaseÊó∂Ë¶ÅÊ†πÊçÆÂÖ∑‰ΩìÂú∫ÊôØ‰ΩøÁî®CASÁÆóÊ≥ïÂ∞ùËØï‰øÆÊîπstateÁä∂ÊÄÅÂÄºÔºåÊàêÂäüÂàôËøîÂõûtrueÔºåÂê¶ÂàôËøîÂõûfalse„ÄÇÂ≠êÁ±ªËøòÈúÄË¶ÅÂÆö‰πâÔºåÂú®Ë∞ÉÁî®acquireÂíåreleaseÊñπÊ≥ïÊó∂stateÁä∂ÊÄÅÂÄºÁöÑÂ¢ûÂáè‰ª£Ë°®‰ªÄ‰πàÂê´‰πâ„ÄÇ</p>
<p><strong>Âú®ÂÖ±‰∫´ÊñπÂºè‰∏ãÔºåËé∑Âèñ‰∏éÈáäÊîæËµÑÊ∫êÁöÑÊµÅÁ®ãÂ¶Ç‰∏ãÔºö</strong></p>
<ol>
<li><p>ÂΩìÁ∫øÁ®ãË∞ÉÁî®acquireSharedÔºàint argÔºâËé∑ÂèñÂÖ±‰∫´ËµÑÊ∫êÊó∂Ôºå‰ºöÈ¶ñÂÖà‰ΩøÁî®tryAcquireSharedÂ∞ùËØïËé∑ÂèñËµÑÊ∫êÔºåÂÖ∑‰ΩìÊòØËÆæÁΩÆÁä∂ÊÄÅÂèòÈáèstateÁöÑÂÄºÔºåÊàêÂäüÂàôÁõ¥Êé•ËøîÂõûÔºåÂ§±Ë¥•ÂàôÂ∞ÜÂΩìÂâçÁ∫øÁ®ãÂ∞ÅË£Ö‰∏∫Á±ªÂûã‰∏∫Node.SHAREDÁöÑNodeËäÇÁÇπÂêéÊèíÂÖ•Âà∞AQSÈòªÂ°ûÈòüÂàóÁöÑÂ∞æÈÉ®ÔºåÂπ∂‰ΩøÁî®LockSupport.parkÔºàthisÔºâÊñπÊ≥ïÊåÇËµ∑Ëá™Â∑±„ÄÇ</p>
</li>
<li><p>ÂΩì‰∏Ä‰∏™Á∫øÁ®ãË∞ÉÁî®releaseSharedÔºàint argÔºâÊó∂‰ºöÂ∞ùËØï‰ΩøÁî®tryReleaseSharedÊìç‰ΩúÈáäÊîæËµÑÊ∫êÔºåËøôÈáåÊòØËÆæÁΩÆÁä∂ÊÄÅÂèòÈáèstateÁöÑÂÄºÔºåÁÑ∂Âêé‰ΩøÁî®LockSupport.unparkÔºàthreadÔºâÊøÄÊ¥ªAQSÈòüÂàóÈáåÈù¢Ë¢´ÈòªÂ°ûÁöÑ‰∏Ä‰∏™Á∫øÁ®ãÔºàthreadÔºâ„ÄÇË¢´ÊøÄÊ¥ªÁöÑÁ∫øÁ®ãÂàô‰ΩøÁî®tryReleaseSharedÊü•ÁúãÂΩìÂâçÁä∂ÊÄÅÂèòÈáèstateÁöÑÂÄºÊòØÂê¶ËÉΩÊª°Ë∂≥Ëá™Â∑±ÁöÑÈúÄË¶ÅÔºåÊª°Ë∂≥ÂàôËØ•Á∫øÁ®ãË¢´ÊøÄÊ¥ªÔºåÁÑ∂ÂêéÁªßÁª≠Âêë‰∏ãËøêË°åÔºåÂê¶ÂàôËøòÊòØ‰ºöË¢´ÊîæÂÖ•AQSÈòüÂàóÂπ∂Ë¢´ÊåÇËµ∑„ÄÇ</p>
</li>
</ol>
<blockquote>
<p>Áã¨Âç†ÊñπÂºè‰∏ãÁöÑvoid acquireÔºàint argÔºâÂíåvoidacquireInterruptiblyÔºàint argÔºâÔºå‰∏éÂÖ±‰∫´ÊñπÂºè‰∏ãÁöÑvoid acquireSharedÔºàintargÔºâÂíåvoid acquireSharedInterruptiblyÔºàint argÔºâÔºåËøô‰∏§Â•óÂáΩÊï∞‰∏≠ÈÉΩÊúâ‰∏Ä‰∏™Â∏¶ÊúâInterruptiblyÂÖ≥ÈîÆÂ≠óÁöÑÂáΩÊï∞ÔºåÈÇ£‰πàÂ∏¶Ëøô‰∏™ÂÖ≥ÈîÆÂ≠óÂíå‰∏çÂ∏¶Êúâ‰ªÄ‰πàÂå∫Âà´Âë¢Ôºü</p>
<p>Êàë‰ª¨Êù•ËÆ≤ËÆ≤„ÄÇÂÖ∂ÂÆû‰∏çÂ∏¶InterruptiblyÂÖ≥ÈîÆÂ≠óÁöÑÊñπÊ≥ïÁöÑÊÑèÊÄùÊòØ‰∏çÂØπ‰∏≠Êñ≠ËøõË°åÂìçÂ∫îÔºå‰πüÂ∞±ÊòØÁ∫øÁ®ãÂú®Ë∞ÉÁî®‰∏çÂ∏¶InterruptiblyÂÖ≥ÈîÆÂ≠óÁöÑÊñπÊ≥ïËé∑ÂèñËµÑÊ∫êÊó∂ÊàñËÄÖËé∑ÂèñËµÑÊ∫êÂ§±Ë¥•Ë¢´ÊåÇËµ∑Êó∂ÔºåÂÖ∂‰ªñÁ∫øÁ®ã‰∏≠Êñ≠‰∫ÜËØ•Á∫øÁ®ãÔºåÈÇ£‰πàËØ•Á∫øÁ®ã‰∏ç‰ºöÂõ†‰∏∫Ë¢´‰∏≠Êñ≠ËÄåÊäõÂá∫ÂºÇÂ∏∏ÔºåÂÆÉËøòÊòØÁªßÁª≠Ëé∑ÂèñËµÑÊ∫êÊàñËÄÖË¢´ÊåÇËµ∑Ôºå‰πüÂ∞±ÊòØËØ¥‰∏çÂØπ‰∏≠Êñ≠ËøõË°åÂìçÂ∫îÔºåÂøΩÁï•‰∏≠Êñ≠„ÄÇËÄåÂ∏¶InterruptiblyÂÖ≥ÈîÆÂ≠óÁöÑÊñπÊ≥ïË¶ÅÂØπ‰∏≠Êñ≠ËøõË°åÂìçÂ∫îÔºå‰πüÂ∞±ÊòØÁ∫øÁ®ãÂú®Ë∞ÉÁî®Â∏¶InterruptiblyÂÖ≥ÈîÆÂ≠óÁöÑÊñπÊ≥ïËé∑ÂèñËµÑÊ∫êÊó∂ÊàñËÄÖËé∑ÂèñËµÑÊ∫êÂ§±Ë¥•Ë¢´ÊåÇËµ∑Êó∂ÔºåÂÖ∂‰ªñÁ∫øÁ®ã‰∏≠Êñ≠‰∫ÜËØ•Á∫øÁ®ãÔºåÈÇ£‰πàËØ•Á∫øÁ®ã‰ºöÊäõÂá∫InterruptedExceptionÂºÇÂ∏∏ËÄåËøîÂõû„ÄÇ</p>
</blockquote>
<p><a target="_blank" rel="noopener" href="https://tech.meituan.com/2019/12/05/aqs-theory-and-apply.html">https://tech.meituan.com/2019/12/05/aqs-theory-and-apply.html</a></p>
<p><a target="_blank" rel="noopener" href="https://www.cnblogs.com/wang-meng/p/12816829.html">https://www.cnblogs.com/wang-meng/p/12816829.html</a></p>
<p><a target="_blank" rel="noopener" href="https://ddnd.cn/2019/03/15/java-abstractqueuedsynchronizer/">https://ddnd.cn/2019/03/15/java-abstractqueuedsynchronizer/</a></p>
<h2 id="ReentrantLock-ÂéüÁêÜ"><a href="#ReentrantLock-ÂéüÁêÜ" class="headerlink" title="ReentrantLock ÂéüÁêÜ"></a>ReentrantLock ÂéüÁêÜ</h2><p><a target="_blank" rel="noopener" href="https://juejin.cn/post/6844903805683761165">https://juejin.cn/post/6844903805683761165</a></p>
<p>ÂØπ AQS ËøõË°åÁÆÄÂçï‰ªãÁªç</p>
<p>ReentrantLockÂÆûÁé∞‰∫Ü Lock Êé•Âè£ÔºåÂê´Êúâ3‰∏™ÂÜÖÈÉ®Á±ªÔºåÂÖ∂‰∏≠SyncÂÜÖÈÉ®Á±ªÁªßÊâøËá™AQS ÂÆûÁé∞‰∫ÜÁã¨Âç†ÂºèËé∑ÂèñÂíåÈáäÊîæËµÑÊ∫êÁöÑÊñπÊ≥ï„ÄÇÂè¶Â§ñÁöÑ‰∏§‰∏™ÂÜÖÈÉ®Á±ªÁªßÊâøËá™<code>Sync</code>ÔºåËøô‰∏§‰∏™Á±ªÂàÜÂà´ÊòØÁî®Êù•<strong>ÂÖ¨Âπ≥ÈîÅÂíåÈùûÂÖ¨Âπ≥ÈîÅ</strong>ÁöÑ„ÄÇ</p>
<p><code>ReentrantLock</code>Êúâ‰∏§‰∏™ÊûÑÈÄ†ÊñπÊ≥ïÔºåÊó†ÂèÇÊûÑÈÄ†ÊñπÊ≥ïÈªòËÆ§ÊòØÂàõÂª∫<strong>ÈùûÂÖ¨Âπ≥ÈîÅ</strong>ÔºåËÄå‰º†ÂÖ•<code>true</code>‰∏∫ÂèÇÊï∞ÁöÑÊûÑÈÄ†ÊñπÊ≥ïÂàõÂª∫ÁöÑÊòØ<strong>ÂÖ¨Âπ≥ÈîÅ</strong>„ÄÇ</p>
<h3 id="ÈùûÂÖ¨Âπ≥ÈîÅÁöÑÂÆûÁé∞ÂéüÁêÜ"><a href="#ÈùûÂÖ¨Âπ≥ÈîÅÁöÑÂÆûÁé∞ÂéüÁêÜ" class="headerlink" title="ÈùûÂÖ¨Âπ≥ÈîÅÁöÑÂÆûÁé∞ÂéüÁêÜ"></a>ÈùûÂÖ¨Âπ≥ÈîÅÁöÑÂÆûÁé∞ÂéüÁêÜ</h3><p>ÂΩìÊàë‰ª¨‰ΩøÁî®Êó†ÂèÇÊûÑÈÄ†ÊñπÊ≥ïÊûÑÈÄ†ÁöÑÊó∂ÂÄôÂç≥<code>ReentrantLock lock = new ReentrantLock()</code>ÔºåÂàõÂª∫ÁöÑÂ∞±ÊòØÈùûÂÖ¨Âπ≥ÈîÅ„ÄÇ</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="title">ReentrantLock</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    sync = <span class="keyword">new</span> NonfairSync();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//ÊàñËÄÖ‰º†ÂÖ•falseÂèÇÊï∞ ÂàõÂª∫ÁöÑ‰πüÊòØÈùûÂÖ¨Âπ≥ÈîÅ</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="title">ReentrantLock</span><span class="params">(<span class="keyword">boolean</span> fair)</span> </span>&#123;</span><br><span class="line">    sync = fair ? <span class="keyword">new</span> FairSync() : <span class="keyword">new</span> NonfairSync();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>lock ÊñπÊ≥ïËé∑ÂèñÈîÅ</strong></p>
<p><code>lock</code>ÊñπÊ≥ïË∞ÉÁî®<code>CAS</code>ÊñπÊ≥ïËÆæÁΩÆ<code>state</code>ÁöÑÂÄºÔºåÂ¶ÇÊûú<code>state</code>Á≠â‰∫éÊúüÊúõÂÄº<code>0</code>(‰ª£Ë°®ÈîÅÊ≤°ÊúâË¢´Âç†Áî®)ÔºåÈÇ£‰πàÂ∞±Â∞Ü<code>state</code>Êõ¥Êñ∞‰∏∫<code>1</code>(‰ª£Ë°®ËØ•Á∫øÁ®ãËé∑ÂèñÈîÅÊàêÂäü)ÔºåÁÑ∂ÂêéÊâßË°å<code>setExclusiveOwnerThread</code>ÊñπÊ≥ïÁõ¥Êé•Â∞ÜËØ•Á∫øÁ®ãËÆæÁΩÆÊàêÈîÅÁöÑÊâÄÊúâËÄÖ„ÄÇÂ¶ÇÊûú<code>CAS</code>ËÆæÁΩÆ<code>state</code>ÁöÑÂÄºÂ§±Ë¥•ÔºåÂç≥<code>state</code>‰∏çÁ≠â‰∫é<code>0</code>Ôºå‰ª£Ë°®ÈîÅÊ≠£Âú®Ë¢´Âç†È¢ÜÁùÄÔºåÂàôÊâßË°å<code>acquire(1)</code>ÔºåÂç≥‰∏ãÈù¢ÁöÑÊ≠•È™§„ÄÇ</p>
<p><code>nonfairTryAcquire</code>ÊñπÊ≥ïÈ¶ñÂÖàË∞ÉÁî®<code>getState</code>ÊñπÊ≥ïËé∑Âèñ<code>state</code>ÁöÑÂÄºÔºåÂ¶ÇÊûú<code>state</code>ÁöÑÂÄº‰∏∫<code>0</code>(‰πãÂâçÂç†È¢ÜÈîÅÁöÑÁ∫øÁ®ãÂàöÂ•ΩÈáäÊîæ‰∫ÜÈîÅ)ÔºåÈÇ£‰πàÂ∞±Áî®<code>CAS</code>ËÆæÁΩÆ<code>state</code>ÁöÑÂÄºÔºåËÆæÁΩÆÊàêÂäüÂàôÂ∞ÜËØ•Á∫øÁ®ãËÆæÁΩÆÊàêÈîÅÁöÑÊâÄÊúâËÄÖÔºåÂπ∂‰∏îËøîÂõû<code>true</code>„ÄÇÂ¶ÇÊûú<code>state</code>ÁöÑÂÄº‰∏ç‰∏∫<code>0</code>ÔºåÈÇ£Â∞±<strong>Ë∞ÉÁî®<code>getExclusiveOwnerThread</code>ÊñπÊ≥ïÊü•ÁúãÂç†Áî®ÈîÅÁöÑÁ∫øÁ®ãÊòØ‰∏çÊòØËá™Â∑±</strong>ÔºåÂ¶ÇÊûúÊòØÁöÑËØùÈÇ£Â∞±Áõ¥Êé•Â∞Ü<code>state + 1</code>ÔºåÁÑ∂ÂêéËøîÂõû<code>true</code>„ÄÇÂ¶ÇÊûú<code>state</code>‰∏ç‰∏∫<code>0</code>‰∏îÈîÅÁöÑÊâÄÊúâËÄÖÂèà‰∏çÊòØËá™Â∑±ÔºåÈÇ£Â∞±ËøîÂõû<code>false</code>Ôºå<strong>ÁÑ∂ÂêéÁ∫øÁ®ã‰ºöËøõÂÖ•Âà∞ÂêåÊ≠•ÈòüÂàó‰∏≠</strong>„ÄÇ</p>
<p><img src="../img/java/57.png"></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">final</span> <span class="keyword">void</span> <span class="title">lock</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="comment">//CASÊìç‰ΩúËÆæÁΩÆstateÁöÑÂÄº</span></span><br><span class="line">    <span class="keyword">if</span> (compareAndSetState(<span class="number">0</span>, <span class="number">1</span>))</span><br><span class="line">        <span class="comment">//ËÆæÁΩÆÊàêÂäü Áõ¥Êé•Â∞ÜÈîÅÁöÑÊâÄÊúâËÄÖËÆæÁΩÆ‰∏∫ÂΩìÂâçÁ∫øÁ®ã ÊµÅÁ®ãÁªìÊùü</span></span><br><span class="line">        setExclusiveOwnerThread(Thread.currentThread());</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">        <span class="comment">//ËÆæÁΩÆÂ§±Ë¥• ÂàôËøõË°åÂêéÁª≠ÁöÑÂä†ÂÖ•ÂêåÊ≠•ÈòüÂàóÂáÜÂ§á</span></span><br><span class="line">        acquire(<span class="number">1</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">final</span> <span class="keyword">void</span> <span class="title">acquire</span><span class="params">(<span class="keyword">int</span> arg)</span> </span>&#123;</span><br><span class="line">    <span class="comment">//Ë∞ÉÁî®Â≠êÁ±ªÈáçÂÜôÁöÑtryAcquireÊñπÊ≥ï Â¶ÇÊûútryAcquireÊñπÊ≥ïËøîÂõûfalse ÈÇ£‰πàÁ∫øÁ®ãÂ∞±‰ºöËøõÂÖ•ÂêåÊ≠•ÈòüÂàó</span></span><br><span class="line">    <span class="keyword">if</span> (!tryAcquire(arg) &amp;&amp;</span><br><span class="line">        acquireQueued(addWaiter(Node.EXCLUSIVE), arg))</span><br><span class="line">        selfInterrupt();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//Â≠êÁ±ªÈáçÂÜôÁöÑtryAcquireÊñπÊ≥ï</span></span><br><span class="line"><span class="function"><span class="keyword">protected</span> <span class="keyword">final</span> <span class="keyword">boolean</span> <span class="title">tryAcquire</span><span class="params">(<span class="keyword">int</span> acquires)</span> </span>&#123;</span><br><span class="line">    <span class="comment">//Ë∞ÉÁî®nonfairTryAcquireÊñπÊ≥ï</span></span><br><span class="line">    <span class="keyword">return</span> nonfairTryAcquire(acquires);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">final</span> <span class="keyword">boolean</span> <span class="title">nonfairTryAcquire</span><span class="params">(<span class="keyword">int</span> acquires)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">final</span> Thread current = Thread.currentThread();</span><br><span class="line">    <span class="keyword">int</span> c = getState();</span><br><span class="line">    <span class="comment">//Â¶ÇÊûúÁä∂ÊÄÅstate=0ÔºåÂç≥Âú®ËøôÊÆµÊó∂Èó¥ÂÜÖ ÈîÅÁöÑÊâÄÊúâËÄÖÊääÈîÅÈáäÊîæ‰∫Ü ÈÇ£‰πàËøôÈáåstateÂ∞±‰∏∫0</span></span><br><span class="line">    <span class="keyword">if</span> (c == <span class="number">0</span>) &#123;</span><br><span class="line">        <span class="comment">//‰ΩøÁî®CASÊìç‰ΩúËÆæÁΩÆstateÁöÑÂÄº</span></span><br><span class="line">        <span class="keyword">if</span> (compareAndSetState(<span class="number">0</span>, acquires)) &#123;</span><br><span class="line">            <span class="comment">//Êìç‰ΩúÊàêÂäü ÂàôÂ∞ÜÈîÅÁöÑÊâÄÊúâËÄÖËÆæÁΩÆÊàêÂΩìÂâçÁ∫øÁ®ã ‰∏îËøîÂõûtrueÔºå‰πüÂ∞±ÊòØÂΩìÂâçÁ∫øÁ®ã‰∏ç‰ºöËøõÂÖ•ÂêåÊ≠•</span></span><br><span class="line">            <span class="comment">//ÈòüÂàó„ÄÇ</span></span><br><span class="line">            setExclusiveOwnerThread(current);</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//Â¶ÇÊûúÁä∂ÊÄÅstate‰∏çÁ≠â‰∫é0Ôºå‰πüÂ∞±ÊòØÊúâÁ∫øÁ®ãÊ≠£Âú®Âç†Áî®ÈîÅÔºåÈÇ£‰πàÂÖàÊ£ÄÊü•‰∏Ä‰∏ãËøô‰∏™Á∫øÁ®ãÊòØ‰∏çÊòØËá™Â∑±</span></span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span> (current == getExclusiveOwnerThread()) &#123;</span><br><span class="line">        <span class="comment">//Â¶ÇÊûúÁ∫øÁ®ãÂ∞±ÊòØËá™Â∑±‰∫ÜÔºåÈÇ£‰πàÁõ¥Êé•Â∞Üstate+1ÔºåËøîÂõûtrueÔºå‰∏çÈúÄË¶ÅÂÜçËé∑ÂèñÈîÅ Âõ†‰∏∫ÈîÅÂ∞±Âú®Ëá™Â∑±</span></span><br><span class="line">        <span class="comment">//Ë∫´‰∏ä‰∫Ü„ÄÇ</span></span><br><span class="line">        <span class="keyword">int</span> nextc = c + acquires;</span><br><span class="line">        <span class="keyword">if</span> (nextc &lt; <span class="number">0</span>) <span class="comment">// overflow</span></span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> Error(<span class="string">&quot;Maximum lock count exceeded&quot;</span>);</span><br><span class="line">        setState(nextc);</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//Â¶ÇÊûústate‰∏çÁ≠â‰∫é0Ôºå‰∏îÈîÅÁöÑÊâÄÊúâËÄÖÂèà‰∏çÊòØËá™Â∑±ÔºåÈÇ£‰πàÁ∫øÁ®ãÂ∞±‰ºöËøõÂÖ•Âà∞ÂêåÊ≠•ÈòüÂàó„ÄÇ</span></span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>tryReleaseÈîÅÁöÑÈáäÊîæ</strong></p>
<ol>
<li>Âà§Êñ≠ÂΩìÂâçÁ∫øÁ®ãÊòØ‰∏çÊòØÈîÅÁöÑÊâÄÊúâËÄÖÔºåÂ¶ÇÊûúÊòØÂàôËøõË°åÊ≠•È™§<code>2</code>ÔºåÂ¶ÇÊûú‰∏çÊòØÂàôÊäõÂá∫ÂºÇÂ∏∏„ÄÇ</li>
<li>Âà§Êñ≠Ê≠§Ê¨°ÈáäÊîæÈîÅÂêé<code>state</code>ÁöÑÂÄºÊòØÂê¶‰∏∫0ÔºåÂ¶ÇÊûúÊòØÂàô‰ª£Ë°®<strong>ÈîÅÊúâÊ≤°ÊúâÈáçÂÖ•</strong>ÔºåÁÑ∂ÂêéÂ∞ÜÈîÅÁöÑÊâÄÊúâËÄÖËÆæÁΩÆÊàê<code>null</code>‰∏îËøîÂõû<code>true</code>ÔºåÁÑ∂ÂêéÊâßË°åÊ≠•È™§<code>3</code>ÔºåÂ¶ÇÊûú‰∏çÊòØÂàô<strong>‰ª£Ë°®ÈîÅÂèëÁîü‰∫ÜÈáçÂÖ•</strong>ÊâßË°åÊ≠•È™§<code>4</code>„ÄÇ</li>
<li>Áé∞Âú®ÈîÅÂ∑≤ÁªèÈáäÊîæÂÆåÔºåÂç≥<code>state=0</code>ÔºåÂî§ÈÜíÂêåÊ≠•ÈòüÂàó‰∏≠ÁöÑÂêéÁªßËäÇÁÇπËøõË°åÈîÅÁöÑËé∑Âèñ„ÄÇ</li>
<li>ÈîÅËøòÊ≤°ÊúâÈáäÊîæÂÆåÔºåÂç≥<code>state!=0</code>Ôºå‰∏çÂî§ÈÜíÂêåÊ≠•ÈòüÂàó„ÄÇ</li>
</ol>
<p><img src="../img/java/58.png"></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">unlock</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    sync.release(<span class="number">1</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">final</span> <span class="keyword">boolean</span> <span class="title">release</span><span class="params">(<span class="keyword">int</span> arg)</span> </span>&#123;</span><br><span class="line">    <span class="comment">//Â≠êÁ±ªÈáçÂÜôÁöÑtryReleaseÊñπÊ≥ïÔºåÈúÄË¶ÅÁ≠âÈîÅÁöÑstate=0ÔºåÂç≥tryReleaseËøîÂõûtrueÁöÑÊó∂ÂÄôÔºåÊâç‰ºöÂéªÂî§ÈÜíÂÖ∂</span></span><br><span class="line">    <span class="comment">//ÂÆÉÁ∫øÁ®ãËøõË°åÂ∞ùËØïËé∑ÂèñÈîÅ„ÄÇ</span></span><br><span class="line">    <span class="keyword">if</span> (tryRelease(arg)) &#123;</span><br><span class="line">        Node h = head;</span><br><span class="line">        <span class="keyword">if</span> (h != <span class="keyword">null</span> &amp;&amp; h.waitStatus != <span class="number">0</span>)</span><br><span class="line">            unparkSuccessor(h);</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">&#125;</span><br><span class="line">    </span><br><span class="line"><span class="function"><span class="keyword">protected</span> <span class="keyword">final</span> <span class="keyword">boolean</span> <span class="title">tryRelease</span><span class="params">(<span class="keyword">int</span> releases)</span> </span>&#123;</span><br><span class="line">    <span class="comment">//Áä∂ÊÄÅÁöÑstateÂáèÂéªreleases</span></span><br><span class="line">    <span class="keyword">int</span> c = getState() - releases;</span><br><span class="line">    <span class="comment">//Âà§Êñ≠ÈîÅÁöÑÊâÄÊúâËÄÖÊòØ‰∏çÊòØËØ•Á∫øÁ®ã</span></span><br><span class="line">    <span class="keyword">if</span> (Thread.currentThread() != getExclusiveOwnerThread())</span><br><span class="line">        <span class="comment">//Â¶ÇÊûúÊâÄÁöÑÊâÄÊúâËÄÖ‰∏çÊòØËØ•Á∫øÁ®ã ÂàôÊäõÂá∫ÂºÇÂ∏∏ ‰πüÂ∞±ÊòØÈîÅÈáäÊîæÁöÑÂâçÊèêÊòØÁ∫øÁ®ãÊã•ÊúâËøô‰∏™ÈîÅÔºå</span></span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> IllegalMonitorStateException();</span><br><span class="line">    <span class="keyword">boolean</span> free = <span class="keyword">false</span>;</span><br><span class="line">    <span class="comment">//Â¶ÇÊûúËØ•Á∫øÁ®ãÈáäÊîæÈîÅ‰πãÂêé Áä∂ÊÄÅstate=0ÔºåÂç≥ÈîÅÊ≤°ÊúâÈáçÂÖ•ÔºåÈÇ£‰πàÁõ¥Êé•Â∞ÜÂ∞ÜÈîÅÁöÑÊâÄÊúâËÄÖËÆæÁΩÆÊàênull</span></span><br><span class="line">    <span class="comment">//Âπ∂‰∏îËøîÂõûtrueÔºåÂç≥‰ª£Ë°®ÂèØ‰ª•Âî§ÈÜíÂÖ∂‰ªñÁ∫øÁ®ãÂéªËé∑ÂèñÈîÅ‰∫Ü„ÄÇÂ¶ÇÊûúËØ•Á∫øÁ®ãÈáäÊîæÈîÅ‰πãÂêéstate‰∏çÁ≠â‰∫é0Ôºå</span></span><br><span class="line">    <span class="comment">//ÈÇ£‰πà‰ª£Ë°®ÈîÅÈáçÂÖ•‰∫ÜÔºåËøîÂõûfalseÔºå‰ª£Ë°®ÈîÅËøòÊú™Ê≠£Âú®ÈáäÊîæÔºå‰∏çÁî®ÂéªÂî§ÈÜíÂÖ∂‰ªñÁ∫øÁ®ã„ÄÇ</span></span><br><span class="line">    <span class="keyword">if</span> (c == <span class="number">0</span>) &#123;</span><br><span class="line">        free = <span class="keyword">true</span>;</span><br><span class="line">        setExclusiveOwnerThread(<span class="keyword">null</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    setState(c);</span><br><span class="line">    <span class="keyword">return</span> free;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="ÂÖ¨Âπ≥ÈîÅÁöÑÂÆûÁé∞ÂéüÁêÜ"><a href="#ÂÖ¨Âπ≥ÈîÅÁöÑÂÆûÁé∞ÂéüÁêÜ" class="headerlink" title="ÂÖ¨Âπ≥ÈîÅÁöÑÂÆûÁé∞ÂéüÁêÜ"></a>ÂÖ¨Âπ≥ÈîÅÁöÑÂÆûÁé∞ÂéüÁêÜ</h3><p><strong>lockÊñπÊ≥ïËé∑ÂèñÈîÅ</strong></p>
<ol>
<li>Ëé∑ÂèñÁä∂ÊÄÅÁöÑ<code>state</code>ÁöÑÂÄºÔºåÂ¶ÇÊûú<code>state=0</code>Âç≥‰ª£Ë°®ÈîÅÊ≤°ÊúâË¢´ÂÖ∂ÂÆÉÁ∫øÁ®ãÂç†Áî®(‰ΩÜÊòØÂπ∂‰∏ç‰ª£Ë°®ÂêåÊ≠•ÈòüÂàóÊ≤°ÊúâÁ∫øÁ®ãÂú®Á≠âÂæÖ)ÔºåÊâßË°åÊ≠•È™§<code>2</code>„ÄÇÂ¶ÇÊûú<code>state!=0</code>Âàô‰ª£Ë°®ÈîÅÊ≠£Âú®Ë¢´ÂÖ∂ÂÆÉÁ∫øÁ®ãÂç†Áî®ÔºåÊâßË°åÊ≠•È™§<code>3</code>„ÄÇ</li>
<li><strong>Âà§Êñ≠ÂêåÊ≠•ÈòüÂàóÊòØÂê¶Â≠òÂú®Á∫øÁ®ã(ËäÇÁÇπ)ÔºåÂ¶ÇÊûú‰∏çÂ≠òÂú®ÂàôÁõ¥Êé•Â∞ÜÈîÅÁöÑÊâÄÊúâËÄÖËÆæÁΩÆÊàêÂΩìÂâçÁ∫øÁ®ãÔºå‰∏îÊõ¥Êñ∞Áä∂ÊÄÅstateÔºåÁÑ∂ÂêéËøîÂõûtrue„ÄÇ</strong></li>
<li><strong>Âà§Êñ≠ÈîÅÁöÑÊâÄÊúâËÄÖÊòØ‰∏çÊòØÂΩìÂâçÁ∫øÁ®ãÔºåÂ¶ÇÊûúÊòØÂàôÊõ¥Êñ∞Áä∂ÊÄÅstateÁöÑÂÄºÔºåÁÑ∂ÂêéËøîÂõûtrueÔºåÂ¶ÇÊûú‰∏çÊòØÔºåÈÇ£‰πàËøîÂõûfalseÔºåÂç≥Á∫øÁ®ã‰ºöË¢´Âä†ÂÖ•Âà∞ÂêåÊ≠•ÈòüÂàó‰∏≠</strong></li>
</ol>
<p>ÈÄöËøáÊ≠•È™§<code>2</code><strong>ÂÆûÁé∞‰∫ÜÈîÅËé∑ÂèñÁöÑÂÖ¨Âπ≥ÊÄßÔºåÂç≥ÈîÅÁöÑËé∑ÂèñÊåâÁÖßÂÖàÊù•ÂÖàÂæóÁöÑÈ°∫Â∫èÔºåÂêéÊù•ÁöÑ‰∏çËÉΩÊä¢ÂÖàËé∑ÂèñÈîÅÔºåÈùûÂÖ¨Âπ≥ÈîÅÂíåÂÖ¨Âπ≥ÈîÅ‰πüÊ≠£ÊòØÈÄöËøáËøô‰∏™Âå∫Âà´Êù•ÂÆûÁé∞‰∫ÜÈîÅÁöÑÂÖ¨Âπ≥ÊÄß„ÄÇ</strong></p>
<p><img src="../img/java/59.png"></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">final</span> <span class="keyword">void</span> <span class="title">lock</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    acquire(<span class="number">1</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">final</span> <span class="keyword">void</span> <span class="title">acquire</span><span class="params">(<span class="keyword">int</span> arg)</span> </span>&#123;</span><br><span class="line">    <span class="comment">//ÂêåÊ≠•ÈòüÂàó‰∏≠ÊúâÁ∫øÁ®ã ‰∏î ÈîÅÁöÑÊâÄÊúâËÄÖ‰∏çÊòØÂΩìÂâçÁ∫øÁ®ãÈÇ£‰πàÂ∞ÜÁ∫øÁ®ãÂä†ÂÖ•Âà∞ÂêåÊ≠•ÈòüÂàóÁöÑÂ∞æÈÉ®Ôºå</span></span><br><span class="line">    <span class="comment">//‰øùËØÅ‰∫ÜÂÖ¨Âπ≥ÊÄßÔºå‰πüÂ∞±ÊòØÂÖàÊù•ÁöÑÁ∫øÁ®ãÂÖàËé∑ÂæóÈîÅÔºåÂêéÊù•ÁöÑ‰∏çËÉΩÊä¢ÂÖàËé∑Âèñ„ÄÇ</span></span><br><span class="line">    <span class="keyword">if</span> (!tryAcquire(arg) &amp;&amp;</span><br><span class="line">        acquireQueued(addWaiter(Node.EXCLUSIVE), arg))</span><br><span class="line">        selfInterrupt();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">protected</span> <span class="keyword">final</span> <span class="keyword">boolean</span> <span class="title">tryAcquire</span><span class="params">(<span class="keyword">int</span> acquires)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">final</span> Thread current = Thread.currentThread();</span><br><span class="line">    <span class="keyword">int</span> c = getState();</span><br><span class="line">    <span class="comment">//Âà§Êñ≠Áä∂ÊÄÅstateÊòØÂê¶Á≠â‰∫é0ÔºåÁ≠â‰∫é0‰ª£Ë°®ÈîÅÊ≤°ÊúâË¢´Âç†Áî®Ôºå‰∏çÁ≠â‰∫é0Âàô‰ª£Ë°®ÈîÅË¢´Âç†Áî®ÁùÄ„ÄÇ</span></span><br><span class="line">    <span class="keyword">if</span> (c == <span class="number">0</span>) &#123;</span><br><span class="line">        <span class="comment">//Ë∞ÉÁî®hasQueuedPredecessorsÊñπÊ≥ïÂà§Êñ≠ÂêåÊ≠•ÈòüÂàó‰∏≠ÊòØÂê¶ÊúâÁ∫øÁ®ãÂú®Á≠âÂæÖÔºåÂ¶ÇÊûúÂêåÊ≠•ÈòüÂàó‰∏≠Ê≤°Êúâ</span></span><br><span class="line">        <span class="comment">//Á∫øÁ®ãÂú®Á≠âÂæÖ ÂàôÂΩìÂâçÁ∫øÁ®ãÊàê‰∏∫ÈîÅÁöÑÊâÄÊúâËÄÖÔºåÂ¶ÇÊûúÂêåÊ≠•ÈòüÂàó‰∏≠ÊúâÁ∫øÁ®ãÂú®Á≠âÂæÖÔºåÂàôÁªßÁª≠ÂæÄ‰∏ãÊâßË°å</span></span><br><span class="line">        <span class="comment">//Ëøô‰∏™Êú∫Âà∂Â∞±ÊòØÂÖ¨Âπ≥ÈîÅÁöÑÊú∫Âà∂Ôºå‰πüÂ∞±ÊòØÂÖàËÆ©ÂÖàÊù•ÁöÑÁ∫øÁ®ãËé∑ÂèñÈîÅÔºåÂêéÊù•ÁöÑ‰∏çËÉΩÊä¢ÂÖàËé∑Âèñ„ÄÇ</span></span><br><span class="line">        <span class="keyword">if</span> (!hasQueuedPredecessors() &amp;&amp;</span><br><span class="line">            compareAndSetState(<span class="number">0</span>, acquires)) &#123;</span><br><span class="line">            setExclusiveOwnerThread(current);</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//Âà§Êñ≠ÂΩìÂâçÁ∫øÁ®ãÊòØÂê¶‰∏∫ÈîÅÁöÑÊâÄÊúâËÄÖÔºåÂ¶ÇÊûúÊòØÔºåÈÇ£‰πàÁõ¥Êé•Êõ¥Êñ∞Áä∂ÊÄÅstateÔºåÁÑ∂ÂêéËøîÂõûtrue„ÄÇ</span></span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span> (current == getExclusiveOwnerThread()) &#123;</span><br><span class="line">        <span class="keyword">int</span> nextc = c + acquires;</span><br><span class="line">        <span class="keyword">if</span> (nextc &lt; <span class="number">0</span>)</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> Error(<span class="string">&quot;Maximum lock count exceeded&quot;</span>);</span><br><span class="line">        setState(nextc);</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//Â¶ÇÊûúÂêåÊ≠•ÈòüÂàó‰∏≠ÊúâÁ∫øÁ®ãÂ≠òÂú® ‰∏î ÈîÅÁöÑÊâÄÊúâËÄÖ‰∏çÊòØÂΩìÂâçÁ∫øÁ®ãÔºåÂàôËøîÂõûfalse„ÄÇ</span></span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>tryReleaseÈîÅÁöÑÈáäÊîæ</strong></p>
<p>ÂÖ¨Âπ≥ÈîÅÁöÑÈáäÊîæÂíåÈùûÂÖ¨Âπ≥ÈîÅÁöÑÈáäÊîæ‰∏ÄÊ†∑ÔºåËøôÈáåÂ∞±‰∏çÈáçÂ§ç„ÄÇ</p>
<p>ÂÖ¨Âπ≥ÈîÅÂíåÈùûÂÖ¨Âπ≥ÈîÅÁöÑÂÖ¨Âπ≥ÊÄßÊòØÂú®<strong>Ëé∑ÂèñÈîÅ</strong>ÁöÑÊó∂ÂÄô‰ΩìÁé∞Âá∫Êù•ÁöÑÔºåÈáäÊîæÁöÑÊó∂ÂÄôÈÉΩÊòØ‰∏ÄÊ†∑ÈáäÊîæÁöÑ„ÄÇ</p>
<h2 id="volatile"><a href="#volatile" class="headerlink" title="volatile"></a>volatile</h2><p><a target="_blank" rel="noopener" href="https://bbs.huaweicloud.com/blogs/239766">https://bbs.huaweicloud.com/blogs/239766</a></p>
<p>JavaËØ≠Ë®Ä‰∏∫‰∫ÜËß£ÂÜ≥Âπ∂ÂèëÁºñÁ®ã‰∏≠Â≠òÂú®ÁöÑÂéüÂ≠êÊÄß„ÄÅÂèØËßÅÊÄßÂíåÊúâÂ∫èÊÄßÈóÆÈ¢òÔºåÊèê‰æõ‰∫Ü‰∏ÄÁ≥ªÂàóÂíåÂπ∂ÂèëÂ§ÑÁêÜÁõ∏ÂÖ≥ÁöÑÂÖ≥ÈîÆÂ≠óÔºåÊØîÂ¶Ç<code>synchronized</code>„ÄÅ<code>volatile</code>„ÄÅ<code>final</code>„ÄÅ<code>concurrenÂåÖ</code>Á≠â„ÄÇ</p>
<p><code>volatile</code>Ëøô‰∏™ÂÖ≥ÈîÆÂ≠óÔºå‰∏ç‰ªÖ‰ªÖÂú®JavaËØ≠Ë®Ä‰∏≠ÊúâÔºåÂú®ÂæàÂ§öËØ≠Ë®Ä‰∏≠ÈÉΩÊúâÁöÑÔºåËÄå‰∏îÂÖ∂Áî®Ê≥ïÂíåËØ≠‰πâ‰πüÈÉΩÊòØ‰∏çÂ∞ΩÁõ∏ÂêåÁöÑ„ÄÇÈÉΩÂèØ‰ª•<strong>Áî®Êù•Â£∞ÊòéÂèòÈáèÊàñËÄÖÂØπË±°„ÄÇ</strong>‰∏ãÈù¢ÁÆÄÂçïÊù•‰ªãÁªç‰∏Ä‰∏ãJavaËØ≠Ë®Ä‰∏≠ÁöÑ<code>volatile</code>ÂÖ≥ÈîÆÂ≠ó„ÄÇ</p>
<ul>
<li>volatile ÂèØ‰ª•‰øùËØÅÂèØËßÅÊÄß</li>
<li>volatileÁ¶ÅÊ≠¢Êåá‰ª§ÈáçÊéí‰ºòÂåñÔºà‰∏ÄÂÆöÁ®ãÂ∫¶‰∏äÂèØ‰ª•‰øùËØÅÊúâÂ∫èÊÄßÔºâ</li>
<li>volatile ‰∏çËÉΩ‰øùËØÅÂéüÂ≠êÊÄß</li>
</ul>
<p>Âú®‰ª•‰∏ã‰∏§‰∏™Âú∫ÊôØ‰∏≠ÂèØ‰ª•‰ΩøÁî®<code>volatile</code>Êù•‰ª£Êõø<code>synchronized</code>Ôºö</p>
<blockquote>
<p>1„ÄÅËøêÁÆóÁªìÊûúÂπ∂‰∏ç‰æùËµñÂèòÈáèÁöÑÂΩìÂâçÂÄºÔºåÊàñËÄÖËÉΩÂ§üÁ°Æ‰øùÂè™ÊúâÂçï‰∏ÄÁöÑÁ∫øÁ®ã‰ºö‰øÆÊîπÂèòÈáèÁöÑÂÄº„ÄÇ</p>
<p>2„ÄÅÂèòÈáè‰∏çÈúÄË¶Å‰∏éÂÖ∂‰ªñÁä∂ÊÄÅÂèòÈáèÂÖ±ÂêåÂèÇ‰∏é‰∏çÂèòÁ∫¶Êùü„ÄÇ</p>
</blockquote>
<p>Èô§‰ª•‰∏äÂú∫ÊôØÂ§ñÔºåÈÉΩÈúÄË¶Å‰ΩøÁî®ÂÖ∂‰ªñÊñπÂºèÊù•‰øùËØÅÂéüÂ≠êÊÄßÔºåÂ¶Ç<code>synchronized</code>ÊàñËÄÖ<code>concurrentÂåÖ</code>„ÄÇ</p>
<h4 id="Áî®Ê≥ï"><a href="#Áî®Ê≥ï" class="headerlink" title="Áî®Ê≥ï"></a>Áî®Ê≥ï</h4><p><code>volatile</code>ÈÄöÂ∏∏Ë¢´ÊØîÂñªÊàê‚ÄùËΩªÈáèÁ∫ßÁöÑ<code>synchronized</code>‚ÄúÔºå‰πüÊòØJavaÂπ∂ÂèëÁºñÁ®ã‰∏≠ÊØîËæÉÈáçË¶ÅÁöÑ‰∏Ä‰∏™ÂÖ≥ÈîÆÂ≠ó„ÄÇÂíå<code>synchronized</code>‰∏çÂêåÔºå<code>volatile</code>ÊòØ‰∏Ä‰∏™ÂèòÈáè‰øÆÈ•∞Á¨¶Ôºå<strong>Âè™ËÉΩÁî®Êù•‰øÆÈ•∞ÂèòÈáè</strong>„ÄÇÊó†Ê≥ï‰øÆÈ•∞ÊñπÊ≥ïÂèä‰ª£Á†ÅÂùóÁ≠â„ÄÇ</p>
<p><code>volatile</code>ÁöÑÁî®Ê≥ïÊØîËæÉÁÆÄÂçïÔºåÂè™ÈúÄË¶ÅÂú®Â£∞Êòé‰∏Ä‰∏™ÂèØËÉΩË¢´Â§öÁ∫øÁ®ãÂêåÊó∂ËÆøÈóÆÁöÑÂèòÈáèÊó∂Ôºå‰ΩøÁî®<code>volatile</code>‰øÆÈ•∞Â∞±ÂèØ‰ª•‰∫Ü„ÄÇ</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Singleton</span> </span>&#123;  </span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">volatile</span> <span class="keyword">static</span> Singleton singleton;  </span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="title">Singleton</span> <span class="params">()</span></span>&#123;&#125;  </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> Singleton <span class="title">getSingleton</span><span class="params">()</span> </span>&#123;  </span><br><span class="line">    <span class="keyword">if</span> (singleton == <span class="keyword">null</span>) &#123;  </span><br><span class="line">        <span class="keyword">synchronized</span> (Singleton.class) &#123;  </span><br><span class="line">        <span class="keyword">if</span> (singleton == <span class="keyword">null</span>) &#123;  </span><br><span class="line">            singleton = <span class="keyword">new</span> Singleton();  </span><br><span class="line">        &#125;  </span><br><span class="line">        &#125;  </span><br><span class="line">    &#125;  </span><br><span class="line">    <span class="keyword">return</span> singleton;  </span><br><span class="line">    &#125;  </span><br><span class="line">&#125;  </span><br></pre></td></tr></table></figure>

<h4 id="ÂéüÁêÜ-1"><a href="#ÂéüÁêÜ-1" class="headerlink" title="ÂéüÁêÜ"></a>ÂéüÁêÜ</h4><p><strong>ÂèØËßÅÊÄßÂÆûÁé∞ÂéüÁêÜ</strong></p>
<p>‰∏∫‰∫ÜÊèêÈ´òÂ§ÑÁêÜÂô®ÁöÑÊâßË°åÈÄüÂ∫¶ÔºåÂú®Â§ÑÁêÜÂô®ÂíåÂÜÖÂ≠ò‰πãÈó¥Â¢ûÂä†‰∫ÜÂ§öÁ∫ßÁºìÂ≠òÊù•ÊèêÂçá„ÄÇ‰ΩÜÊòØÁî±‰∫éÂºïÂÖ•‰∫ÜÂ§öÁ∫ßÁºìÂ≠òÔºåÂ∞±Â≠òÂú®ÁºìÂ≠òÊï∞ÊçÆ‰∏ç‰∏ÄËá¥ÈóÆÈ¢ò„ÄÇ</p>
<p>ÂØπ‰∫é<code>volatile</code>ÂèòÈáèÔºåÂΩìÂØπ<code>volatile</code>ÂèòÈáèËøõË°åÂÜôÊìç‰ΩúÁöÑÊó∂ÂÄôÔºåJVM‰ºöÂêëÂ§ÑÁêÜÂô®ÂèëÈÄÅ‰∏ÄÊù°lockÂâçÁºÄÁöÑÊåá‰ª§ÔºåÂ§ÑÁêÜÂô®Âú®Êé•Êî∂Âà∞lockÊåá‰ª§ÁöÑÊó∂ÂÄô‰ºöÂÅö‰∏§‰ª∂‰∫ãÔºö</p>
<ol>
<li>Â∞Ü<strong>ÁºìÂ≠òË°å</strong>ÁºìÂ≠òÁöÑÊï∞ÊçÆÂÜôÂõûÂà∞Á≥ªÁªüÂÜÖÂ≠ò‰∏≠„ÄÇ</li>
<li>Ëøô‰∏™ÂÜôÂõûÂà∞Á≥ªÁªüÂÜÖÂ≠ò‰∏≠ÁöÑÊï∞ÊçÆÔºåÂ¶ÇÊûúÂú®ÂÖ∂‰ªñCPUÁöÑÁºìÂ≠òË°å‰∏≠Â≠òÂú®Áõ∏ÂêåÁöÑÊï∞ÊçÆÔºåÂàôÂ∞ÜÂÖ∂ÁΩÆ‰∏∫<strong>Â§±ÊïàÁä∂ÊÄÅ</strong>„ÄÇ</li>
</ol>
<p><strong>Â±èËîΩÊåá‰ª§ÈáçÊéíÂÆûÁé∞ÂéüÁêÜ</strong></p>
<p>Â±èËîΩÊåá‰ª§ÈáçÊéíÂ∫èÔºöÊåá‰ª§ÈáçÊéíÂ∫èÊòØÁºñËØëÂô®ÂíåÂ§ÑÁêÜÂô®‰∏∫‰∫ÜÈ´òÊïàÂØπÁ®ãÂ∫èËøõË°å‰ºòÂåñÁöÑÊâãÊÆµÔºåÂÆÉÂè™ËÉΩ‰øùËØÅÁ®ãÂ∫èÊâßË°åÁöÑÁªìÊûúÊó∂Ê≠£Á°ÆÁöÑÔºå‰ΩÜÊòØÊó†Ê≥ï‰øùËØÅÁ®ãÂ∫èÁöÑÊìç‰ΩúÈ°∫Â∫è‰∏é‰ª£Á†ÅÈ°∫Â∫è‰∏ÄËá¥„ÄÇËøôÂú®ÂçïÁ∫øÁ®ã‰∏≠‰∏ç‰ºöÊûÑÊàêÈóÆÈ¢òÔºå‰ΩÜÊòØÂú®Â§öÁ∫øÁ®ã‰∏≠Â∞±‰ºöÂá∫Áé∞ÈóÆÈ¢ò„ÄÇÈùûÂ∏∏ÁªèÂÖ∏ÁöÑ‰æãÂ≠êÊòØÂú®Âçï‰æãÊñπÊ≥ï‰∏≠ÂêåÊó∂ÂØπÂ≠óÊÆµÂä†ÂÖ•voliateÔºåÂ∞±ÊòØ‰∏∫‰∫ÜÈò≤Ê≠¢Êåá‰ª§ÈáçÊéíÂ∫è„ÄÇ</p>
<p>volatileÂÖ≥ÈîÆÂ≠óÈÄöËøá ‚Äú<strong>ÂÜÖÂ≠òÂ±èÈöú</strong>‚Äù ÁöÑÊñπÂºèÊù•Èò≤Ê≠¢Êåá‰ª§Ë¢´ÈáçÊéíÂ∫èÔºå‰∏∫‰∫ÜÂÆûÁé∞volatileÁöÑÂÜÖÂ≠òËØ≠‰πâÔºåÁºñËØëÂô®Âú®ÁîüÊàêÂ≠óËäÇÁ†ÅÊó∂Ôºå‰ºöÂú®Êåá‰ª§Â∫èÂàó‰∏≠ÊèíÂÖ•ÂÜÖÂ≠òÂ±èÈöúÊù•Á¶ÅÊ≠¢ÁâπÂÆöÁ±ªÂûãÁöÑÂ§ÑÁêÜÂô®ÈáçÊéíÂ∫è„ÄÇÂ§ßÂ§öÊï∞ÁöÑÂ§ÑÁêÜÂô®ÈÉΩÊîØÊåÅÂÜÖÂ≠òÂ±èÈöúÁöÑÊåá‰ª§„ÄÇ</p>
<p>ÂØπ‰∫éÁºñËØëÂô®Êù•ËØ¥ÔºåÂèëÁé∞‰∏Ä‰∏™ÊúÄ‰ºòÂ∏ÉÁΩÆÊù•ÊúÄÂ∞èÂåñÊèíÂÖ•Â±èÈöúÁöÑÊÄªÊï∞Âá†‰πé‰∏çÂèØËÉΩÔºå‰∏∫Ê≠§ÔºåJavaÂÜÖÂ≠òÊ®°ÂûãÈááÂèñ‰øùÂÆàÁ≠ñÁï•„ÄÇ‰∏ãÈù¢ÊòØÂü∫‰∫é‰øùÂÆàÁ≠ñÁï•ÁöÑJMMÂÜÖÂ≠òÂ±èÈöúÊèíÂÖ•Á≠ñÁï•Ôºö</p>
<ul>
<li>Âú®ÊØè‰∏™volatileÂÜôÊìç‰ΩúÁöÑÂâçÈù¢ÊèíÂÖ•‰∏Ä‰∏™StoreStoreÂ±èÈöú„ÄÇ</li>
<li>Âú®ÊØè‰∏™volatileÂÜôÊìç‰ΩúÁöÑÂêéÈù¢ÊèíÂÖ•‰∏Ä‰∏™StoreLoadÂ±èÈöú„ÄÇ</li>
<li>Âú®ÊØè‰∏™volatileËØªÊìç‰ΩúÁöÑÂêéÈù¢ÊèíÂÖ•‰∏Ä‰∏™LoadLoadÂ±èÈöú„ÄÇ</li>
<li>Âú®ÊØè‰∏™volatileËØªÊìç‰ΩúÁöÑÂêéÈù¢ÊèíÂÖ•‰∏Ä‰∏™LoadStoreÂ±èÈöú„ÄÇ</li>
</ul>
<blockquote>
<p><strong>ÂÜÖÂ≠òÂ±èÈöúÔºàMemory BarrierÔºåÊàñÊúâÊó∂Âè´ÂÅöÂÜÖÂ≠òÊ†ÖÊ†èÔºåMemory FenceÔºâÊòØ‰∏ÄÁßçCPUÊåá‰ª§ÔºåÁî®‰∫éÊéßÂà∂ÁâπÂÆöÊù°‰ª∂‰∏ãÁöÑÈáçÊéíÂ∫èÂíåÂÜÖÂ≠òÂèØËßÅÊÄßÈóÆÈ¢ò„ÄÇJavaÁºñËØëÂô®‰πü‰ºöÊ†πÊçÆÂÜÖÂ≠òÂ±èÈöúÁöÑËßÑÂàôÁ¶ÅÊ≠¢ÈáçÊéíÂ∫è„ÄÇ</strong></p>
<p>ÂÜÖÂ≠òÂ±èÈöúÂèØ‰ª•Ë¢´ÂàÜ‰∏∫‰ª•‰∏ãÂá†ÁßçÁ±ªÂûãÔºö</p>
<p>LoadLoadÂ±èÈöúÔºöÂØπ‰∫éËøôÊ†∑ÁöÑËØ≠Âè•Load1; LoadLoad; Load2ÔºåÂú®Load2ÂèäÂêéÁª≠ËØªÂèñÊìç‰ΩúË¶ÅËØªÂèñÁöÑÊï∞ÊçÆË¢´ËÆøÈóÆÂâçÔºå‰øùËØÅLoad1Ë¶ÅËØªÂèñÁöÑÊï∞ÊçÆË¢´ËØªÂèñÂÆåÊØï„ÄÇ</p>
<p>LoadStoreÂ±èÈöúÔºöÂØπ‰∫éËøôÊ†∑ÁöÑËØ≠Âè•Load1; LoadStore; Store2ÔºåÂú®Store2ÂèäÂêéÁª≠ÂÜôÂÖ•Êìç‰ΩúË¢´Âà∑Âá∫ÂâçÔºå‰øùËØÅLoad1Ë¶ÅËØªÂèñÁöÑÊï∞ÊçÆË¢´ËØªÂèñÂÆåÊØï„ÄÇ</p>
<p>StoreStoreÂ±èÈöúÔºöÂØπ‰∫éËøôÊ†∑ÁöÑËØ≠Âè•Store1; StoreStore; Store2ÔºåÂú®Store2ÂèäÂêéÁª≠ÂÜôÂÖ•Êìç‰ΩúÊâßË°åÂâçÔºå‰øùËØÅStore1ÁöÑÂÜôÂÖ•Êìç‰ΩúÂØπÂÖ∂ÂÆÉÂ§ÑÁêÜÂô®ÂèØËßÅ„ÄÇ</p>
<p>StoreLoadÂ±èÈöúÔºöÂØπ‰∫éËøôÊ†∑ÁöÑËØ≠Âè•Store1; StoreLoad; Load2ÔºåÂú®Load2ÂèäÂêéÁª≠ÊâÄÊúâËØªÂèñÊìç‰ΩúÊâßË°åÂâçÔºå‰øùËØÅStore1ÁöÑÂÜôÂÖ•ÂØπÊâÄÊúâÂ§ÑÁêÜÂô®ÂèØËßÅ„ÄÇÂÆÉÁöÑÂºÄÈîÄÊòØÂõõÁßçÂ±èÈöú‰∏≠ÊúÄÂ§ßÁöÑ„ÄÇÂú®Â§ßÂ§öÊï∞Â§ÑÁêÜÂô®ÁöÑÂÆûÁé∞‰∏≠ÔºåËøô‰∏™Â±èÈöúÊòØ‰∏™‰∏áËÉΩÂ±èÈöúÔºåÂÖºÂÖ∑ÂÖ∂ÂÆÉ‰∏âÁßçÂÜÖÂ≠òÂ±èÈöúÁöÑÂäüËÉΩ„ÄÇ</p>
</blockquote>
<h4 id="volatile-‰∏éÂéüÂ≠êÊÄß"><a href="#volatile-‰∏éÂéüÂ≠êÊÄß" class="headerlink" title="volatile ‰∏éÂéüÂ≠êÊÄß"></a>volatile ‰∏éÂéüÂ≠êÊÄß</h4><p>ÂéüÂ≠êÊÄßÊòØÊåá‰∏Ä‰∏™Êìç‰ΩúÊòØ‰∏çÂèØ‰∏≠Êñ≠ÁöÑÔºåË¶ÅÂÖ®ÈÉ®ÊâßË°åÂÆåÊàêÔºåË¶Å‰∏çÂ∞±ÈÉΩ‰∏çÊâßË°å„ÄÇ</p>
<p>Á∫øÁ®ãÊòØCPUË∞ÉÂ∫¶ÁöÑÂü∫Êú¨Âçï‰Ωç„ÄÇCPUÊúâÊó∂Èó¥ÁâáÁöÑÊ¶ÇÂøµÔºå‰ºöÊ†πÊçÆ‰∏çÂêåÁöÑË∞ÉÂ∫¶ÁÆóÊ≥ïËøõË°åÁ∫øÁ®ãË∞ÉÂ∫¶„ÄÇÂΩì‰∏Ä‰∏™Á∫øÁ®ãËé∑ÂæóÊó∂Èó¥Áâá‰πãÂêéÂºÄÂßãÊâßË°åÔºåÂú®Êó∂Èó¥ÁâáËÄóÂ∞Ω‰πãÂêéÔºåÂ∞±‰ºöÂ§±ÂéªCPU‰ΩøÁî®ÊùÉ„ÄÇÊâÄ‰ª•Âú®Â§öÁ∫øÁ®ãÂú∫ÊôØ‰∏ãÔºå<strong>Áî±‰∫éÊó∂Èó¥ÁâáÂú®Á∫øÁ®ãÈó¥ËΩÆÊç¢ÔºåÂ∞±‰ºöÂèëÁîüÂéüÂ≠êÊÄßÈóÆÈ¢ò„ÄÇ</strong></p>
<p><code>synchronized</code> ‰∏∫‰∫Ü‰øùËØÅÂéüÂ≠êÊÄßÔºåÈúÄË¶ÅÈÄöËøáÂ≠óËäÇÁ†ÅÊåá‰ª§<code>monitorenter</code>Âíå<code>monitorexit</code>Ôºå‰ΩÜÊòØ<code>volatile</code>ÂíåËøô‰∏§‰∏™Êåá‰ª§‰πãÈó¥ÊòØÊ≤°Êúâ‰ªª‰ΩïÂÖ≥Á≥ªÁöÑ„ÄÇ</p>
<p><strong>ÊâÄ‰ª•Ôºå<code>volatile</code>ÊòØ‰∏çËÉΩ‰øùËØÅÂéüÂ≠êÊÄßÁöÑ„ÄÇ</strong></p>
<h2 id="synchronized"><a href="#synchronized" class="headerlink" title="synchronized"></a>synchronized</h2><p><strong><code>synchronized</code> ÂÖ≥ÈîÆÂ≠óËß£ÂÜ≥ÁöÑÊòØÂ§ö‰∏™Á∫øÁ®ã‰πãÈó¥ËÆøÈóÆËµÑÊ∫êÁöÑÂêåÊ≠•ÊÄßÔºå<code>synchronized</code>ÂÖ≥ÈîÆÂ≠óÂèØ‰ª•‰øùËØÅË¢´ÂÆÉ‰øÆÈ•∞ÁöÑÊñπÊ≥ïÊàñËÄÖ‰ª£Á†ÅÂùóÂú®‰ªªÊÑèÊó∂ÂàªÂè™ËÉΩÊúâ‰∏Ä‰∏™Á∫øÁ®ãÊâßË°å„ÄÇ</strong></p>
<p>Âè¶Â§ñÔºåÂú® Java Êó©ÊúüÁâàÊú¨‰∏≠Ôºå<code>synchronized</code> Â±û‰∫é <strong>ÈáçÈáèÁ∫ßÈîÅ</strong>ÔºåÊïàÁéá‰Ωé‰∏ã„ÄÇ</p>
<p><strong>‰∏∫‰ªÄ‰πàÂë¢Ôºü</strong></p>
<p>Âõ†‰∏∫ÁõëËßÜÂô®ÈîÅÔºàmonitorÔºâÊòØ‰æùËµñ‰∫éÂ∫ïÂ±ÇÁöÑÊìç‰ΩúÁ≥ªÁªüÁöÑ <code>Mutex Lock</code> Êù•ÂÆûÁé∞ÁöÑÔºåJava ÁöÑÁ∫øÁ®ãÊòØÊò†Â∞ÑÂà∞Êìç‰ΩúÁ≥ªÁªüÁöÑÂéüÁîüÁ∫øÁ®ã‰πã‰∏äÁöÑ„ÄÇÂ¶ÇÊûúË¶ÅÊåÇËµ∑ÊàñËÄÖÂî§ÈÜí‰∏Ä‰∏™Á∫øÁ®ãÔºåÈÉΩÈúÄË¶ÅÊìç‰ΩúÁ≥ªÁªüÂ∏ÆÂøôÂÆåÊàêÔºåËÄåÊìç‰ΩúÁ≥ªÁªüÂÆûÁé∞Á∫øÁ®ã‰πãÈó¥ÁöÑÂàáÊç¢Êó∂ÈúÄË¶Å‰ªéÁî®Êà∑ÊÄÅËΩ¨Êç¢Âà∞ÂÜÖÊ†∏ÊÄÅÔºåËøô‰∏™Áä∂ÊÄÅ‰πãÈó¥ÁöÑËΩ¨Êç¢ÈúÄË¶ÅÁõ∏ÂØπÊØîËæÉÈïøÁöÑÊó∂Èó¥ÔºåÊó∂Èó¥ÊàêÊú¨Áõ∏ÂØπËæÉÈ´ò„ÄÇ</p>
<p>Â∫ÜÂπ∏ÁöÑÊòØÂú® Java 6 ‰πãÂêé Java ÂÆòÊñπÂØπ‰ªé JVM Â±ÇÈù¢ÂØπ <code>synchronized</code> ËæÉÂ§ß‰ºòÂåñÔºåÊâÄ‰ª•Áé∞Âú®ÁöÑ <code>synchronized</code> ÈîÅÊïàÁéá‰πü‰ºòÂåñÂæóÂæà‰∏çÈîô‰∫Ü„ÄÇJDK1.6 ÂØπÈîÅÁöÑÂÆûÁé∞ÂºïÂÖ•‰∫ÜÂ§ßÈáèÁöÑ‰ºòÂåñÔºåÂ¶ÇËá™ÊóãÈîÅ„ÄÅÈÄÇÂ∫îÊÄßËá™ÊóãÈîÅ„ÄÅÈîÅÊ∂àÈô§„ÄÅÈîÅÁ≤óÂåñ„ÄÅÂÅèÂêëÈîÅ„ÄÅËΩªÈáèÁ∫ßÈîÅÁ≠âÊäÄÊúØÊù•ÂáèÂ∞ëÈîÅÊìç‰ΩúÁöÑÂºÄÈîÄ„ÄÇ</p>
<h4 id="Áî®Ê≥ï-1"><a href="#Áî®Ê≥ï-1" class="headerlink" title="Áî®Ê≥ï"></a>Áî®Ê≥ï</h4><p><strong>1.‰øÆÈ•∞ÂÆû‰æãÊñπÊ≥ï:</strong> ‰ΩúÁî®‰∫éÂΩìÂâçÂØπË±°ÂÆû‰æãÂä†ÈîÅÔºåËøõÂÖ•ÂêåÊ≠•‰ª£Á†ÅÂâçË¶ÅËé∑Âæó <strong>ÂΩìÂâçÂØπË±°ÂÆû‰æãÁöÑÈîÅ</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">synchronized void method() &#123;</span><br><span class="line">  &#x2F;&#x2F;‰∏öÂä°‰ª£Á†Å</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>2.‰øÆÈ•∞ÈùôÊÄÅÊñπÊ≥ï:</strong> ‰πüÂ∞±ÊòØÁªôÂΩìÂâçÁ±ªÂä†ÈîÅÔºå‰ºö‰ΩúÁî®‰∫éÁ±ªÁöÑÊâÄÊúâÂØπË±°ÂÆû‰æã ÔºåËøõÂÖ•ÂêåÊ≠•‰ª£Á†ÅÂâçË¶ÅËé∑Âæó <strong>ÂΩìÂâç class ÁöÑÈîÅ</strong>„ÄÇÂõ†‰∏∫ÈùôÊÄÅÊàêÂëò‰∏çÂ±û‰∫é‰ªª‰Ωï‰∏Ä‰∏™ÂÆû‰æãÂØπË±°ÔºåÊòØÁ±ªÊàêÂëòÔºà <em>static Ë°®ÊòéËøôÊòØËØ•Á±ªÁöÑ‰∏Ä‰∏™ÈùôÊÄÅËµÑÊ∫êÔºå‰∏çÁÆ° new ‰∫ÜÂ§öÂ∞ë‰∏™ÂØπË±°ÔºåÂè™Êúâ‰∏Ä‰ªΩ</em>Ôºâ„ÄÇÊâÄ‰ª•ÔºåÂ¶ÇÊûú‰∏Ä‰∏™Á∫øÁ®ã A Ë∞ÉÁî®‰∏Ä‰∏™ÂÆû‰æãÂØπË±°ÁöÑÈùûÈùôÊÄÅ <code>synchronized</code> ÊñπÊ≥ïÔºåËÄåÁ∫øÁ®ã B ÈúÄË¶ÅË∞ÉÁî®Ëøô‰∏™ÂÆû‰æãÂØπË±°ÊâÄÂ±ûÁ±ªÁöÑÈùôÊÄÅ <code>synchronized</code> ÊñπÊ≥ïÔºåÊòØÂÖÅËÆ∏ÁöÑÔºå‰∏ç‰ºöÂèëÁîü‰∫íÊñ•Áé∞Ë±°Ôºå<strong>Âõ†‰∏∫ËÆøÈóÆÈùôÊÄÅ <code>synchronized</code> ÊñπÊ≥ïÂç†Áî®ÁöÑÈîÅÊòØÂΩìÂâçÁ±ªÁöÑÈîÅÔºåËÄåËÆøÈóÆÈùûÈùôÊÄÅ <code>synchronized</code> ÊñπÊ≥ïÂç†Áî®ÁöÑÈîÅÊòØÂΩìÂâçÂÆû‰æãÂØπË±°ÈîÅ</strong>„ÄÇ</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">synchronized void staic method() &#123;</span><br><span class="line">  &#x2F;&#x2F;‰∏öÂä°‰ª£Á†Å</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>3.‰øÆÈ•∞‰ª£Á†ÅÂùó</strong> ÔºöÊåáÂÆöÂä†ÈîÅÂØπË±°ÔºåÂØπÁªôÂÆöÂØπË±°/Á±ªÂä†ÈîÅ„ÄÇ<code>synchronized(this|object)</code> Ë°®Á§∫ËøõÂÖ•ÂêåÊ≠•‰ª£Á†ÅÂ∫ìÂâçË¶ÅËé∑Âæó<strong>ÁªôÂÆöÂØπË±°ÁöÑÈîÅ</strong>„ÄÇ<code>synchronized(Á±ª.class)</code> Ë°®Á§∫ËøõÂÖ•ÂêåÊ≠•‰ª£Á†ÅÂâçË¶ÅËé∑Âæó <strong>ÂΩìÂâç class ÁöÑÈîÅ</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">synchronized(this) &#123;</span><br><span class="line">  &#x2F;&#x2F;‰∏öÂä°‰ª£Á†Å</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>ÊÄªÁªìÔºö</strong></p>
<ul>
<li><code>synchronized</code> ÂÖ≥ÈîÆÂ≠óÂä†Âà∞ <code>static</code> ÈùôÊÄÅÊñπÊ≥ïÂíå <code>synchronized(class)</code> ‰ª£Á†ÅÂùó‰∏äÈÉΩÊòØÊòØÁªô Class Á±ª‰∏äÈîÅ„ÄÇ</li>
<li><code>synchronized</code> ÂÖ≥ÈîÆÂ≠óÂä†Âà∞ÂÆû‰æãÊñπÊ≥ï‰∏äÊòØÁªôÂØπË±°ÂÆû‰æã‰∏äÈîÅ„ÄÇ</li>
<li>Â∞ΩÈáè‰∏çË¶Å‰ΩøÁî® <code>synchronized(String a)</code> Âõ†‰∏∫ JVM ‰∏≠ÔºåÂ≠óÁ¨¶‰∏≤Â∏∏ÈáèÊ±†ÂÖ∑ÊúâÁºìÂ≠òÂäüËÉΩÔºÅ</li>
</ul>
<h4 id="ÂéüÁêÜ-2"><a href="#ÂéüÁêÜ-2" class="headerlink" title="ÂéüÁêÜ"></a>ÂéüÁêÜ</h4><p><strong>synchronized ÂêåÊ≠•ËØ≠Âè•ÂùóÁöÑÊÉÖÂÜµ</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">public class SynchronizedDemo &#123;</span><br><span class="line">	public void method() &#123;</span><br><span class="line">		synchronized (this) &#123;</span><br><span class="line">			System.out.println(&quot;synchronized ‰ª£Á†ÅÂùó&quot;);</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>ÈÄöËøá JDK Ëá™Â∏¶ÁöÑ <code>javap</code> ÂëΩ‰ª§Êü•Áúã <code>SynchronizedDemo</code> Á±ªÁöÑÁõ∏ÂÖ≥Â≠óËäÇÁ†Å‰ø°ÊÅØÔºöÈ¶ñÂÖàÂàáÊç¢Âà∞Á±ªÁöÑÂØπÂ∫îÁõÆÂΩïÊâßË°å <code>javac SynchronizedDemo.java</code> ÂëΩ‰ª§ÁîüÊàêÁºñËØëÂêéÁöÑ .class Êñá‰ª∂ÔºåÁÑ∂ÂêéÊâßË°å<code>javap -c -s -v -l SynchronizedDemo.class</code>„ÄÇ</p>
<p><img src="../img/java/10.png"></p>
<p>‰ªé‰∏äÈù¢Êàë‰ª¨ÂèØ‰ª•ÁúãÂá∫Ôºö</p>
<p><strong><code>synchronized</code> ÂêåÊ≠•ËØ≠Âè•ÂùóÁöÑÂÆûÁé∞‰ΩøÁî®ÁöÑÊòØ <code>monitorenter</code> Âíå <code>monitorexit</code> Êåá‰ª§ÔºåÂÖ∂‰∏≠ <code>monitorenter</code> Êåá‰ª§ÊåáÂêëÂêåÊ≠•‰ª£Á†ÅÂùóÁöÑÂºÄÂßã‰ΩçÁΩÆÔºå<code>monitorexit</code> Êåá‰ª§ÂàôÊåáÊòéÂêåÊ≠•‰ª£Á†ÅÂùóÁöÑÁªìÊùü‰ΩçÁΩÆ„ÄÇ</strong></p>
<p>ÂΩìÊâßË°å <code>monitorenter</code> Êåá‰ª§Êó∂ÔºåÁ∫øÁ®ãËØïÂõæËé∑ÂèñÈîÅ‰πüÂ∞±ÊòØËé∑Âèñ <strong>ÂØπË±°ÁõëËßÜÂô® <code>monitor</code></strong> ÁöÑÊåÅÊúâÊùÉ„ÄÇ</p>
<blockquote>
<p>Âú® Java ËôöÊãüÊú∫(HotSpot)‰∏≠ÔºåMonitor ÊòØÂü∫‰∫é C++ÂÆûÁé∞ÁöÑÔºåÁî±<a target="_blank" rel="noopener" href="https://github.com/openjdk-mirror/jdk7u-hotspot/blob/50bdefc3afe944ca74c3093e7448d6b889cd20d1/src/share/vm/runtime/objectMonitor.cpp">ObjectMonitor</a>ÂÆûÁé∞ÁöÑ„ÄÇÊØè‰∏™ÂØπË±°‰∏≠ÈÉΩÂÜÖÁΩÆ‰∫Ü‰∏Ä‰∏™ <code>ObjectMonitor</code>ÂØπË±°„ÄÇ</p>
<p>Âè¶Â§ñÔºå**<code>wait/notify</code>Á≠âÊñπÊ≥ï‰πü‰æùËµñ‰∫é<code>monitor</code>ÂØπË±°ÔºåËøôÂ∞±ÊòØ‰∏∫‰ªÄ‰πàÂè™ÊúâÂú®ÂêåÊ≠•ÁöÑÂùóÊàñËÄÖÊñπÊ≥ï‰∏≠ÊâçËÉΩË∞ÉÁî®<code>wait/notify</code>Á≠âÊñπÊ≥ïÔºåÂê¶Âàô‰ºöÊäõÂá∫<code>java.lang.IllegalMonitorStateException</code>ÁöÑÂºÇÂ∏∏ÁöÑÂéüÂõ†„ÄÇ**</p>
</blockquote>
<p>Âú®ÊâßË°å<code>monitorenter</code>Êó∂Ôºå‰ºöÂ∞ùËØïËé∑ÂèñÂØπË±°ÁöÑÈîÅÔºåÂ¶ÇÊûúÈîÅÁöÑËÆ°Êï∞Âô®‰∏∫ 0 ÂàôË°®Á§∫ÈîÅÂèØ‰ª•Ë¢´Ëé∑ÂèñÔºåËé∑ÂèñÂêéÂ∞ÜÈîÅËÆ°Êï∞Âô®ËÆæ‰∏∫ 1 ‰πüÂ∞±ÊòØÂä† 1„ÄÇ</p>
<p>Âú®ÊâßË°å <code>monitorexit</code> Êåá‰ª§ÂêéÔºåÂ∞ÜÈîÅËÆ°Êï∞Âô®ËÆæ‰∏∫ 0ÔºåË°®ÊòéÈîÅË¢´ÈáäÊîæ„ÄÇÂ¶ÇÊûúËé∑ÂèñÂØπË±°ÈîÅÂ§±Ë¥•ÔºåÈÇ£ÂΩìÂâçÁ∫øÁ®ãÂ∞±Ë¶ÅÈòªÂ°ûÁ≠âÂæÖÔºåÁõ¥Âà∞ÈîÅË¢´Âè¶Â§ñ‰∏Ä‰∏™Á∫øÁ®ãÈáäÊîæ‰∏∫Ê≠¢„ÄÇ</p>
<p><strong><code>synchronized</code> ‰øÆÈ•∞ÊñπÊ≥ïÁöÑÁöÑÊÉÖÂÜµ</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">public class SynchronizedDemo2 &#123;</span><br><span class="line">	public synchronized void method() &#123;</span><br><span class="line">		System.out.println(&quot;synchronized ÊñπÊ≥ï&quot;);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><img src="../img/java/11.png"></p>
<p><code>synchronized</code> ‰øÆÈ•∞ÁöÑÊñπÊ≥ïÂπ∂Ê≤°Êúâ <code>monitorenter</code> Êåá‰ª§Âíå <code>monitorexit</code> Êåá‰ª§ÔºåÂèñÂæó‰ª£‰πãÁöÑÁ°ÆÂÆûÊòØ <code>ACC_SYNCHRONIZED</code> Ê†áËØÜÔºåËØ•Ê†áËØÜÊåáÊòé‰∫ÜËØ•ÊñπÊ≥ïÊòØ‰∏Ä‰∏™ÂêåÊ≠•ÊñπÊ≥ï„ÄÇJVM ÈÄöËøáËØ• <code>ACC_SYNCHRONIZED</code> ËÆøÈóÆÊ†áÂøóÊù•Ëæ®Âà´‰∏Ä‰∏™ÊñπÊ≥ïÊòØÂê¶Â£∞Êòé‰∏∫ÂêåÊ≠•ÊñπÊ≥ïÔºå‰ªéËÄåÊâßË°åÁõ∏Â∫îÁöÑÂêåÊ≠•Ë∞ÉÁî®„ÄÇ</p>
<p><strong>ÊÄªÁªì</strong></p>
<p><code>synchronized</code> ÂêåÊ≠•ËØ≠Âè•ÂùóÁöÑÂÆûÁé∞‰ΩøÁî®ÁöÑÊòØ <code>monitorenter</code> Âíå <code>monitorexit</code> Êåá‰ª§ÔºåÂÖ∂‰∏≠ <code>monitorenter</code> Êåá‰ª§ÊåáÂêëÂêåÊ≠•‰ª£Á†ÅÂùóÁöÑÂºÄÂßã‰ΩçÁΩÆÔºå<code>monitorexit</code> Êåá‰ª§ÂàôÊåáÊòéÂêåÊ≠•‰ª£Á†ÅÂùóÁöÑÁªìÊùü‰ΩçÁΩÆ„ÄÇ</p>
<p><code>synchronized</code> ‰øÆÈ•∞ÁöÑÊñπÊ≥ïÂπ∂Ê≤°Êúâ <code>monitorenter</code> Êåá‰ª§Âíå <code>monitorexit</code> Êåá‰ª§ÔºåÂèñÂæó‰ª£‰πãÁöÑÁ°ÆÂÆûÊòØ <code>ACC_SYNCHRONIZED</code> Ê†áËØÜÔºåËØ•Ê†áËØÜÊåáÊòé‰∫ÜËØ•ÊñπÊ≥ïÊòØ‰∏Ä‰∏™ÂêåÊ≠•ÊñπÊ≥ï„ÄÇ</p>
<p><strong>‰∏çËøá‰∏§ËÄÖÁöÑÊú¨Ë¥®ÈÉΩÊòØÂØπÂØπË±°ÁõëËßÜÂô® monitor ÁöÑËé∑Âèñ„ÄÇ</strong></p>
<h4 id="synchronized-‰∏éÂéüÂ≠êÊÄß"><a href="#synchronized-‰∏éÂéüÂ≠êÊÄß" class="headerlink" title="synchronized ‰∏éÂéüÂ≠êÊÄß"></a>synchronized ‰∏éÂéüÂ≠êÊÄß</h4><p>ÂéüÂ≠êÊÄßÊòØÊåá‰∏Ä‰∏™Êìç‰ΩúÊòØ‰∏çÂèØ‰∏≠Êñ≠ÁöÑÔºåË¶ÅÂÖ®ÈÉ®ÊâßË°åÂÆåÊàêÔºåË¶Å‰∏çÂ∞±ÈÉΩ‰∏çÊâßË°å„ÄÇ</p>
<p>Á∫øÁ®ãÊòØCPUË∞ÉÂ∫¶ÁöÑÂü∫Êú¨Âçï‰Ωç„ÄÇCPUÊúâÊó∂Èó¥ÁâáÁöÑÊ¶ÇÂøµÔºå‰ºöÊ†πÊçÆ‰∏çÂêåÁöÑË∞ÉÂ∫¶ÁÆóÊ≥ïËøõË°åÁ∫øÁ®ãË∞ÉÂ∫¶„ÄÇÂΩì‰∏Ä‰∏™Á∫øÁ®ãËé∑ÂæóÊó∂Èó¥Áâá‰πãÂêéÂºÄÂßãÊâßË°åÔºåÂú®Êó∂Èó¥ÁâáËÄóÂ∞Ω‰πãÂêéÔºåÂ∞±‰ºöÂ§±ÂéªCPU‰ΩøÁî®ÊùÉ„ÄÇÊâÄ‰ª•Âú®Â§öÁ∫øÁ®ãÂú∫ÊôØ‰∏ãÔºåÁî±‰∫éÊó∂Èó¥ÁâáÂú®Á∫øÁ®ãÈó¥ËΩÆÊç¢ÔºåÂ∞±‰ºöÂèëÁîüÂéüÂ≠êÊÄßÈóÆÈ¢ò„ÄÇ</p>
<p>Âú®Java‰∏≠Ôºå‰∏∫‰∫Ü‰øùËØÅÂéüÂ≠êÊÄßÔºåÊèê‰æõ‰∫Ü‰∏§‰∏™È´òÁ∫ßÁöÑÂ≠óËäÇÁ†ÅÊåá‰ª§<code>monitorenter</code>Âíå<code>monitorexit</code>„ÄÇÂâçÈù¢‰∏≠Ôºå‰ªãÁªçËøáÔºåËøô‰∏§‰∏™Â≠óËäÇÁ†ÅÊåá‰ª§ÔºåÂú®Java‰∏≠ÂØπÂ∫îÁöÑÂÖ≥ÈîÆÂ≠óÂ∞±ÊòØ<code>synchronized</code>„ÄÇ</p>
<p>ÈÄöËøá<code>monitorenter</code>Âíå<code>monitorexit</code>Êåá‰ª§ÔºåÂèØ‰ª•‰øùËØÅË¢´<code>synchronized</code>‰øÆÈ•∞ÁöÑ‰ª£Á†ÅÂú®Âêå‰∏ÄÊó∂Èó¥Âè™ËÉΩË¢´‰∏Ä‰∏™Á∫øÁ®ãËÆøÈóÆÔºåÂú®ÈîÅÊú™ÈáäÊîæ‰πãÂâçÔºåÊó†Ê≥ïË¢´ÂÖ∂‰ªñÁ∫øÁ®ãËÆøÈóÆÂà∞„ÄÇÂõ†Ê≠§ÔºåÂú®Java‰∏≠ÂèØ‰ª•‰ΩøÁî®<code>synchronized</code>Êù•‰øùËØÅÊñπÊ≥ïÂíå‰ª£Á†ÅÂùóÂÜÖÁöÑÊìç‰ΩúÊòØÂéüÂ≠êÊÄßÁöÑ„ÄÇ</p>
<blockquote>
<p>Á∫øÁ®ã1Âú®ÊâßË°å<code>monitorenter</code>Êåá‰ª§ÁöÑÊó∂ÂÄôÔºå‰ºöÂØπMonitorËøõË°åÂä†ÈîÅÔºåÂä†ÈîÅÂêéÂÖ∂‰ªñÁ∫øÁ®ãÊó†Ê≥ïËé∑ÂæóÈîÅÔºåÈô§ÈùûÁ∫øÁ®ã1‰∏ªÂä®Ëß£ÈîÅ„ÄÇÂç≥‰ΩøÂú®ÊâßË°åËøáÁ®ã‰∏≠ÔºåÁî±‰∫éÊüêÁßçÂéüÂõ†ÔºåÊØîÂ¶ÇCPUÊó∂Èó¥ÁâáÁî®ÂÆåÔºåÁ∫øÁ®ã1ÊîæÂºÉ‰∫ÜCPUÔºå‰ΩÜÊòØÔºå‰ªñÂπ∂Ê≤°ÊúâËøõË°åËß£ÈîÅ„ÄÇËÄåÁî±‰∫é<code>synchronized</code>ÁöÑÈîÅÊòØÂèØÈáçÂÖ•ÁöÑÔºå‰∏ã‰∏Ä‰∏™Êó∂Èó¥ÁâáËøòÊòØÂè™ËÉΩË¢´‰ªñËá™Â∑±Ëé∑ÂèñÂà∞ÔºåËøòÊòØ‰ºöÁªßÁª≠ÊâßË°å‰ª£Á†Å„ÄÇÁõ¥Âà∞ÊâÄÊúâ‰ª£Á†ÅÊâßË°åÂÆå„ÄÇËøôÂ∞±‰øùËØÅ‰∫ÜÂéüÂ≠êÊÄß„ÄÇ</p>
</blockquote>
<h4 id="synchronized-‰∏éÂèØËßÅÊÄß"><a href="#synchronized-‰∏éÂèØËßÅÊÄß" class="headerlink" title="synchronized ‰∏éÂèØËßÅÊÄß"></a>synchronized ‰∏éÂèØËßÅÊÄß</h4><p>ÂèØËßÅÊÄßÊòØÊåáÂΩìÂ§ö‰∏™Á∫øÁ®ãËÆøÈóÆÂêå‰∏Ä‰∏™ÂèòÈáèÊó∂Ôºå‰∏Ä‰∏™Á∫øÁ®ã‰øÆÊîπ‰∫ÜËøô‰∏™ÂèòÈáèÁöÑÂÄºÔºåÂÖ∂‰ªñÁ∫øÁ®ãËÉΩÂ§üÁ´ãÂç≥ÁúãÂæóÂà∞‰øÆÊîπÁöÑÂÄº„ÄÇ</p>
<p>JavaÂÜÖÂ≠òÊ®°ÂûãËßÑÂÆö‰∫ÜÊâÄÊúâÁöÑÂèòÈáèÈÉΩÂ≠òÂÇ®Âú®‰∏ªÂÜÖÂ≠ò‰∏≠ÔºåÊØèÊù°Á∫øÁ®ãËøòÊúâËá™Â∑±ÁöÑÂ∑•‰ΩúÂÜÖÂ≠òÔºåÁ∫øÁ®ãÁöÑÂ∑•‰ΩúÂÜÖÂ≠ò‰∏≠‰øùÂ≠ò‰∫ÜËØ•Á∫øÁ®ã‰∏≠ÊòØÁî®Âà∞ÁöÑÂèòÈáèÁöÑ‰∏ªÂÜÖÂ≠òÂâØÊú¨Êã∑Ë¥ùÔºåÁ∫øÁ®ãÂØπÂèòÈáèÁöÑÊâÄÊúâÊìç‰ΩúÈÉΩÂøÖÈ°ªÂú®Â∑•‰ΩúÂÜÖÂ≠ò‰∏≠ËøõË°åÔºåËÄå‰∏çËÉΩÁõ¥Êé•ËØªÂÜô‰∏ªÂÜÖÂ≠ò„ÄÇ‰∏çÂêåÁöÑÁ∫øÁ®ã‰πãÈó¥‰πüÊó†Ê≥ïÁõ¥Êé•ËÆøÈóÆÂØπÊñπÂ∑•‰ΩúÂÜÖÂ≠ò‰∏≠ÁöÑÂèòÈáèÔºåÁ∫øÁ®ãÈó¥ÂèòÈáèÁöÑ‰º†ÈÄíÂùáÈúÄË¶ÅËá™Â∑±ÁöÑÂ∑•‰ΩúÂÜÖÂ≠òÂíå‰∏ªÂ≠ò‰πãÈó¥ËøõË°åÊï∞ÊçÆÂêåÊ≠•ËøõË°å„ÄÇÊâÄ‰ª•ÔºåÂ∞±ÂèØËÉΩÂá∫Áé∞Á∫øÁ®ã1Êîπ‰∫ÜÊüê‰∏™ÂèòÈáèÁöÑÂÄºÔºå‰ΩÜÊòØÁ∫øÁ®ã2‰∏çÂèØËßÅÁöÑÊÉÖÂÜµ„ÄÇ</p>
<p>ÂâçÈù¢Êàë‰ª¨‰ªãÁªçËøáÔºåË¢´<code>synchronized</code>‰øÆÈ•∞ÁöÑ‰ª£Á†ÅÔºåÂú®ÂºÄÂßãÊâßË°åÊó∂‰ºöÂä†ÈîÅÔºåÊâßË°åÂÆåÊàêÂêé‰ºöËøõË°åËß£ÈîÅ„ÄÇËÄå‰∏∫‰∫Ü‰øùËØÅÂèØËßÅÊÄßÔºåÊúâ‰∏ÄÊù°ËßÑÂàôÊòØËøôÊ†∑ÁöÑÔºöÂØπ‰∏Ä‰∏™ÂèòÈáèËß£ÈîÅ‰πãÂâçÔºåÂøÖÈ°ªÂÖàÊääÊ≠§ÂèòÈáèÂêåÊ≠•Âõû‰∏ªÂ≠ò‰∏≠„ÄÇËøôÊ†∑Ëß£ÈîÅÂêéÔºåÂêéÁª≠Á∫øÁ®ãÂ∞±ÂèØ‰ª•ËÆøÈóÆÂà∞Ë¢´‰øÆÊîπÂêéÁöÑÂÄº„ÄÇ</p>
<p>ÊâÄ‰ª•ÔºåsynchronizedÂÖ≥ÈîÆÂ≠óÈîÅ‰ΩèÁöÑÂØπË±°ÔºåÂÖ∂ÂÄºÊòØÂÖ∑ÊúâÂèØËßÅÊÄßÁöÑ„ÄÇ</p>
<h4 id="synchronized-‰∏éÊúâÂ∫èÊÄß"><a href="#synchronized-‰∏éÊúâÂ∫èÊÄß" class="headerlink" title="synchronized ‰∏éÊúâÂ∫èÊÄß"></a>synchronized ‰∏éÊúâÂ∫èÊÄß</h4><p>ÊúâÂ∫èÊÄßÂç≥Á®ãÂ∫èÊâßË°åÁöÑÈ°∫Â∫èÊåâÁÖß‰ª£Á†ÅÁöÑÂÖàÂêéÈ°∫Â∫èÊâßË°å„ÄÇ</p>
<p>Èô§‰∫ÜÂºïÂÖ•‰∫ÜÊó∂Èó¥Áâá‰ª•Â§ñÔºåÁî±‰∫éÂ§ÑÁêÜÂô®‰ºòÂåñÂíåÊåá‰ª§ÈáçÊéíÁ≠âÔºåCPUËøòÂèØËÉΩÂØπËæìÂÖ•‰ª£Á†ÅËøõË°å‰π±Â∫èÊâßË°åÔºåÊØîÂ¶Çload-&gt;add-&gt;save ÊúâÂèØËÉΩË¢´‰ºòÂåñÊàêload-&gt;save-&gt;add „ÄÇËøôÂ∞±ÊòØÂèØËÉΩÂ≠òÂú®ÊúâÂ∫èÊÄßÈóÆÈ¢ò„ÄÇ</p>
<p>ËøôÈáåÈúÄË¶ÅÊ≥®ÊÑèÁöÑÊòØÔºå<code>synchronized</code>ÊòØÊó†Ê≥ïÁ¶ÅÊ≠¢Êåá‰ª§ÈáçÊéíÂíåÂ§ÑÁêÜÂô®‰ºòÂåñÁöÑ„ÄÇ‰πüÂ∞±ÊòØËØ¥Ôºå<code>synchronized</code>Êó†Ê≥ïÈÅøÂÖç‰∏äËø∞ÊèêÂà∞ÁöÑÈóÆÈ¢ò„ÄÇ</p>
<p>ÈÇ£‰πàÔºå‰∏∫‰ªÄ‰πàËøòËØ¥<code>synchronized</code>‰πüÊèê‰æõ‰∫ÜÊúâÂ∫èÊÄß‰øùËØÅÂë¢Ôºü</p>
<p>ËøôÂ∞±Ë¶ÅÂÜçÊääÊúâÂ∫èÊÄßÁöÑÊ¶ÇÂøµÊâ©Â±ï‰∏Ä‰∏ã‰∫Ü„ÄÇJavaÁ®ãÂ∫è‰∏≠Â§©ÁÑ∂ÁöÑÊúâÂ∫èÊÄßÂèØ‰ª•ÊÄªÁªì‰∏∫‰∏ÄÂè•ËØùÔºöÂ¶ÇÊûúÂú®Êú¨Á∫øÁ®ãÂÜÖËßÇÂØüÔºåÊâÄÊúâÊìç‰ΩúÈÉΩÊòØÂ§©ÁÑ∂ÊúâÂ∫èÁöÑ„ÄÇÂ¶ÇÊûúÂú®‰∏Ä‰∏™Á∫øÁ®ã‰∏≠ËßÇÂØüÂè¶‰∏Ä‰∏™Á∫øÁ®ãÔºåÊâÄÊúâÊìç‰ΩúÈÉΩÊòØÊó†Â∫èÁöÑ„ÄÇ</p>
<p>‰ª•‰∏äËøôÂè•ËØù‰πüÊòØ„ÄäÊ∑±ÂÖ•ÁêÜËß£JavaËôöÊãüÊú∫„Äã‰∏≠ÁöÑÂéüÂè•Ôºå‰ΩÜÊòØÊÄé‰πàÁêÜËß£Âë¢ÔºüÂë®ÂøóÊòéÂπ∂Ê≤°ÊúâËØ¶ÁªÜÁöÑËß£Èáä„ÄÇËøôÈáåÊàëÁÆÄÂçïÊâ©Â±ï‰∏Ä‰∏ãÔºåËøôÂÖ∂ÂÆûÂíå<code>as-if-serialËØ≠‰πâ</code>ÊúâÂÖ≥„ÄÇ</p>
<p><code>as-if-serial</code>ËØ≠‰πâÁöÑÊÑèÊÄùÊåáÔºö‰∏çÁÆ°ÊÄé‰πàÈáçÊéíÂ∫èÔºàÁºñËØëÂô®ÂíåÂ§ÑÁêÜÂô®‰∏∫‰∫ÜÊèêÈ´òÂπ∂Ë°åÂ∫¶ÔºâÔºåÂçïÁ∫øÁ®ãÁ®ãÂ∫èÁöÑÊâßË°åÁªìÊûúÈÉΩ‰∏çËÉΩË¢´ÊîπÂèò„ÄÇÁºñËØëÂô®ÂíåÂ§ÑÁêÜÂô®Êó†ËÆ∫Â¶Ç‰Ωï‰ºòÂåñÔºåÈÉΩÂøÖÈ°ªÈÅµÂÆà<code>as-if-serial</code>ËØ≠‰πâ„ÄÇ</p>
<p>ËøôÈáå‰∏çÂØπ<code>as-if-serialËØ≠‰πâ</code>ËØ¶ÁªÜÂ±ïÂºÄ‰∫ÜÔºåÁÆÄÂçïËØ¥Â∞±ÊòØÔºå<code>as-if-serialËØ≠‰πâ</code>‰øùËØÅ‰∫ÜÂçïÁ∫øÁ®ã‰∏≠ÔºåÊåá‰ª§ÈáçÊéíÊòØÊúâ‰∏ÄÂÆöÁöÑÈôêÂà∂ÁöÑÔºåËÄåÂè™Ë¶ÅÁºñËØëÂô®ÂíåÂ§ÑÁêÜÂô®ÈÉΩÈÅµÂÆà‰∫ÜËøô‰∏™ËØ≠‰πâÔºåÈÇ£‰πàÂ∞±ÂèØ‰ª•ËÆ§‰∏∫ÂçïÁ∫øÁ®ãÁ®ãÂ∫èÊòØÊåâÁÖßÈ°∫Â∫èÊâßË°åÁöÑ„ÄÇÂΩìÁÑ∂ÔºåÂÆûÈôÖ‰∏äËøòÊòØÊúâÈáçÊéíÁöÑÔºåÂè™‰∏çËøáÊàë‰ª¨Êó†È°ªÂÖ≥ÂøÉËøôÁßçÈáçÊéíÁöÑÂπ≤Êâ∞„ÄÇ</p>
<p>ÊâÄ‰ª•Âë¢ÔºåÁî±‰∫é<code>synchronized</code>‰øÆÈ•∞ÁöÑ‰ª£Á†ÅÔºåÂêå‰∏ÄÊó∂Èó¥Âè™ËÉΩË¢´Âêå‰∏ÄÁ∫øÁ®ãËÆøÈóÆ„ÄÇÈÇ£‰πà‰πüÂ∞±ÊòØÂçïÁ∫øÁ®ãÊâßË°åÁöÑ„ÄÇÊâÄ‰ª•ÔºåÂèØ‰ª•‰øùËØÅÂÖ∂ÊúâÂ∫èÊÄß„ÄÇ</p>
<h4 id="synchronized-ÈîÅ‰ºòÂåñ"><a href="#synchronized-ÈîÅ‰ºòÂåñ" class="headerlink" title="synchronized ÈîÅ‰ºòÂåñ"></a>synchronized ÈîÅ‰ºòÂåñ</h4><p><a target="_blank" rel="noopener" href="https://juejin.cn/post/6844903590050398216">https://juejin.cn/post/6844903590050398216</a></p>
<p><code>synchronized</code>ÂÖ∂ÂÆûÊòØÂÄüÂä©MonitorÂÆûÁé∞ÁöÑ (MonitorÊòØ‰æùËµñ‰∫éÂ∫ïÂ±ÇÁöÑÊìç‰ΩúÁ≥ªÁªüÁöÑMutex LockÔºà‰∫íÊñ•ÈîÅÔºâÊù•ÂÆûÁé∞ÁöÑÁ∫øÁ®ãÂêåÊ≠•)ÔºåÂú®Âä†ÈîÅÊó∂‰ºöË∞ÉÁî®objectMonitorÁöÑ<code>enter</code>ÊñπÊ≥ïÔºåËß£ÈîÅÁöÑÊó∂ÂÄô‰ºöË∞ÉÁî®<code>exit</code>ÊñπÊ≥ï„ÄÇ‰∫ãÂÆû‰∏äÔºåÂè™ÊúâÂú®JDK1.6‰πãÂâçÔºåsynchronizedÁöÑÂÆûÁé∞Êâç‰ºöÁõ¥Êé•Ë∞ÉÁî®ObjectMonitorÁöÑ<code>enter</code>Âíå<code>exit</code>ÔºåËøôÁßçÈîÅË¢´Áß∞‰πã‰∏∫ÈáçÈáèÁ∫ßÈîÅ„ÄÇ</p>
<p>ÊâÄ‰ª•ÔºåÂú®JDK1.6‰∏≠Âá∫Áé∞ÂØπÈîÅËøõË°å‰∫ÜÂæàÂ§öÁöÑ‰ºòÂåñÔºåËøõËÄåÂá∫Áé∞ËΩªÈáèÁ∫ßÈîÅÔºåÂÅèÂêëÈîÅÔºåÈîÅÊ∂àÈô§ÔºåÈÄÇÂ∫îÊÄßËá™ÊóãÈîÅÔºåÈîÅÁ≤óÂåñ(Ëá™ÊóãÈîÅÂú®1.4Â∞±ÊúâÔºåÂè™‰∏çËøáÈªòËÆ§ÁöÑÊòØÂÖ≥Èó≠ÁöÑÔºåjdk1.6ÊòØÈªòËÆ§ÂºÄÂêØÁöÑ)ÔºåËøô‰∫õÊìç‰ΩúÈÉΩÊòØ‰∏∫‰∫ÜÂú®Á∫øÁ®ã‰πãÈó¥Êõ¥È´òÊïàÁöÑÂÖ±‰∫´Êï∞ÊçÆ ÔºåËß£ÂÜ≥Á´û‰∫âÈóÆÈ¢òÔºå‰ªéËÄåÊèêÂçáÁ®ãÂ∫èÁöÑÊâßË°åÊïàÁéá„ÄÇ</p>
<p>ÈÄöËøáÂºïÂÖ•ËΩªÈáèÁ∫ßÈîÅÂíåÂÅèÂêëÈîÅÊù•ÂáèÂ∞ëÈáçÈáèÁ∫ßÈîÅÁöÑ‰ΩøÁî®„ÄÇÈîÅÁöÑÁä∂ÊÄÅÊÄªÂÖ±ÂàÜÂõõÁßçÔºöÊó†ÈîÅÁä∂ÊÄÅ„ÄÅÂÅèÂêëÈîÅ„ÄÅËΩªÈáèÁ∫ßÈîÅÂíåÈáçÈáèÁ∫ßÈîÅ„ÄÇÈîÅÈöèÁùÄÁ´û‰∫âÊÉÖÂÜµÂèØ‰ª•ÂçáÁ∫ßÔºå‰ΩÜÈîÅÂçáÁ∫ßÂêé‰∏çËÉΩÈôçÁ∫ßÔºåÊÑèÂë≥ÁùÄ‰∏çËÉΩ‰ªéËΩªÈáèÁ∫ßÈîÅÁä∂ÊÄÅÈôçÁ∫ß‰∏∫ÂÅèÂêëÈîÅÁä∂ÊÄÅÔºå‰πü‰∏çËÉΩ‰ªéÈáçÈáèÁ∫ßÈîÅÁä∂ÊÄÅÈôçÁ∫ß‰∏∫ËΩªÈáèÁ∫ßÈîÅÁä∂ÊÄÅ„ÄÇ</p>
<blockquote>
<p> Êó†ÈîÅÁä∂ÊÄÅ ‚Üí ÂÅèÂêëÈîÅÁä∂ÊÄÅ ‚Üí ËΩªÈáèÁ∫ßÈîÅ ‚Üí ÈáçÈáèÁ∫ßÈîÅ</p>
</blockquote>
<h5 id="ÂØπË±°Â§¥"><a href="#ÂØπË±°Â§¥" class="headerlink" title="ÂØπË±°Â§¥"></a>ÂØπË±°Â§¥</h5><p>synchronizedÊòØÊÇ≤ËßÇÈîÅÔºåÂú®Êìç‰ΩúÂêåÊ≠•ËµÑÊ∫ê‰πãÂâçÈúÄË¶ÅÁªôÂêåÊ≠•ËµÑÊ∫êÂÖàÂä†ÈîÅÔºåËøôÊääÈîÅÂ∞±ÊòØÂ≠òÂú®JavaÂØπË±°Â§¥ÈáåÁöÑÔºåËÄåJavaÂØπË±°Â§¥ÂèàÊòØ‰ªÄ‰πàÂë¢Ôºü<br>Êàë‰ª¨‰ª•HotspotËôöÊãüÊú∫‰∏∫‰æãÔºåHotspotÁöÑÂØπË±°Â§¥‰∏ªË¶ÅÂåÖÊã¨‰∏§ÈÉ®ÂàÜÊï∞ÊçÆÔºöMark WordÔºàÊ†áËÆ∞Â≠óÊÆµÔºâ„ÄÅKlass PointerÔºàÁ±ªÂûãÊåáÈíàÔºâ„ÄÇ</p>
<ul>
<li><p>Mark WordÔºöÈªòËÆ§Â≠òÂÇ®ÂØπË±°ÁöÑHashCodeÔºåÂàÜ‰ª£Âπ¥ÈæÑÂíåÈîÅÊ†áÂøó‰Ωç‰ø°ÊÅØ„ÄÇËøô‰∫õ‰ø°ÊÅØÈÉΩÊòØ‰∏éÂØπË±°Ëá™Ë∫´ÂÆö‰πâÊó†ÂÖ≥ÁöÑÊï∞ÊçÆÔºåÊâÄ‰ª•Mark WordË¢´ËÆæËÆ°Êàê‰∏Ä‰∏™ÈùûÂõ∫ÂÆöÁöÑÊï∞ÊçÆÁªìÊûÑ‰ª•‰æøÂú®ÊûÅÂ∞èÁöÑÁ©∫Èó¥ÂÜÖÂ≠òÂ≠òÂÇ®Â∞ΩÈáèÂ§öÁöÑÊï∞ÊçÆ„ÄÇÂÆÉ‰ºöÊ†πÊçÆÂØπË±°ÁöÑÁä∂ÊÄÅÂ§çÁî®Ëá™Â∑±ÁöÑÂ≠òÂÇ®Á©∫Èó¥Ôºå‰πüÂ∞±ÊòØËØ¥Âú®ËøêË°åÊúüÈó¥Mark WordÈáåÂ≠òÂÇ®ÁöÑÊï∞ÊçÆ‰ºöÈöèÁùÄÈîÅÊ†áÂøó‰ΩçÁöÑÂèòÂåñËÄåÂèòÂåñ„ÄÇ</p>
</li>
<li><p>Klass PointÔºöÂØπË±°ÊåáÂêëÂÆÉÁöÑÁ±ªÂÖÉÊï∞ÊçÆÁöÑÊåáÈíàÔºåËôöÊãüÊú∫ÈÄöËøáËøô‰∏™ÊåáÈíàÊù•Á°ÆÂÆöËøô‰∏™ÂØπË±°ÊòØÂì™‰∏™Á±ªÁöÑÂÆû‰æã„ÄÇ</p>
</li>
</ul>
<p><img src="C:\Users\86130\github\notes\Java\img\5.png" alt="img"></p>
<blockquote>
<p>MonitorÂèØ‰ª•ÁêÜËß£‰∏∫‰∏Ä‰∏™ÂêåÊ≠•Â∑•ÂÖ∑Êàñ‰∏ÄÁßçÂêåÊ≠•Êú∫Âà∂ÔºåÈÄöÂ∏∏Ë¢´ÊèèËø∞‰∏∫‰∏Ä‰∏™ÂØπË±°„ÄÇÊØè‰∏Ä‰∏™JavaÂØπË±°Â∞±Êúâ‰∏ÄÊääÁúã‰∏çËßÅÁöÑÈîÅÔºåÁß∞‰∏∫ÂÜÖÈÉ®ÈîÅÊàñËÄÖMonitorÈîÅ„ÄÇ</p>
<p>MonitorÊòØÁ∫øÁ®ãÁßÅÊúâÁöÑÊï∞ÊçÆÁªìÊûÑÔºåÊØè‰∏Ä‰∏™Á∫øÁ®ãÈÉΩÊúâ‰∏Ä‰∏™ÂèØÁî®monitor recordÂàóË°®ÔºåÂêåÊó∂ËøòÊúâ‰∏Ä‰∏™ÂÖ®Â±ÄÁöÑÂèØÁî®ÂàóË°®„ÄÇÊØè‰∏Ä‰∏™Ë¢´ÈîÅ‰ΩèÁöÑÂØπË±°ÈÉΩ‰ºöÂíå‰∏Ä‰∏™monitorÂÖ≥ËÅîÔºåÂêåÊó∂monitor‰∏≠Êúâ‰∏Ä‰∏™OwnerÂ≠óÊÆµÂ≠òÊîæÊã•ÊúâËØ•ÈîÅÁöÑÁ∫øÁ®ãÁöÑÂîØ‰∏ÄÊ†áËØÜÔºåË°®Á§∫ËØ•ÈîÅË¢´Ëøô‰∏™Á∫øÁ®ãÂç†Áî®„ÄÇ</p>
</blockquote>
<h5 id="Êó†ÈîÅ"><a href="#Êó†ÈîÅ" class="headerlink" title="Êó†ÈîÅ"></a>Êó†ÈîÅ</h5><p>Êó†ÈîÅÔºöÊ≤°ÊúâÂØπËµÑÊ∫êËøõË°åÈîÅÂÆöÔºåÊâÄÊúâÁöÑÁ∫øÁ®ãÈÉΩËÉΩËÆøÈóÆÂπ∂‰øÆÊîπÂêå‰∏Ä‰∏™ËµÑÊ∫êÔºå‰ΩÜÂêåÊó∂Âè™Êúâ‰∏Ä‰∏™Á∫øÁ®ãËÉΩ‰øÆÊîπÊàêÂäü„ÄÇ</p>
<p>Êó†ÈîÅÁöÑÁâπÁÇπÂ∞±ÊòØ‰øÆÊîπÊìç‰ΩúÂú®Âæ™ÁéØÂÜÖËøõË°åÔºåÁ∫øÁ®ã‰ºö‰∏çÊñ≠ÁöÑÂ∞ùËØï‰øÆÊîπÂÖ±‰∫´ËµÑÊ∫ê„ÄÇÂ¶ÇÊûúÊ≤°ÊúâÂÜ≤Á™ÅÂ∞±‰øÆÊîπÊàêÂäüÂπ∂ÈÄÄÂá∫ÔºåÂê¶ÂàôÂ∞±‰ºöÁªßÁª≠Âæ™ÁéØÂ∞ùËØï„ÄÇÂ¶ÇÊûúÊúâÂ§ö‰∏™Á∫øÁ®ã‰øÆÊîπÂêå‰∏Ä‰∏™ÂÄºÔºåÂøÖÂÆö‰ºöÊúâ‰∏Ä‰∏™Á∫øÁ®ãËÉΩ‰øÆÊîπÊàêÂäüÔºåËÄåÂÖ∂‰ªñ‰øÆÊîπÂ§±Ë¥•ÁöÑÁ∫øÁ®ã‰ºö‰∏çÊñ≠ÈáçËØïÁõ¥Âà∞‰øÆÊîπÊàêÂäü„ÄÇ</p>
<p>CAS Âç≥ÊòØÊó†ÈîÅÁöÑÂÆûÁé∞„ÄÇÊó†ÈîÅÊó†Ê≥ïÂÖ®Èù¢‰ª£ÊõøÊúâÈîÅÔºå‰ΩÜÊó†ÈîÅÂú®Êüê‰∫õÂú∫Âêà‰∏ãÁöÑÊÄßËÉΩÊòØÈùûÂ∏∏È´òÁöÑ„ÄÇ</p>
<h5 id="ÂÅèÂêëÈîÅ"><a href="#ÂÅèÂêëÈîÅ" class="headerlink" title="ÂÅèÂêëÈîÅ"></a>ÂÅèÂêëÈîÅ</h5><p>ÂÅèÂêëÈîÅÊèêÂçáÊÄßËÉΩÁöÑÁªèÈ™å‰æùÊçÆÊòØÔºö<code>ÂØπ‰∫éÁªùÂ§ßÈÉ®ÂàÜÈîÅÔºåÂú®Êï¥‰∏™ÂêåÊ≠•Âë®ÊúüÂÜÖ‰∏ç‰ªÖ‰∏çÂ≠òÂú®Á´û‰∫âÔºåËÄå‰∏îÊÄªÁî±Âêå‰∏ÄÁ∫øÁ®ãÂ§öÊ¨°Ëé∑Âæó</code>„ÄÇÂÅèÂêëÈîÅ‰ºöÂÅèÂêëÁ¨¨‰∏Ä‰∏™Ëé∑ÂæóÂÆÉÁöÑÁ∫øÁ®ãÔºåÂ¶ÇÊûúÊé•‰∏ãÊù•ÁöÑÊâßË°åËøáÁ®ã‰∏≠ÔºåËØ•ÈîÅÊ≤°ÊúâË¢´ÂÖ∂‰ªñÁ∫øÁ®ãËé∑ÂèñÔºåÂàôÊåÅÊúâÂÅèÂêëÈîÅÁöÑÁ∫øÁ®ã‰∏çÈúÄË¶ÅÂÜçËøõË°åÂêåÊ≠•„ÄÇËøô‰ΩøÂæóÁ∫øÁ®ãËé∑ÂèñÈîÅÁöÑ‰ª£‰ª∑Êõ¥‰Ωé„ÄÇ</p>
<p>ÂÅèÂêëÈîÅÊòØÈíàÂØπ‰∫é‰∏Ä‰∏™Á∫øÁ®ãËÄåË®ÄÁöÑ, Á∫øÁ®ãËé∑ÂæóÈîÅ‰πãÂêéÂ∞±‰∏ç‰ºöÂÜçÊúâËß£ÈîÅÁ≠âÊìç‰Ωú‰∫Ü, ËøôÊ†∑ÂèØ‰ª•ÁúÅÁï•ÂæàÂ§öÂºÄÈîÄ. ÂÅáÂ¶ÇÊúâ‰∏§‰∏™Á∫øÁ®ãÊù•Á´û‰∫âËØ•ÈîÅËØù, ÈÇ£‰πàÂÅèÂêëÈîÅÂ∞±Â§±Êïà‰∫Ü, ËøõËÄåÂçáÁ∫ßÊàêËΩªÈáèÁ∫ßÈîÅ‰∫Ü.</p>
<p>‰∏∫‰ªÄ‰πàË¶ÅËøôÊ†∑ÂÅöÂë¢? Âõ†‰∏∫ÁªèÈ™åË°®Êòé, ÂÖ∂ÂÆûÂ§ßÈÉ®ÂàÜÊÉÖÂÜµ‰∏ã, ÈÉΩ‰ºöÊòØÂêå‰∏Ä‰∏™Á∫øÁ®ãËøõÂÖ•Âêå‰∏ÄÂùóÂêåÊ≠•‰ª£Á†ÅÂùóÁöÑ. Ëøô‰πüÊòØ‰∏∫‰ªÄ‰πà‰ºöÊúâÂÅèÂêëÈîÅÂá∫Áé∞ÁöÑÂéüÂõ†.</p>
<p>Âú®Jdk1.6‰∏≠, ÂÅèÂêëÈîÅÁöÑÂºÄÂÖ≥ÊòØÈªòËÆ§ÂºÄÂêØÁöÑ, ÈÄÇÁî®‰∫éÂè™Êúâ‰∏Ä‰∏™Á∫øÁ®ãËÆøÈóÆÂêåÊ≠•ÂùóÁöÑÂú∫ÊôØ.</p>
<ul>
<li>ÂÅèÂêëÈîÅÁöÑÂä†ÈîÅ</li>
</ul>
<p>ÂΩì‰∏Ä‰∏™Á∫øÁ®ãËÆøÈóÆÂêåÊ≠•ÂùóÂπ∂Ëé∑ÂèñÈîÅÊó∂, ‰ºöÂú®ÈîÅÂØπË±°ÁöÑÂØπË±°Â§¥ÂíåÊ†àÂ∏ß‰∏≠ÁöÑÈîÅËÆ∞ÂΩïÈáåÂ≠òÂÇ®ÈîÅÂÅèÂêëÁöÑÁ∫øÁ®ãID, ‰ª•ÂêéËØ•Á∫øÁ®ãËøõÂÖ•ÂíåÈÄÄÂá∫ÂêåÊ≠•ÂùóÊó∂‰∏çÈúÄË¶ÅËøõË°åCASÊìç‰ΩúÊù•Âä†ÈîÅÂíåËß£ÈîÅ, Âè™ÈúÄË¶ÅÁÆÄÂçïÁöÑÊµãËØï‰∏Ä‰∏ãÈîÅÂØπË±°ÁöÑÂØπË±°Â§¥ÁöÑMarkWordÈáåÊòØÂê¶Â≠òÂÇ®ÁùÄÊåáÂêëÂΩìÂâçÁ∫øÁ®ãÁöÑÂÅèÂêëÈîÅ(Á∫øÁ®ãIDÊòØÂΩìÂâçÁ∫øÁ®ã), Â¶ÇÊûúÊµãËØïÊàêÂäü, Ë°®Á§∫Á∫øÁ®ãÂ∑≤ÁªèËé∑Âæó‰∫ÜÈîÅ; Â¶ÇÊûúÊµãËØïÂ§±Ë¥•, ÂàôÈúÄË¶ÅÂÜçÊµãËØï‰∏Ä‰∏ãMarkWord‰∏≠ÂÅèÂêëÈîÅÁöÑÊ†áËØÜÊòØÂê¶ËÆæÁΩÆÊàê1(Ë°®Á§∫ÂΩìÂâçÊòØÂÅèÂêëÈîÅ), Â¶ÇÊûúÊ≤°ÊúâËÆæÁΩÆ, Âàô‰ΩøÁî®CASÁ´û‰∫âÈîÅ, Â¶ÇÊûúËÆæÁΩÆ‰∫Ü, ÂàôÂ∞ùËØï‰ΩøÁî®CASÂ∞ÜÈîÅÂØπË±°ÁöÑÂØπË±°Â§¥ÁöÑÂÅèÂêëÈîÅÊåáÂêëÂΩìÂâçÁ∫øÁ®ã.</p>
<ul>
<li>ÂÅèÂêëÈîÅÁöÑÊí§ÈîÄ</li>
</ul>
<p>ÂÅèÂêëÈîÅ‰ΩøÁî®‰∫Ü‰∏ÄÁßçÁ≠âÂà∞Á´û‰∫âÂá∫Áé∞ÊâçÈáäÊîæÈîÅÁöÑÊú∫Âà∂, ÊâÄ‰ª•ÂΩìÂÖ∂‰ªñÁ∫øÁ®ãÂ∞ùËØïÁ´û‰∫âÂÅèÂêëÈîÅÊó∂, ÊåÅÊúâÂÅèÂêëÈîÅÁöÑÁ∫øÁ®ãÊâç‰ºöÈáäÊîæÈîÅ. ÂÅèÂêëÈîÅÁöÑÊí§ÈîÄÈúÄË¶ÅÁ≠âÂà∞ÂÖ®Â±ÄÂÆâÂÖ®ÁÇπ(Âú®Ëøô‰∏™Êó∂Èó¥ÁÇπ‰∏äÊ≤°ÊúâÊ≠£Âú®ÊâßË°åÁöÑÂ≠óËäÇÁ†Å). È¶ñÂÖà‰ºöÊöÇÂÅúÊåÅÊúâÂÅèÂêëÈîÅÁöÑÁ∫øÁ®ã, ÁÑ∂ÂêéÊ£ÄÊü•ÊåÅÊúâÂÅèÂêëÈîÅÁöÑÁ∫øÁ®ãÊòØÂê¶Â≠òÊ¥ª, Â¶ÇÊûúÁ∫øÁ®ã‰∏çÂ§Ñ‰∫éÊ¥ªÂä®Áä∂ÊÄÅ, ÂàôÂ∞ÜÈîÅÂØπË±°ÁöÑÂØπË±°Â§¥ËÆæÁΩÆ‰∏∫Êó†ÈîÅÁä∂ÊÄÅ; Â¶ÇÊûúÁ∫øÁ®ã‰ªçÁÑ∂Ê¥ªÁùÄ, ÂàôÈîÅÂØπË±°ÁöÑÂØπË±°Â§¥‰∏≠ÁöÑMarkWordÂíåÊ†à‰∏≠ÁöÑÈîÅËÆ∞ÂΩïË¶Å‰πàÈáçÊñ∞ÂÅèÂêë‰∫éÂÖ∂ÂÆÉÁ∫øÁ®ãË¶Å‰πàÊÅ¢Â§çÂà∞Êó†ÈîÅÁä∂ÊÄÅ, ÊúÄÂêéÂî§ÈÜíÊöÇÂÅúÁöÑÁ∫øÁ®ã(ÈáäÊîæÂÅèÂêëÈîÅÁöÑÁ∫øÁ®ã).</p>
<ul>
<li>ÊÄªÁªì</li>
</ul>
<p>ÂÅèÂêëÈîÅÂú®Java6ÂèäÊõ¥È´òÁâàÊú¨‰∏≠ÊòØÈªòËÆ§ÂêØÁî®ÁöÑ, ‰ΩÜÊòØÂÆÉÂú®Á®ãÂ∫èÂêØÂä®Âá†ÁßíÈíüÂêéÊâçÊøÄÊ¥ª. ÂèØ‰ª•‰ΩøÁî®-XX:BiasedLockingStartupDelay=0Êù•ÂÖ≥Èó≠ÂÅèÂêëÈîÅÁöÑÂêØÂä®Âª∂Ëøü, ‰πüÂèØ‰ª•‰ΩøÁî®-XX:-UseBiasedLocking=falseÊù•ÂÖ≥Èó≠ÂÅèÂêëÈîÅ, ÈÇ£‰πàÁ®ãÂ∫è‰ºöÁõ¥Êé•ËøõÂÖ•ËΩªÈáèÁ∫ßÈîÅÁä∂ÊÄÅ.</p>
<h5 id="ËΩªÈáèÁ∫ßÈîÅ"><a href="#ËΩªÈáèÁ∫ßÈîÅ" class="headerlink" title="ËΩªÈáèÁ∫ßÈîÅ"></a>ËΩªÈáèÁ∫ßÈîÅ</h5><p><code>ËΩªÈáèÁ∫ßÈîÅ</code>ÊòØÁõ∏ÂØπÂü∫‰∫éOSÁöÑ‰∫íÊñ•ÈáèÂÆûÁé∞ÁöÑÈáçÈáèÁ∫ßÈîÅËÄåË®ÄÁöÑÔºåÂÆÉÁöÑÊú¨ÊÑèÊòØÂú®Ê≤°ÊúâÂ§öÁ∫øÁ®ãÁ´û‰∫âÁöÑÂâçÊèê‰∏ãÔºåÂáèÂ∞ë‰º†ÁªüÁöÑÈáçÈáèÁ∫ßÈîÅ‰ΩøÁî®OSÁöÑ‰∫íÊñ•ÈáèËÄåÂ∏¶Êù•ÁöÑÊÄßËÉΩÊ∂àËÄó„ÄÇ</p>
<p>ËΩªÈáèÁ∫ßÈîÅÊèêÂçáÊÄßËÉΩÁöÑÁªèÈ™å‰æùÊçÆÊòØÔºö<code>ÂØπ‰∫éÁªùÂ§ßÈÉ®ÂàÜÈîÅÔºåÂú®Êï¥‰∏™ÂêåÊ≠•Âë®ÊúüÂÜÖÈÉΩÊòØ‰∏çÂ≠òÂú®Á´û‰∫âÁöÑ</code>„ÄÇÂ¶ÇÊûúÊ≤°ÊúâÁ´û‰∫âÔºåËΩªÈáèÁ∫ßÈîÅÂ∞±ÂèØ‰ª•‰ΩøÁî® CAS Êìç‰ΩúÈÅøÂÖç‰∫íÊñ•ÈáèÁöÑÂºÄÈîÄÔºå‰ªéËÄåÊèêÂçáÊïàÁéá„ÄÇ</p>
<p>ÂΩìÂá∫Áé∞Êúâ‰∏§‰∏™Á∫øÁ®ãÊù•Á´û‰∫âÈîÅÁöÑËØù, ÈÇ£‰πàÂÅèÂêëÈîÅÂ∞±Â§±Êïà‰∫Ü, Ê≠§Êó∂ÈîÅÂ∞±‰ºöËÜ®ËÉÄ, ÂçáÁ∫ß‰∏∫ËΩªÈáèÁ∫ßÈîÅ.</p>
<ul>
<li>ËΩªÈáèÁ∫ßÈîÅÂä†ÈîÅ</li>
</ul>
<p>Á∫øÁ®ãÂú®ÊâßË°åÂêåÊ≠•Âùó‰πãÂâç, JVM‰ºöÂÖàÂú®ÂΩìÂâçÁ∫øÁ®ãÁöÑÊ†àÂ∏ß‰∏≠ÂàõÂª∫Áî®Êà∑Â≠òÂÇ®ÈîÅËÆ∞ÂΩïÁöÑÁ©∫Èó¥, Âπ∂Â∞ÜÂØπË±°Â§¥‰∏≠ÁöÑMarkWordÂ§çÂà∂Âà∞ÈîÅËÆ∞ÂΩï‰∏≠. ÁÑ∂ÂêéÁ∫øÁ®ãÂ∞ùËØï‰ΩøÁî®CASÂ∞ÜÂØπË±°Â§¥‰∏≠ÁöÑMarkWordÊõøÊç¢‰∏∫ÊåáÂêëÈîÅËÆ∞ÂΩïÁöÑÊåáÈíà. Â¶ÇÊûúÊàêÂäü, ÂΩìÂâçÁ∫øÁ®ãËé∑ÂæóÈîÅ; Â¶ÇÊûúÂ§±Ë¥•, Ë°®Á§∫ÂÖ∂ÂÆÉÁ∫øÁ®ãÁ´û‰∫âÈîÅ, ÂΩìÂâçÁ∫øÁ®ã‰æøÂ∞ùËØï‰ΩøÁî®Ëá™ÊóãÊù•Ëé∑ÂèñÈîÅ, ‰πãÂêéÂÜçÊù•ÁöÑÁ∫øÁ®ã, ÂèëÁé∞ÊòØËΩªÈáèÁ∫ßÈîÅ, Â∞±ÂºÄÂßãËøõË°åËá™Êóã.</p>
<ul>
<li>ËΩªÈáèÁ∫ßÈîÅËß£ÈîÅ</li>
</ul>
<p>ËΩªÈáèÁ∫ßÈîÅËß£ÈîÅÊó∂, ‰ºö‰ΩøÁî®ÂéüÂ≠êÁöÑCASÊìç‰ΩúÂ∞ÜÂΩìÂâçÁ∫øÁ®ãÁöÑÈîÅËÆ∞ÂΩïÊõøÊç¢ÂõûÂà∞ÂØπË±°Â§¥, Â¶ÇÊûúÊàêÂäü, Ë°®Á§∫Ê≤°ÊúâÁ´û‰∫âÂèëÁîü; Â¶ÇÊûúÂ§±Ë¥•, Ë°®Á§∫ÂΩìÂâçÈîÅÂ≠òÂú®Á´û‰∫â, ÈîÅÂ∞±‰ºöËÜ®ËÉÄÊàêÈáçÈáèÁ∫ßÈîÅ.</p>
<ul>
<li>ÊÄªÁªì</li>
</ul>
<p>ÊÄªÁªì‰∏Ä‰∏ãÂä†ÈîÅËß£ÈîÅËøáÁ®ã, ÊúâÁ∫øÁ®ãAÂíåÁ∫øÁ®ãBÊù•Á´û‰∫âÂØπË±°cÁöÑÈîÅ(Â¶Ç: synchronized(c){} ), ËøôÊó∂Á∫øÁ®ãAÂíåÁ∫øÁ®ãBÂêåÊó∂Â∞ÜÂØπË±°cÁöÑMarkWordÂ§çÂà∂Âà∞Ëá™Â∑±ÁöÑÈîÅËÆ∞ÂΩï‰∏≠, ‰∏§ËÄÖÁ´û‰∫âÂéªËé∑ÂèñÈîÅ, ÂÅáËÆæÁ∫øÁ®ãAÊàêÂäüËé∑ÂèñÈîÅ, Âπ∂Â∞ÜÂØπË±°cÁöÑÂØπË±°Â§¥‰∏≠ÁöÑÁ∫øÁ®ãID(MarkWord‰∏≠)‰øÆÊîπ‰∏∫ÊåáÂêëËá™Â∑±ÁöÑÈîÅËÆ∞ÂΩïÁöÑÊåáÈíà, ËøôÊó∂Á∫øÁ®ãB‰ªçÊóßÈÄöËøáCASÂéªËé∑ÂèñÂØπË±°cÁöÑÈîÅ, Âõ†‰∏∫ÂØπË±°cÁöÑMarkWord‰∏≠ÁöÑÂÜÖÂÆπÂ∑≤ÁªèË¢´Á∫øÁ®ãAÊîπ‰∫Ü, ÊâÄ‰ª•Ëé∑ÂèñÂ§±Ë¥•. Ê≠§Êó∂‰∏∫‰∫ÜÊèêÈ´òËé∑ÂèñÈîÅÁöÑÊïàÁéá, Á∫øÁ®ãB‰ºöÂæ™ÁéØÂéªËé∑ÂèñÈîÅ, Ëøô‰∏™Âæ™ÁéØÊòØÊúâÊ¨°Êï∞ÈôêÂà∂ÁöÑ, Â¶ÇÊûúÂú®Âæ™ÁéØÁªìÊùü‰πãÂâçCASÊìç‰ΩúÊàêÂäü, ÈÇ£‰πàÁ∫øÁ®ãBÂ∞±Ëé∑ÂèñÂà∞ÈîÅ, Â¶ÇÊûúÂæ™ÁéØÁªìÊùü‰æùÁÑ∂Ëé∑Âèñ‰∏çÂà∞ÈîÅ, ÂàôËé∑ÂèñÈîÅÂ§±Ë¥•, ÂØπË±°cÁöÑMarkWord‰∏≠ÁöÑËÆ∞ÂΩï‰ºöË¢´‰øÆÊîπ‰∏∫ÈáçÈáèÁ∫ßÈîÅ, ÁÑ∂ÂêéÁ∫øÁ®ãBÂ∞±‰ºöË¢´ÊåÇËµ∑, ‰πãÂêéÊúâÁ∫øÁ®ãCÊù•Ëé∑ÂèñÈîÅÊó∂, ÁúãÂà∞ÂØπË±°cÁöÑMarkWord‰∏≠ÁöÑÊòØÈáçÈáèÁ∫ßÈîÅÁöÑÊåáÈíà, ËØ¥ÊòéÁ´û‰∫âÊøÄÁÉà, Áõ¥Êé•ÊåÇËµ∑.</p>
<p>Ëß£ÈîÅÊó∂, Á∫øÁ®ãAÂ∞ùËØï‰ΩøÁî®CASÂ∞ÜÂØπË±°cÁöÑMarkWordÊîπÂõûËá™Â∑±Ê†à‰∏≠Â§çÂà∂ÁöÑÈÇ£‰∏™MarkWord, Âõ†‰∏∫ÂØπË±°c‰∏≠ÁöÑMarkWordÂ∑≤ÁªèË¢´ÊåáÂêë‰∏∫ÈáçÈáèÁ∫ßÈîÅ‰∫Ü, ÊâÄ‰ª•CASÂ§±Ë¥•. Á∫øÁ®ãA‰ºöÈáäÊîæÈîÅÂπ∂Âî§Ëµ∑Á≠âÂæÖÁöÑÁ∫øÁ®ã, ËøõË°åÊñ∞‰∏ÄËΩÆÁöÑÁ´û‰∫â.</p>
<h5 id="ÈáçÈáèÁ∫ßÈîÅ"><a href="#ÈáçÈáèÁ∫ßÈîÅ" class="headerlink" title="ÈáçÈáèÁ∫ßÈîÅ"></a>ÈáçÈáèÁ∫ßÈîÅ</h5><p>monitor ÁõëËßÜÂô®ÈîÅÊú¨Ë¥®‰∏äÊòØ‰æùËµñÊìç‰ΩúÁ≥ªÁªüÁöÑ Mutex Lock ‰∫íÊñ•Èáè Êù•ÂÆûÁé∞ÁöÑÔºåÊàë‰ª¨‰∏ÄËà¨Áß∞‰πã‰∏∫<code>ÈáçÈáèÁ∫ßÈîÅ</code>„ÄÇÂõ†‰∏∫ OS ÂÆûÁé∞Á∫øÁ®ãÈó¥ÁöÑÂàáÊç¢ÈúÄË¶Å‰ªéÁî®Êà∑ÊÄÅËΩ¨Êç¢Âà∞Ê†∏ÂøÉÊÄÅÔºåËøô‰∏™ËΩ¨Êç¢ËøáÁ®ãÊàêÊú¨ËæÉÈ´òÔºåËÄóÊó∂Áõ∏ÂØπËæÉÈïøÔºåÂõ†Ê≠§ synchronized ÊïàÁéá‰ºöÊØîËæÉ‰Ωé„ÄÇ</p>
<p>ÈáçÈáèÁ∫ßÈîÅÁöÑÈîÅÊ†áÂøó‰Ωç‰∏∫‚Äô10‚ÄôÔºåÊåáÈíàÊåáÂêëÁöÑÊòØ monitor ÂØπË±°ÁöÑËµ∑ÂßãÂú∞ÂùÄ</p>
<p>Áªº‰∏äÔºåÂÅèÂêëÈîÅÈÄöËøáÂØπÊØîMark WordËß£ÂÜ≥Âä†ÈîÅÈóÆÈ¢òÔºåÈÅøÂÖçÊâßË°åCASÊìç‰Ωú„ÄÇËÄåËΩªÈáèÁ∫ßÈîÅÊòØÈÄöËøáÁî®CASÊìç‰ΩúÂíåËá™ÊóãÊù•Ëß£ÂÜ≥Âä†ÈîÅÈóÆÈ¢òÔºåÈÅøÂÖçÁ∫øÁ®ãÈòªÂ°ûÂíåÂî§ÈÜíËÄåÂΩ±ÂìçÊÄßËÉΩ„ÄÇÈáçÈáèÁ∫ßÈîÅÊòØÂ∞ÜÈô§‰∫ÜÊã•ÊúâÈîÅÁöÑÁ∫øÁ®ã‰ª•Â§ñÁöÑÁ∫øÁ®ãÈÉΩÈòªÂ°û„ÄÇ</p>
<h3 id="ÈîÅÂçáÁ∫ß"><a href="#ÈîÅÂçáÁ∫ß" class="headerlink" title="ÈîÅÂçáÁ∫ß"></a>ÈîÅÂçáÁ∫ß</h3><h4 id="ÁÆÄÁ≠î"><a href="#ÁÆÄÁ≠î" class="headerlink" title="ÁÆÄÁ≠î"></a>ÁÆÄÁ≠î</h4><p>ÊâÄË∞ìÈîÅÁöÑÂçáÁ∫ß„ÄÅÈôçÁ∫ßÔºåÂ∞±ÊòØ JVM ‰ºòÂåñ synchronized ËøêË°åÁöÑÊú∫Âà∂ÔºåÂΩì JVM Ê£ÄÊµãÂà∞‰∏çÂêåÁöÑÁ´û‰∫âÁä∂ÂÜµÊó∂Ôºå‰ºöËá™Âä®ÂàáÊç¢Âà∞ÈÄÇÂêàÁöÑÈîÅÂÆûÁé∞ÔºåËøôÁßçÂàáÊç¢Â∞±ÊòØÈîÅÁöÑÂçáÁ∫ß„ÄÅÈôçÁ∫ß„ÄÇ</p>
<p>ÂΩìÊ≤°ÊúâÁ´û‰∫âÂá∫Áé∞Êó∂ÔºåÈªòËÆ§‰ºö‰ΩøÁî®ÂÅèÊñúÈîÅ„ÄÇJVM ‰ºöÂà©Áî® CAS Êìç‰ΩúÔºàcompare and swapÔºâÔºåÂú®ÂØπË±°Â§¥‰∏äÁöÑ Mark Word ÈÉ®ÂàÜËÆæÁΩÆÁ∫øÁ®ã IDÔºå‰ª•Ë°®Á§∫Ëøô‰∏™ÂØπË±°ÂÅèÂêë‰∫éÂΩìÂâçÁ∫øÁ®ãÔºåÊâÄ‰ª•Âπ∂‰∏çÊ∂âÂèäÁúüÊ≠£ÁöÑ‰∫íÊñ•ÈîÅ„ÄÇËøôÊ†∑ÂÅöÁöÑÂÅáËÆæÊòØÂü∫‰∫éÂú®ÂæàÂ§öÂ∫îÁî®Âú∫ÊôØ‰∏≠ÔºåÂ§ßÈÉ®ÂàÜÂØπË±°ÁîüÂëΩÂë®Êúü‰∏≠ÊúÄÂ§ö‰ºöË¢´‰∏Ä‰∏™Á∫øÁ®ãÈîÅÂÆöÔºå‰ΩøÁî®ÂÅèÊñúÈîÅÂèØ‰ª•Èôç‰ΩéÊó†Á´û‰∫âÂºÄÈîÄ„ÄÇ</p>
<p>Â¶ÇÊûúÊúâÂè¶Â§ñÁöÑÁ∫øÁ®ãËØïÂõæÈîÅÂÆöÊüê‰∏™Â∑≤ÁªèË¢´ÂÅèÊñúËøáÁöÑÂØπË±°ÔºåJVM Â∞±ÈúÄË¶ÅÊí§ÈîÄÔºàrevokeÔºâÂÅèÊñúÈîÅÔºåÂπ∂ÂàáÊç¢Âà∞ËΩªÈáèÁ∫ßÈîÅÂÆûÁé∞„ÄÇËΩªÈáèÁ∫ßÈîÅ‰æùËµñ CAS Êìç‰Ωú Mark Word Êù•ËØïÂõæËé∑ÂèñÈîÅÔºåÂ¶ÇÊûúÈáçËØïÊàêÂäüÔºåÂ∞±‰ΩøÁî®ÊôÆÈÄöÁöÑËΩªÈáèÁ∫ßÈîÅÔºõÂê¶ÂàôÔºåËøõ‰∏ÄÊ≠•ÂçáÁ∫ß‰∏∫ÈáçÈáèÁ∫ßÈîÅ„ÄÇ</p>
<h4 id="ËØ¶Á≠î"><a href="#ËØ¶Á≠î" class="headerlink" title="ËØ¶Á≠î"></a>ËØ¶Á≠î</h4><p>ÂΩìT1Á∫øÁ®ãËÆøÈóÆÂêåÊ≠•‰ª£Á†ÅÂùóÂπ∂Ëé∑ÂèñÈîÅÂØπË±°Êó∂Ôºå‰ºöÂú®javaÂØπË±°Â§¥ÂíåÊ†àÂ∏ß‰∏≠ËÆ∞ÂΩïÂÅèÂêëÈîÅÁöÑÁ∫øÁ®ãIDÔºåÂÅèÂêëÈîÅ‰∏ç‰ºö‰∏ªÂä®ÈáäÊîæÈîÅ„ÄÇÂΩìÂÜçÊ¨°ÊúâÁ∫øÁ®ãËÆøÈóÆËØ•ÈîÅÊó∂Ôºå‰ºöÂà§Êñ≠ÂΩìÂâçÁ∫øÁ®ãÁöÑIDÂíåÂØπË±°Â§¥‰∏≠ÁöÑÁ∫øÁ®ãIDÊòØÂê¶‰∏ÄËá¥ÔºåÂ¶ÇÊûú‰∏ÄËá¥Âàô‰∏çÁî®ÂÜçÈÄöËøáCASÊù•Âä†ÈîÅÔºåËß£ÈîÅ„ÄÇÂ¶ÇÊûú‰∏ç‰∏ÄËá¥ÔºàË°®ÊòéÊúâÂÖ∂‰ªñÁ∫øÁ®ãÊù•Á´û‰∫âÈîÅÔºå‰ΩÜÊòØÂÅèÂêëÈîÅ‰∏ç‰ºö‰∏ªÂä®ÈáäÊîæÔºåÂõ†Ê≠§ÂØπË±°Â§¥‰∏≠‰æùÊóßÂ≠òÂÇ®ÁöÑÊòØT1ÁöÑÁ∫øÁ®ãIDÔºâÔºåÈÇ£‰πàÂ∞±ÈúÄË¶ÅÊü•ÁúãjavaÂØπË±°Â§¥‰∏≠ËÆ∞ÂΩïÁöÑT1Á∫øÁ®ãÊòØÂê¶Â≠òÊ¥ªÔºåÂ¶ÇÊûúÊ≤°ÊúâÂ≠òÊ¥ªÔºåÈÇ£‰πàÂ∞±Â∞ÜÈîÅÂØπË±°ÁΩÆ‰∏∫Êó†ÊâÄÁä∂ÊÄÅÔºåT2Á∫øÁ®ãÂèØ‰ª•Á´û‰∫âÂ∞ÜÂÖ∂ËÆæÁΩÆ‰∏∫ÂÅèÂêëÈîÅ„ÄÇÂ¶ÇÊûúÂ≠òÊ¥ªÔºåÂàôÊü•ÁúãT1ÁöÑÊ†àÂ∏ß‰ø°ÊÅØÔºåÂ¶ÇÊûúËøòÈúÄË¶ÅÁªßÁª≠ÊåÅÊúâËøô‰∏™ÈîÅÂØπË±°ÔºåÈÇ£‰πàÂ∞±ÂÅúÊ≠¢ÂΩìÂâçÁ∫øÁ®ãT1ÔºåÊí§ÈîÄÂÅèÂêëÈîÅÔºåÂçáÁ∫ß‰∏∫ËΩªÈáèÁ∫ßÈîÅ„ÄÇÂ¶ÇÊûúT1‰∏çÂÜç‰ΩøÁî®Ëøô‰∏™ÈîÅÂØπË±°ÔºåÈÇ£‰πàÂ∞ÜÈîÅÁΩÆ‰∏∫Êó†ÈîÅÁä∂ÊÄÅÔºåÈáçÊñ∞ÂÅèÂêëÊñ∞ÁöÑÁ∫øÁ®ã„ÄÇ</p>
<p>Á∫øÁ®ã1Ëé∑ÂèñËΩªÈáèÁ∫ßÈîÅÊó∂‰ºöÂÖàÊääÈîÅÂØπË±°ÁöÑÂØπË±°Â§¥MarkWordÂ§çÂà∂‰∏Ä‰ªΩÂà∞Á∫øÁ®ã1ÁöÑÊ†àÂ∏ß‰∏≠ÂàõÂª∫ÁöÑÁî®‰∫éÂ≠òÂÇ®ÈîÅËÆ∞ÂΩïÁöÑÁ©∫Èó¥ÔºàÁß∞‰∏∫DisplacedMarkWordÔºâÔºåÁÑ∂Âêé‰ΩøÁî®CASÊääÂØπË±°Â§¥‰∏≠ÁöÑÂÜÖÂÆπÊõøÊç¢‰∏∫Á∫øÁ®ã1Â≠òÂÇ®ÁöÑÈîÅËÆ∞ÂΩïÔºàDisplacedMarkWordÔºâÁöÑÂú∞ÂùÄÔºõ</p>
<p>Â¶ÇÊûúÂú®Á∫øÁ®ã1Â§çÂà∂ÂØπË±°Â§¥ÁöÑÂêåÊó∂ÔºàÂú®Á∫øÁ®ã1CAS‰πãÂâçÔºâÔºåÁ∫øÁ®ã2‰πüÂáÜÂ§áËé∑ÂèñÈîÅÔºåÂ§çÂà∂‰∫ÜÂØπË±°Â§¥Âà∞Á∫øÁ®ã2ÁöÑÈîÅËÆ∞ÂΩïÁ©∫Èó¥‰∏≠Ôºå‰ΩÜÊòØÂú®Á∫øÁ®ã2CASÁöÑÊó∂ÂÄôÔºåÂèëÁé∞Á∫øÁ®ã1Â∑≤ÁªèÊääÂØπË±°Â§¥Êç¢‰∫ÜÔºåÁ∫øÁ®ã2ÁöÑCASÂ§±Ë¥•ÔºåÈÇ£‰πàÁ∫øÁ®ã2Â∞±Â∞ùËØï‰ΩøÁî®Ëá™ÊóãÈîÅÊù•Á≠âÂæÖÁ∫øÁ®ã1ÈáäÊîæÈîÅ„ÄÇ</p>
<p>‰ΩÜÊòØÂ¶ÇÊûúËá™ÊóãÁöÑÊó∂Èó¥Â§™Èïø‰πü‰∏çË°åÔºåÂõ†‰∏∫Ëá™ÊóãÊòØË¶ÅÊ∂àËÄóCPUÁöÑÔºåÂõ†Ê≠§Ëá™ÊóãÁöÑÊ¨°Êï∞ÊòØÊúâÈôêÂà∂ÁöÑÔºåÊØîÂ¶Ç10Ê¨°ÊàñËÄÖ100Ê¨°ÔºåÂ¶ÇÊûúËá™ÊóãÊ¨°Êï∞Âà∞‰∫ÜÁ∫øÁ®ã1ËøòÊ≤°ÊúâÈáäÊîæÈîÅÔºåÊàñËÄÖÁ∫øÁ®ã1ËøòÂú®ÊâßË°åÔºåÁ∫øÁ®ã2ËøòÂú®Ëá™ÊóãÁ≠âÂæÖÔºåËøôÊó∂ÂèàÊúâ‰∏Ä‰∏™Á∫øÁ®ã3ËøáÊù•Á´û‰∫âËøô‰∏™ÈîÅÂØπË±°ÔºåÈÇ£‰πàËøô‰∏™Êó∂ÂÄôËΩªÈáèÁ∫ßÈîÅÂ∞±‰ºöËÜ®ËÉÄ‰∏∫ÈáçÈáèÁ∫ßÈîÅ„ÄÇÈáçÈáèÁ∫ßÈîÅÊääÈô§‰∫ÜÊã•ÊúâÈîÅÁöÑÁ∫øÁ®ãÈÉΩÈòªÂ°ûÔºåÈò≤Ê≠¢CPUÁ©∫ËΩ¨„ÄÇ</p>
<p><strong>Ê≥®ÊÑèÔºö</strong>‰∏∫‰∫ÜÈÅøÂÖçÊó†Áî®ÁöÑËá™ÊóãÔºåËΩªÈáèÁ∫ßÈîÅ‰∏ÄÊó¶ËÜ®ËÉÄ‰∏∫ÈáçÈáèÁ∫ßÈîÅÂ∞±‰∏ç‰ºöÂÜçÈôçÁ∫ß‰∏∫ËΩªÈáèÁ∫ßÈîÅ‰∫ÜÔºõÂÅèÂêëÈîÅÂçáÁ∫ß‰∏∫ËΩªÈáèÁ∫ßÈîÅ‰πü‰∏çËÉΩÂÜçÈôçÁ∫ß‰∏∫ÂÅèÂêëÈîÅ„ÄÇ‰∏ÄÂè•ËØùÂ∞±ÊòØÈîÅÂèØ‰ª•ÂçáÁ∫ß‰∏çÂèØ‰ª•ÈôçÁ∫ßÔºå‰ΩÜÊòØÂÅèÂêëÈîÅÁä∂ÊÄÅÂèØ‰ª•Ë¢´ÈáçÁΩÆ‰∏∫Êó†ÈîÅÁä∂ÊÄÅ„ÄÇ</p>
<table>
<thead>
<tr>
<th>ÈîÅ</th>
<th>‰ºòÁÇπ</th>
<th>Áº∫ÁÇπ</th>
<th>ÈÄÇÁî®Âú∫ÊôØ</th>
</tr>
</thead>
<tbody><tr>
<td>ÂÅèÂêëÈîÅ</td>
<td>Âä†ÈîÅÂíåËß£ÈîÅ‰∏çÈúÄË¶ÅÈ¢ùÂ§ñÁöÑÊ∂àËÄó, ÂíåÊâßË°åÈùûÂêåÊ≠•‰ª£Á†ÅÊñπÊ≥ïÁöÑÊÄßËÉΩÁõ∏Â∑ÆÊó†Âá†.</td>
<td>Â¶ÇÊûúÁ∫øÁ®ãÈó¥Â≠òÂú®ÈîÅÁ´û‰∫â, ‰ºöÂ∏¶Êù•È¢ùÂ§ñÁöÑÈîÅÊí§ÈîÄÁöÑÊ∂àËÄó.</td>
<td>ÈÄÇÁî®‰∫éÂè™Êúâ‰∏Ä‰∏™Á∫øÁ®ãËÆøÈóÆÁöÑÂêåÊ≠•Âú∫ÊôØ</td>
</tr>
<tr>
<td>ËΩªÈáèÁ∫ßÈîÅ</td>
<td>Á´û‰∫âÁöÑÁ∫øÁ®ã‰∏ç‰ºöÈòªÂ°û, ÊèêÈ´ò‰∫ÜÁ®ãÂ∫èÁöÑÂìçÂ∫îÈÄüÂ∫¶</td>
<td>Â¶ÇÊûúÂßãÁªàÂæó‰∏çÂà∞ÈîÅÁ´û‰∫âÁöÑÁ∫øÁ®ã, ‰ΩøÁî®Ëá™Êóã‰ºöÊ∂àËÄóCPU</td>
<td>ËøΩÊ±ÇÂìçÂ∫îÊó∂Èó¥, ÂêåÊ≠•Âø´ÊâßË°åÈÄüÂ∫¶ÈùûÂ∏∏Âø´</td>
</tr>
<tr>
<td>ÈáçÈáèÁ∫ßÈîÅ</td>
<td>Á∫øÁ®ãÁ´û‰∫â‰∏çÈÄÇÁî®Ëá™Êóã, ‰∏ç‰ºöÊ∂àËÄóCPU</td>
<td>Á∫øÁ®ãÂ†µÂ°û, ÂìçÂ∫îÊó∂Èó¥ÁºìÊÖ¢</td>
<td>ËøΩÊ±ÇÂêûÂêêÈáè, ÂêåÊ≠•Âø´ÊâßË°åÊó∂Èó¥ÈÄüÂ∫¶ËæÉÈïø</td>
</tr>
</tbody></table>
<p><a target="_blank" rel="noopener" href="https://www.cnblogs.com/wuqinglong/p/9945618.html">https://www.cnblogs.com/wuqinglong/p/9945618.html</a></p>
<h2 id="Synchronized-Âíå-ReentrantLock-ÁöÑÂå∫Âà´Ôºü"><a href="#Synchronized-Âíå-ReentrantLock-ÁöÑÂå∫Âà´Ôºü" class="headerlink" title="Synchronized Âíå ReentrantLock ÁöÑÂå∫Âà´Ôºü"></a>Synchronized Âíå ReentrantLock ÁöÑÂå∫Âà´Ôºü</h2><p>ÈÉΩÊòØÂèØÈáçÂÖ•ÈîÅ</p>
<ul>
<li>synchronized ÊòØ JVM ÈöêÂºèÂÆûÁé∞ÁöÑÔºåËÄå ReentrantLock ÊòØ Java ËØ≠Ë®ÄÊèê‰æõÁöÑ APIÔºõ</li>
<li>ReentrantLock ÂèØËÆæÁΩÆ‰∏∫ÂÖ¨Âπ≥ÈîÅÔºåËÄå synchronized Âç¥‰∏çË°åÔºõ</li>
<li>ReentrantLock Âè™ËÉΩ‰øÆÈ•∞‰ª£Á†ÅÂùóÔºåËÄå synchronized ÂèØ‰ª•Áî®‰∫é‰øÆÈ•∞ÊñπÊ≥ï„ÄÅ‰øÆÈ•∞‰ª£Á†ÅÂùóÁ≠âÔºõ</li>
<li>ReentrantLock ÈúÄË¶ÅÊâãÂä®Âä†ÈîÅÂíåÈáäÊîæÈîÅÔºåÂ¶ÇÊûúÂøòËÆ∞ÈáäÊîæÈîÅÔºåÂàô‰ºöÈÄ†ÊàêËµÑÊ∫êË¢´Ê∞∏‰πÖÂç†Áî®ÔºåËÄå synchronized Êó†ÈúÄÊâãÂä®ÈáäÊîæÈîÅÔºõ</li>
<li>ReentrantLock ÂèØ‰ª•Áü•ÈÅìÊòØÂê¶ÊàêÂäüËé∑Âæó‰∫ÜÈîÅÔºåËÄå synchronized  Âç¥‰∏çË°å„ÄÇ</li>
</ul>
<p><strong>ReentrantLock ÊØî synchronized Â¢ûÂä†‰∫Ü‰∏Ä‰∫õÈ´òÁ∫ßÂäüËÉΩ</strong></p>
<p>Áõ∏ÊØî<code>synchronized</code>Ôºå<code>ReentrantLock</code>Â¢ûÂä†‰∫Ü‰∏Ä‰∫õÈ´òÁ∫ßÂäüËÉΩ„ÄÇ‰∏ªË¶ÅÊù•ËØ¥‰∏ªË¶ÅÊúâ‰∏âÁÇπÔºö</p>
<ul>
<li><strong>Á≠âÂæÖÂèØ‰∏≠Êñ≠</strong> : <code>ReentrantLock</code>Êèê‰æõ‰∫Ü‰∏ÄÁßçËÉΩÂ§ü‰∏≠Êñ≠Á≠âÂæÖÈîÅÁöÑÁ∫øÁ®ãÁöÑÊú∫Âà∂ÔºåÈÄöËøá <code>lock.lockInterruptibly()</code> Êù•ÂÆûÁé∞Ëøô‰∏™Êú∫Âà∂„ÄÇ‰πüÂ∞±ÊòØËØ¥Ê≠£Âú®Á≠âÂæÖÁöÑÁ∫øÁ®ãÂèØ‰ª•ÈÄâÊã©ÊîæÂºÉÁ≠âÂæÖÔºåÊîπ‰∏∫Â§ÑÁêÜÂÖ∂‰ªñ‰∫ãÊÉÖ„ÄÇ</li>
<li><strong>ÂèØÂÆûÁé∞ÂÖ¨Âπ≥ÈîÅ</strong> : <code>ReentrantLock</code>ÂèØ‰ª•ÊåáÂÆöÊòØÂÖ¨Âπ≥ÈîÅËøòÊòØÈùûÂÖ¨Âπ≥ÈîÅ„ÄÇËÄå<code>synchronized</code>Âè™ËÉΩÊòØÈùûÂÖ¨Âπ≥ÈîÅ„ÄÇÊâÄË∞ìÁöÑÂÖ¨Âπ≥ÈîÅÂ∞±ÊòØÂÖàÁ≠âÂæÖÁöÑÁ∫øÁ®ãÂÖàËé∑ÂæóÈîÅ„ÄÇ<code>ReentrantLock</code>ÈªòËÆ§ÊÉÖÂÜµÊòØÈùûÂÖ¨Âπ≥ÁöÑÔºåÂèØ‰ª•ÈÄöËøá <code>ReentrantLock</code>Á±ªÁöÑ<code>ReentrantLock(boolean fair)</code>ÊûÑÈÄ†ÊñπÊ≥ïÊù•Âà∂ÂÆöÊòØÂê¶ÊòØÂÖ¨Âπ≥ÁöÑ„ÄÇ</li>
<li><strong>ÂèØÂÆûÁé∞ÈÄâÊã©ÊÄßÈÄöÁü•ÔºàÈîÅÂèØ‰ª•ÁªëÂÆöÂ§ö‰∏™Êù°‰ª∂Ôºâ</strong>: <code>synchronized</code>ÂÖ≥ÈîÆÂ≠ó‰∏é<code>wait()</code>Âíå<code>notify()</code>/<code>notifyAll()</code>ÊñπÊ≥ïÁõ∏ÁªìÂêàÂèØ‰ª•ÂÆûÁé∞Á≠âÂæÖ/ÈÄöÁü•Êú∫Âà∂„ÄÇ<code>ReentrantLock</code>Á±ªÂΩìÁÑ∂‰πüÂèØ‰ª•ÂÆûÁé∞Ôºå‰ΩÜÊòØÈúÄË¶ÅÂÄüÂä©‰∫é<code>Condition</code>Êé•Âè£‰∏é<code>newCondition()</code>ÊñπÊ≥ï„ÄÇ</li>
</ul>
<blockquote>
<p><code>Condition</code>ÊòØ JDK1.5 ‰πãÂêéÊâçÊúâÁöÑÔºåÂÆÉÂÖ∑ÊúâÂæàÂ•ΩÁöÑÁÅµÊ¥ªÊÄßÔºåÊØîÂ¶ÇÂèØ‰ª•ÂÆûÁé∞Â§öË∑ØÈÄöÁü•ÂäüËÉΩ‰πüÂ∞±ÊòØÂú®‰∏Ä‰∏™<code>Lock</code>ÂØπË±°‰∏≠ÂèØ‰ª•ÂàõÂª∫Â§ö‰∏™<code>Condition</code>ÂÆû‰æãÔºàÂç≥ÂØπË±°ÁõëËßÜÂô®ÔºâÔºå<strong>Á∫øÁ®ãÂØπË±°ÂèØ‰ª•Ê≥®ÂÜåÂú®ÊåáÂÆöÁöÑ<code>Condition</code>‰∏≠Ôºå‰ªéËÄåÂèØ‰ª•ÊúâÈÄâÊã©ÊÄßÁöÑËøõË°åÁ∫øÁ®ãÈÄöÁü•ÔºåÂú®Ë∞ÉÂ∫¶Á∫øÁ®ã‰∏äÊõ¥Âä†ÁÅµÊ¥ª„ÄÇ Âú®‰ΩøÁî®<code>notify()/notifyAll()</code>ÊñπÊ≥ïËøõË°åÈÄöÁü•Êó∂ÔºåË¢´ÈÄöÁü•ÁöÑÁ∫øÁ®ãÊòØÁî± JVM ÈÄâÊã©ÁöÑÔºåÁî®<code>ReentrantLock</code>Á±ªÁªìÂêà<code>Condition</code>ÂÆû‰æãÂèØ‰ª•ÂÆûÁé∞‚ÄúÈÄâÊã©ÊÄßÈÄöÁü•‚Äù</strong> ÔºåËøô‰∏™ÂäüËÉΩÈùûÂ∏∏ÈáçË¶ÅÔºåËÄå‰∏îÊòØ Condition Êé•Âè£ÈªòËÆ§Êèê‰æõÁöÑ„ÄÇËÄå<code>synchronized</code>ÂÖ≥ÈîÆÂ≠óÂ∞±Áõ∏ÂΩì‰∫éÊï¥‰∏™ Lock ÂØπË±°‰∏≠Âè™Êúâ‰∏Ä‰∏™<code>Condition</code>ÂÆû‰æãÔºåÊâÄÊúâÁöÑÁ∫øÁ®ãÈÉΩÊ≥®ÂÜåÂú®ÂÆÉ‰∏Ä‰∏™Ë∫´‰∏ä„ÄÇÂ¶ÇÊûúÊâßË°å<code>notifyAll()</code>ÊñπÊ≥ïÁöÑËØùÂ∞±‰ºöÈÄöÁü•ÊâÄÊúâÂ§Ñ‰∫éÁ≠âÂæÖÁä∂ÊÄÅÁöÑÁ∫øÁ®ãËøôÊ†∑‰ºöÈÄ†ÊàêÂæàÂ§ßÁöÑÊïàÁéáÈóÆÈ¢òÔºåËÄå<code>Condition</code>ÂÆû‰æãÁöÑ<code>signalAll()</code>ÊñπÊ≥ï Âè™‰ºöÂî§ÈÜíÊ≥®ÂÜåÂú®ËØ•<code>Condition</code>ÂÆû‰æã‰∏≠ÁöÑÊâÄÊúâÁ≠âÂæÖÁ∫øÁ®ã„ÄÇ</p>
</blockquote>
<p><strong>Â¶ÇÊûú‰Ω†ÊÉ≥‰ΩøÁî®‰∏äËø∞ÂäüËÉΩÔºåÈÇ£‰πàÈÄâÊã© ReentrantLock ÊòØ‰∏Ä‰∏™‰∏çÈîôÁöÑÈÄâÊã©„ÄÇÊÄßËÉΩÂ∑≤‰∏çÊòØÈÄâÊã©Ê†áÂáÜ</strong></p>
<h2 id="Synchronized-‰ªÄ‰πàÊÉÖÂÜµÊòØÂØπË±°ÈîÅÔºü-‰ªÄ‰πàÊó∂ÂÄôÊòØÂÖ®Â±ÄÈîÅÔºü"><a href="#Synchronized-‰ªÄ‰πàÊÉÖÂÜµÊòØÂØπË±°ÈîÅÔºü-‰ªÄ‰πàÊó∂ÂÄôÊòØÂÖ®Â±ÄÈîÅÔºü" class="headerlink" title="Synchronized ‰ªÄ‰πàÊÉÖÂÜµÊòØÂØπË±°ÈîÅÔºü ‰ªÄ‰πàÊó∂ÂÄôÊòØÂÖ®Â±ÄÈîÅÔºü"></a>Synchronized ‰ªÄ‰πàÊÉÖÂÜµÊòØÂØπË±°ÈîÅÔºü ‰ªÄ‰πàÊó∂ÂÄôÊòØÂÖ®Â±ÄÈîÅÔºü</h2><p>ÂØπË±°ÈîÅÔºösynchronized(this)  ‰ª•ÂèäÈùûstaticÁöÑsynchronizedÊñπÊ≥ï </p>
<p>ÂÖ®Â±ÄÈîÅÔºösynchronized ÈùôÊÄÅÊñπÊ≥ï‰πüÁõ∏ÂΩì‰∫éÂÖ®Â±ÄÈîÅ</p>
<h2 id="ËØ¥ËØ¥-synchronized-ÂÖ≥ÈîÆÂ≠óÂíå-volatile-ÂÖ≥ÈîÆÂ≠óÁöÑÂå∫Âà´"><a href="#ËØ¥ËØ¥-synchronized-ÂÖ≥ÈîÆÂ≠óÂíå-volatile-ÂÖ≥ÈîÆÂ≠óÁöÑÂå∫Âà´" class="headerlink" title="ËØ¥ËØ¥ synchronized ÂÖ≥ÈîÆÂ≠óÂíå volatile ÂÖ≥ÈîÆÂ≠óÁöÑÂå∫Âà´"></a>ËØ¥ËØ¥ synchronized ÂÖ≥ÈîÆÂ≠óÂíå volatile ÂÖ≥ÈîÆÂ≠óÁöÑÂå∫Âà´</h2><p><code>synchronized</code> ÂÖ≥ÈîÆÂ≠óÂíå <code>volatile</code> ÂÖ≥ÈîÆÂ≠óÊòØ‰∏§‰∏™‰∫íË°•ÁöÑÂ≠òÂú®ÔºåËÄå‰∏çÊòØÂØπÁ´ãÁöÑÂ≠òÂú®ÔºÅ</p>
<ul>
<li><code>volatile</code> ÂÖ≥ÈîÆÂ≠óÊòØÁ∫øÁ®ãÂêåÊ≠•ÁöÑ<strong>ËΩªÈáèÁ∫ßÂÆûÁé∞</strong>ÔºåÊâÄ‰ª•<code>volatile </code>ÊÄßËÉΩËÇØÂÆöÊØî<code>synchronized</code>ÂÖ≥ÈîÆÂ≠óË¶ÅÂ•Ω„ÄÇ‰ΩÜÊòØ volatile ÂÖ≥ÈîÆÂ≠óÂè™ËÉΩÁî®‰∫éÂèòÈáèËÄå <code>synchronized</code> ÂÖ≥ÈîÆÂ≠óÂèØ‰ª•‰øÆÈ•∞ÊñπÊ≥ï‰ª•Âèä‰ª£Á†ÅÂùó„ÄÇ</li>
<li><code>volatile</code> ÂÖ≥ÈîÆÂ≠óËÉΩ‰øùËØÅÊï∞ÊçÆÁöÑÂèØËßÅÊÄßÔºå‰ΩÜ‰∏çËÉΩ‰øùËØÅÊï∞ÊçÆÁöÑÂéüÂ≠êÊÄß„ÄÇ<code>synchronized</code> ÂÖ≥ÈîÆÂ≠ó‰∏§ËÄÖÈÉΩËÉΩ‰øùËØÅ„ÄÇ</li>
<li><code>volatile</code>ÂÖ≥ÈîÆÂ≠ó‰∏ªË¶ÅÁî®‰∫éËß£ÂÜ≥ÂèòÈáèÂú®Â§ö‰∏™Á∫øÁ®ã‰πãÈó¥ÁöÑÂèØËßÅÊÄßÔºåËÄå <code>synchronized</code> ÂÖ≥ÈîÆÂ≠óËß£ÂÜ≥ÁöÑÊòØÂ§ö‰∏™Á∫øÁ®ã‰πãÈó¥ËÆøÈóÆËµÑÊ∫êÁöÑÂêåÊ≠•ÊÄß„ÄÇ</li>
</ul>
<h2 id="Â§öÁ∫øÁ®ãÁöÑ‰ºòÁº∫ÁÇπ"><a href="#Â§öÁ∫øÁ®ãÁöÑ‰ºòÁº∫ÁÇπ" class="headerlink" title="Â§öÁ∫øÁ®ãÁöÑ‰ºòÁº∫ÁÇπ"></a>Â§öÁ∫øÁ®ãÁöÑ‰ºòÁº∫ÁÇπ</h2><p><strong>‰ºòÁÇπÔºö</strong></p>
<ul>
<li>ËµÑÊ∫êÂà©Áî®ÁéáÈ´òÔºàIOËØªÂèñÔºâ</li>
<li>Á®ãÂ∫èÂìçÂ∫îÊõ¥Âø´</li>
<li>Êüê‰∫õÊÉÖÂÜµ‰∏ãÁ®ãÂ∫èËÆæËÆ°Êõ¥ÁÆÄÂçï</li>
</ul>
<p><strong>Áº∫ÁÇπÔºö</strong></p>
<ul>
<li>‰∏ä‰∏ãÊñáÂàáÊç¢ÂºÄÈîÄÂ§ß</li>
<li>Â¢ûÂä†ËµÑÊ∫êÊ∂àËÄó</li>
<li>Â§öÁ∫øÁ®ãÈúÄË¶ÅÊõ¥Â§öÁöÑÂÜÖÂ≠òÁ©∫Èó¥</li>
<li>ËÆæËÆ°Êõ¥Â§çÊùÇ</li>
</ul>
<p><strong>‰ªÄ‰πàÊó∂ÂÄôÈúÄË¶ÅÁî®Âà∞Â§öÁ∫øÁ®ã</strong></p>
<ul>
<li><p>ÈÄöËøáÂπ∂Ë°åËÆ°ÁÆóÊèêÂçáÁ®ãÂ∫èÊÄßËÉΩ</p>
<ul>
<li>‰æãÂ¶ÇÔºö‰∏Ä‰∏™Â§ß‰ªªÂä°ÊàñËÆ°ÁÆóÈÄªËæëÔºåÂèØ‰ª•ÈÄöËøáÊãÜÂàÜÊàêÂ§ö‰∏™Â∞è‰ªªÂä°Âπ∂Ë°åÊâßË°å</li>
</ul>
</li>
<li><p>Á≠âÂæÖÁΩëÁªú IOÂìçÂ∫îÂØºËá¥ÁöÑËÄóÊó∂ÈóÆÈ¢ò</p>
</li>
</ul>
<p><strong>Â§öÁ∫øÁ®ãËÉΩÂ∏¶Êù•‰ªÄ‰πàÈóÆÈ¢òÔºö</strong></p>
<ul>
<li>ÂÆâÂÖ®ÊÄßÈóÆÈ¢ò<ul>
<li>ÂéüÂ≠êÊÄß„ÄÅÂèØËßÅÊÄß„ÄÅÊúâÂ∫èÊÄß</li>
<li>Âπ∂ÂèëÂÆâÂÖ®</li>
</ul>
</li>
<li>Ê¥ªË∑ÉÊÄßÈóÆÈ¢ò<ul>
<li>Ê≠ªÈîÅ</li>
<li>Ê¥ªÈîÅ</li>
</ul>
</li>
<li>ÊÄßËÉΩÈóÆÈ¢ò<ul>
<li>‰∏ä‰∏ãÊñáÂàáÊç¢</li>
<li>ËµÑÊ∫êÈôêÂà∂</li>
</ul>
</li>
</ul>
<h2 id="‰ªÄ‰πàÊòØ‰∏ä‰∏ãÊñáÂàáÊç¢"><a href="#‰ªÄ‰πàÊòØ‰∏ä‰∏ãÊñáÂàáÊç¢" class="headerlink" title="‰ªÄ‰πàÊòØ‰∏ä‰∏ãÊñáÂàáÊç¢"></a>‰ªÄ‰πàÊòØ‰∏ä‰∏ãÊñáÂàáÊç¢</h2><p>Â§öÁ∫øÁ®ãÁºñÁ®ã‰∏≠‰∏ÄËà¨Á∫øÁ®ãÁöÑ‰∏™Êï∞ÈÉΩÂ§ß‰∫é CPU Ê†∏ÂøÉÁöÑ‰∏™Êï∞ÔºåËÄå‰∏Ä‰∏™ CPU Ê†∏ÂøÉÂú®‰ªªÊÑèÊó∂ÂàªÂè™ËÉΩË¢´‰∏Ä‰∏™Á∫øÁ®ã‰ΩøÁî®Ôºå‰∏∫‰∫ÜËÆ©Ëøô‰∫õÁ∫øÁ®ãÈÉΩËÉΩÂæóÂà∞ÊúâÊïàÊâßË°åÔºåCPU ÈááÂèñÁöÑÁ≠ñÁï•ÊòØ‰∏∫ÊØè‰∏™Á∫øÁ®ãÂàÜÈÖçÊó∂Èó¥ÁâáÂπ∂ËΩÆËΩ¨ÁöÑÂΩ¢Âºè„ÄÇÂΩì‰∏Ä‰∏™Á∫øÁ®ãÁöÑÊó∂Èó¥ÁâáÁî®ÂÆåÁöÑÊó∂ÂÄôÂ∞±‰ºöÈáçÊñ∞Â§Ñ‰∫éÂ∞±Áª™Áä∂ÊÄÅËÆ©ÁªôÂÖ∂‰ªñÁ∫øÁ®ã‰ΩøÁî®ÔºåËøô‰∏™ËøáÁ®ãÂ∞±Â±û‰∫é‰∏ÄÊ¨°‰∏ä‰∏ãÊñáÂàáÊç¢„ÄÇÊ¶ÇÊã¨Êù•ËØ¥Â∞±ÊòØÔºöÂΩìÂâç‰ªªÂä°Âú®ÊâßË°åÂÆå CPU Êó∂Èó¥ÁâáÂàáÊç¢Âà∞Âè¶‰∏Ä‰∏™‰ªªÂä°‰πãÂâç‰ºöÂÖà‰øùÂ≠òËá™Â∑±ÁöÑÁä∂ÊÄÅÔºå‰ª•‰æø‰∏ãÊ¨°ÂÜçÂàáÊç¢ÂõûËøô‰∏™‰ªªÂä°Êó∂ÔºåÂèØ‰ª•ÂÜçÂä†ËΩΩËøô‰∏™‰ªªÂä°ÁöÑÁä∂ÊÄÅ„ÄÇ<strong>‰ªªÂä°‰ªé‰øùÂ≠òÂà∞ÂÜçÂä†ËΩΩÁöÑËøáÁ®ãÂ∞±ÊòØ‰∏ÄÊ¨°‰∏ä‰∏ãÊñáÂàáÊç¢</strong>„ÄÇ</p>
<p>‰∏ä‰∏ãÊñáÂàáÊç¢ÈÄöÂ∏∏ÊòØËÆ°ÁÆóÂØÜÈõÜÂûãÁöÑ„ÄÇ‰πüÂ∞±ÊòØËØ¥ÔºåÂÆÉÈúÄË¶ÅÁõ∏ÂΩìÂèØËßÇÁöÑÂ§ÑÁêÜÂô®Êó∂Èó¥ÔºåÂú®ÊØèÁßíÂá†ÂçÅ‰∏äÁôæÊ¨°ÁöÑÂàáÊç¢‰∏≠ÔºåÊØèÊ¨°ÂàáÊç¢ÈÉΩÈúÄË¶ÅÁ∫≥ÁßíÈáèÁ∫ßÁöÑÊó∂Èó¥„ÄÇÊâÄ‰ª•Ôºå‰∏ä‰∏ãÊñáÂàáÊç¢ÂØπÁ≥ªÁªüÊù•ËØ¥ÊÑèÂë≥ÁùÄÊ∂àËÄóÂ§ßÈáèÁöÑ CPU Êó∂Èó¥Ôºå‰∫ãÂÆû‰∏äÔºåÂèØËÉΩÊòØÊìç‰ΩúÁ≥ªÁªü‰∏≠Êó∂Èó¥Ê∂àËÄóÊúÄÂ§ßÁöÑÊìç‰Ωú„ÄÇ</p>
<p>Linux Áõ∏ÊØî‰∏éÂÖ∂‰ªñÊìç‰ΩúÁ≥ªÁªüÔºàÂåÖÊã¨ÂÖ∂‰ªñÁ±ª Unix Á≥ªÁªüÔºâÊúâÂæàÂ§öÁöÑ‰ºòÁÇπÔºåÂÖ∂‰∏≠Êúâ‰∏ÄÈ°πÂ∞±ÊòØÔºåÂÖ∂‰∏ä‰∏ãÊñáÂàáÊç¢ÂíåÊ®°ÂºèÂàáÊç¢ÁöÑÊó∂Èó¥Ê∂àËÄóÈùûÂ∏∏Â∞ë„ÄÇ</p>
<p>‰∏ä‰∏ãÊñáÂàáÊç¢Âπ∂‰∏çËÉΩÂÆåÂÖ®ÈÅøÂÖçÔºå‰ΩÜÊòØÂèØ‰ª•ÈÄöËøá‰∏ãÈù¢Âá†ÁßçÊñπÂºèÂáèÂ∞ë‰∏ä‰∏ãÊñáÂàáÊç¢Ôºö</p>
<ul>
<li>Êó†ÈîÅÂπ∂ÂèëÁºñÁ®ã - Â§öÁ∫øÁ®ãÁ´û‰∫âÈîÅÊó∂Ôºå‰ºöÂºïËµ∑‰∏ä‰∏ãÊñáÂàáÊç¢ÔºåÊâÄ‰ª•Â§öÁ∫øÁ®ãÂ§ÑÁêÜÊï∞ÊçÆÊó∂ÔºåÂèØ‰ª•Áî®‰∏Ä‰∫õÂäûÊ≥ïÊù•ÈÅøÂÖç‰ΩøÁî®ÈîÅÔºåÂ¶ÇÂ∞ÜÊï∞ÊçÆÁöÑ ID ÊåâÁÖß Hash ÁÆóÊ≥ïÂèñÊ®°ÂàÜÊÆµÔºå‰∏çÂêåÁöÑÁ∫øÁ®ãÂ§ÑÁêÜ‰∏çÂêåÊÆµÁöÑÊï∞ÊçÆ„ÄÇ</li>
<li>CAS ÁÆóÊ≥ï - Java ÁöÑ Atomic ÂåÖ‰ΩøÁî® CAS ÁÆóÊ≥ïÊù•Êõ¥Êñ∞Êï∞ÊçÆÔºåËÄå‰∏çÈúÄË¶ÅÂä†ÈîÅ„ÄÇ</li>
<li>‰ΩøÁî®ÊúÄÂ∞ëÁ∫øÁ®ã - ÈÅøÂÖçÂàõÂª∫‰∏çÈúÄË¶ÅÁöÑÁ∫øÁ®ãÔºåÊØîÂ¶Ç‰ªªÂä°ÂæàÂ∞ëÔºå‰ΩÜÊòØÂàõÂª∫‰∫ÜÂæàÂ§öÁ∫øÁ®ãÊù•Â§ÑÁêÜÔºåËøôÊ†∑‰ºöÈÄ†ÊàêÂ§ßÈáèÁ∫øÁ®ãÈÉΩÂ§Ñ‰∫éÁ≠âÂæÖÁä∂ÊÄÅ„ÄÇ</li>
<li>‰ΩøÁî®ÂçèÁ®ã - Âú®ÂçïÁ∫øÁ®ãÈáåÂÆûÁé∞Â§ö‰ªªÂä°ÁöÑË∞ÉÂ∫¶ÔºåÂπ∂Âú®ÂçïÁ∫øÁ®ãÈáåÁª¥ÊåÅÂ§ö‰∏™‰ªªÂä°Èó¥ÁöÑÂàáÊç¢„ÄÇ</li>
</ul>
<h2 id="‰ªÄ‰πàÊòØËµÑÊ∫êÈôêÂà∂"><a href="#‰ªÄ‰πàÊòØËµÑÊ∫êÈôêÂà∂" class="headerlink" title="‰ªÄ‰πàÊòØËµÑÊ∫êÈôêÂà∂"></a>‰ªÄ‰πàÊòØËµÑÊ∫êÈôêÂà∂</h2><p>ËµÑÊ∫êÈôêÂà∂ÊòØÊåáÂú®ËøõË°åÂπ∂ÂèëÁºñÁ®ãÊó∂ÔºåÁ®ãÂ∫èÁöÑÊâßË°åÈÄüÂ∫¶ÂèóÈôê‰∫éËÆ°ÁÆóÊú∫Á°¨‰ª∂ËµÑÊ∫êÊàñËΩØ‰ª∂ËµÑÊ∫ê„ÄÇ</p>
<p><strong>ËµÑÊ∫êÈôêÂà∂ÂºïÂèëÁöÑÈóÆÈ¢ò</strong></p>
<p>Âú®Âπ∂ÂèëÁºñÁ®ã‰∏≠ÔºåÂ∞Ü‰ª£Á†ÅÊâßË°åÈÄüÂ∫¶Âä†Âø´ÁöÑÂéüÂàôÊòØÂ∞Ü‰ª£Á†Å‰∏≠‰∏≤Ë°åÊâßË°åÁöÑÈÉ®ÂàÜÂèòÊàêÂπ∂ÂèëÊâßË°åÔºå‰ΩÜÊòØÂ¶ÇÊûúÂ∞ÜÊüêÊÆµ‰∏≤Ë°åÁöÑ‰ª£Á†ÅÂπ∂ÂèëÊâßË°åÔºåÂõ†‰∏∫ÂèóÈôê‰∫éËµÑÊ∫êÔºå‰ªçÁÑ∂Âú®‰∏≤Ë°åÊâßË°åÔºåËøôÊó∂ÂÄôÁ®ãÂ∫è‰∏ç‰ªÖ‰∏ç‰ºöÂä†Âø´ÊâßË°åÔºåÂèçËÄå‰ºöÊõ¥ÊÖ¢ÔºåÂõ†‰∏∫Â¢ûÂä†‰∫Ü‰∏ä‰∏ãÊñáÂàáÊç¢ÂíåËµÑÊ∫êË∞ÉÂ∫¶ÁöÑÊó∂Èó¥„ÄÇ</p>
<p><strong>Â¶Ç‰ΩïËß£ÂÜ≥ËµÑÊ∫êÈôêÂà∂ÁöÑÈóÆÈ¢ò</strong></p>
<p>Âú®ËµÑÊ∫êÈôêÂà∂ÊÉÖÂÜµ‰∏ãËøõË°åÂπ∂ÂèëÁºñÁ®ãÔºåÊ†πÊçÆ‰∏çÂêåÁöÑËµÑÊ∫êÈôêÂà∂Ë∞ÉÊï¥Á®ãÂ∫èÁöÑÂπ∂ÂèëÂ∫¶„ÄÇ</p>
<ul>
<li>ÂØπ‰∫éÁ°¨‰ª∂ËµÑÊ∫êÈôêÂà∂ÔºåÂèØ‰ª•ËÄÉËôë‰ΩøÁî®ÈõÜÁæ§Âπ∂Ë°åÊâßË°åÁ®ãÂ∫è„ÄÇ</li>
<li>ÂØπ‰∫éËΩØ‰ª∂ËµÑÊ∫êÈôêÂà∂ÔºåÂèØ‰ª•ËÄÉËôë‰ΩøÁî®ËµÑÊ∫êÊ±†Â∞ÜËµÑÊ∫êÂ§çÁî®„ÄÇ</li>
</ul>
<h2 id="‰ªÄ‰πàÊòØÁ∫øÁ®ãÊ≠ªÈîÅ-Â¶Ç‰ΩïÈÅøÂÖçÊ≠ªÈîÅ"><a href="#‰ªÄ‰πàÊòØÁ∫øÁ®ãÊ≠ªÈîÅ-Â¶Ç‰ΩïÈÅøÂÖçÊ≠ªÈîÅ" class="headerlink" title="‰ªÄ‰πàÊòØÁ∫øÁ®ãÊ≠ªÈîÅ? Â¶Ç‰ΩïÈÅøÂÖçÊ≠ªÈîÅ?"></a>‰ªÄ‰πàÊòØÁ∫øÁ®ãÊ≠ªÈîÅ? Â¶Ç‰ΩïÈÅøÂÖçÊ≠ªÈîÅ?</h2><p>Â§ö‰∏™Á∫øÁ®ã‰∫íÁõ∏Á≠âÂæÖÂØπÊñπÈáäÊîæÈîÅ„ÄÇÊ≠ªÈîÅÊòØÂΩìÁ∫øÁ®ãËøõÂÖ•Êó†ÈôêÊúüÁ≠âÂæÖÁä∂ÊÄÅÊó∂ÂèëÁîüÁöÑÊÉÖÂÜµÔºåÂõ†‰∏∫ÊâÄËØ∑Ê±ÇÁöÑÈîÅË¢´Âè¶‰∏Ä‰∏™Á∫øÁ®ãÊåÅÊúâÔºåËÄåÂè¶‰∏Ä‰∏™Á∫øÁ®ãÂèàÁ≠âÂæÖÁ¨¨‰∏Ä‰∏™Á∫øÁ®ãÊåÅÊúâÁöÑÂè¶‰∏Ä‰∏™ÈîÅ„ÄÇ</p>
<p>‰∫ßÁîüÊ≠ªÈîÅÂøÖÈ°ªÂÖ∑Â§á‰ª•‰∏ãÂõõ‰∏™Êù°‰ª∂Ôºö</p>
<ol>
<li>‰∫íÊñ•Êù°‰ª∂ÔºöËØ•ËµÑÊ∫ê‰ªªÊÑè‰∏Ä‰∏™Êó∂ÂàªÂè™Áî±‰∏Ä‰∏™Á∫øÁ®ãÂç†Áî®„ÄÇ</li>
<li>ËØ∑Ê±Ç‰∏é‰øùÊåÅÊù°‰ª∂Ôºö‰∏Ä‰∏™ËøõÁ®ãÂõ†ËØ∑Ê±ÇËµÑÊ∫êËÄåÈòªÂ°ûÊó∂ÔºåÂØπÂ∑≤Ëé∑ÂæóÁöÑËµÑÊ∫ê‰øùÊåÅ‰∏çÊîæ„ÄÇ</li>
<li>‰∏çÂâ•Â§∫Êù°‰ª∂:Á∫øÁ®ãÂ∑≤Ëé∑ÂæóÁöÑËµÑÊ∫êÂú®Êú™‰ΩøÁî®ÂÆå‰πãÂâç‰∏çËÉΩË¢´ÂÖ∂‰ªñÁ∫øÁ®ãÂº∫Ë°åÂâ•Â§∫ÔºåÂè™ÊúâËá™Â∑±‰ΩøÁî®ÂÆåÊØïÂêéÊâçÈáäÊîæËµÑÊ∫ê„ÄÇ</li>
<li>Âæ™ÁéØÁ≠âÂæÖÊù°‰ª∂:Ëã•Âπ≤ËøõÁ®ã‰πãÈó¥ÂΩ¢Êàê‰∏ÄÁßçÂ§¥Â∞æÁõ∏Êé•ÁöÑÂæ™ÁéØÁ≠âÂæÖËµÑÊ∫êÂÖ≥Á≥ª„ÄÇ</li>
</ol>
<p><img src="../img/java/9.png"></p>
<p><strong>Â¶Ç‰ΩïÈÅøÂÖçÊ≠ªÈîÅÔºü</strong></p>
<p>ÊåâÈ°∫Â∫èÂä†ÈîÅÔºöÊåâÁÖßÈ°∫Â∫èÂä†ÈîÅÊòØ‰∏ÄÁßçÊúâÊïàÁöÑÊ≠ªÈîÅÈ¢ÑÈò≤Êú∫Âà∂„ÄÇ‰ΩÜÊòØÔºåËøôÁßçÊñπÂºèÈúÄË¶Å‰Ω†‰∫ãÂÖàÁü•ÈÅìÊâÄÊúâÂèØËÉΩ‰ºöÁî®Âà∞ÁöÑÈîÅ(Âπ∂ÂØπËøô‰∫õÈîÅÂÅöÈÄÇÂΩìÁöÑÊéíÂ∫è)Ôºå‰ΩÜÊÄªÊúâ‰∫õÊó∂ÂÄôÊòØÊó†Ê≥ïÈ¢ÑÁü•ÁöÑ„ÄÇ</p>
<p>Ë∂ÖÊó∂ÈáäÊîæÈîÅÔºöËã•‰∏Ä‰∏™Á∫øÁ®ãÊ≤°ÊúâÂú®ÁªôÂÆöÁöÑÊó∂ÈôêÂÜÖÊàêÂäüËé∑ÂæóÊâÄÊúâÈúÄË¶ÅÁöÑÈîÅÔºåÂàô‰ºöËøõË°åÂõûÈÄÄÂπ∂ÈáäÊîæÊâÄÊúâÂ∑≤ÁªèËé∑ÂæóÁöÑÈîÅÔºåÁÑ∂ÂêéÁ≠âÂæÖ‰∏ÄÊÆµÈöèÊú∫ÁöÑÊó∂Èó¥ÂÜçÈáçËØï„ÄÇËøôÊÆµÈöèÊú∫ÁöÑÁ≠âÂæÖÊó∂Èó¥ËÆ©ÂÖ∂ÂÆÉÁ∫øÁ®ãÊúâÊú∫‰ºöÂ∞ùËØïËé∑ÂèñÁõ∏ÂêåÁöÑËøô‰∫õÈîÅÔºåÂπ∂‰∏îËÆ©ËØ•Â∫îÁî®Âú®Ê≤°ÊúâËé∑ÂæóÈîÅÁöÑÊó∂ÂÄôÂèØ‰ª•ÁªßÁª≠ËøêË°å(ËØëËÄÖÊ≥®ÔºöÂä†ÈîÅË∂ÖÊó∂ÂêéÂèØ‰ª•ÂÖàÁªßÁª≠ËøêË°åÂπ≤ÁÇπÂÖ∂ÂÆÉ‰∫ãÊÉÖÔºåÂÜçÂõûÂ§¥Êù•ÈáçÂ§ç‰πãÂâçÂä†ÈîÅÁöÑÈÄªËæë)„ÄÇ</p>
<p>Ê≠ªÈîÅÊ£ÄÊµãÔºöÊ≠ªÈîÅÊ£ÄÊµãÊòØ‰∏Ä‰∏™Êõ¥Â•ΩÁöÑÊ≠ªÈîÅÈ¢ÑÈò≤Êú∫Âà∂ÔºåÂÆÉ‰∏ªË¶ÅÊòØÈíàÂØπÈÇ£‰∫õ‰∏çÂèØËÉΩÂÆûÁé∞ÊåâÂ∫èÂä†ÈîÅÂπ∂‰∏îÈîÅË∂ÖÊó∂‰πü‰∏çÂèØË°åÁöÑÂú∫ÊôØ„ÄÇÊØèÂΩì‰∏Ä‰∏™Á∫øÁ®ãËé∑Âæó‰∫ÜÈîÅÔºå‰ºöÂú®Á∫øÁ®ãÂíåÈîÅÁõ∏ÂÖ≥ÁöÑÊï∞ÊçÆÁªìÊûÑ‰∏≠Ôºàmap„ÄÅgraph Á≠âÁ≠âÔºâÂ∞ÜÂÖ∂ËÆ∞‰∏ã„ÄÇÈô§Ê≠§‰πãÂ§ñÔºåÊØèÂΩìÊúâÁ∫øÁ®ãËØ∑Ê±ÇÈîÅÔºå‰πüÈúÄË¶ÅËÆ∞ÂΩïÂú®Ëøô‰∏™Êï∞ÊçÆÁªìÊûÑ‰∏≠„ÄÇÂΩì‰∏Ä‰∏™Á∫øÁ®ãËØ∑Ê±ÇÈîÅÂ§±Ë¥•Êó∂ÔºåËøô‰∏™Á∫øÁ®ãÂèØ‰ª•ÈÅçÂéÜÈîÅÁöÑÂÖ≥Á≥ªÂõæÁúãÁúãÊòØÂê¶ÊúâÊ≠ªÈîÅÂèëÁîü„ÄÇ</p>
<p>Â¶ÇÊûúÊ£ÄÊµãÂá∫Ê≠ªÈîÅÔºåÊúâ‰∏§ÁßçÂ§ÑÁêÜÊâãÊÆµÔºö</p>
<p>ÈáäÊîæÊâÄÊúâÈîÅÔºåÂõûÈÄÄÔºåÂπ∂‰∏îÁ≠âÂæÖ‰∏ÄÊÆµÈöèÊú∫ÁöÑÊó∂Èó¥ÂêéÈáçËØï„ÄÇËøô‰∏™ÂíåÁÆÄÂçïÁöÑÂä†ÈîÅË∂ÖÊó∂Á±ª‰ººÔºå‰∏ç‰∏ÄÊ†∑ÁöÑÊòØÂè™ÊúâÊ≠ªÈîÅÂ∑≤ÁªèÂèëÁîü‰∫ÜÊâçÂõûÈÄÄÔºåËÄå‰∏ç‰ºöÊòØÂõ†‰∏∫Âä†ÈîÅÁöÑËØ∑Ê±ÇË∂ÖÊó∂‰∫Ü„ÄÇËôΩÁÑ∂ÊúâÂõûÈÄÄÂíåÁ≠âÂæÖÔºå‰ΩÜÊòØÂ¶ÇÊûúÊúâÂ§ßÈáèÁöÑÁ∫øÁ®ãÁ´û‰∫âÂêå‰∏ÄÊâπÈîÅÔºåÂÆÉ‰ª¨ËøòÊòØ‰ºöÈáçÂ§çÂú∞Ê≠ªÈîÅÔºàÁºñËÄÖÊ≥®ÔºöÂéüÂõ†ÂêåË∂ÖÊó∂Á±ª‰ººÔºå‰∏çËÉΩ‰ªéÊ†πÊú¨‰∏äÂáèËΩªÁ´û‰∫âÔºâ„ÄÇ</p>
<p>‰∏Ä‰∏™Êõ¥Â•ΩÁöÑÊñπÊ°àÊòØÁªôËøô‰∫õÁ∫øÁ®ãËÆæÁΩÆ‰ºòÂÖàÁ∫ßÔºåËÆ©‰∏Ä‰∏™ÔºàÊàñÂá†‰∏™ÔºâÁ∫øÁ®ãÂõûÈÄÄÔºåÂâ©‰∏ãÁöÑÁ∫øÁ®ãÂ∞±ÂÉèÊ≤°ÂèëÁîüÊ≠ªÈîÅ‰∏ÄÊ†∑ÁªßÁª≠‰øùÊåÅÁùÄÂÆÉ‰ª¨ÈúÄË¶ÅÁöÑÈîÅ„ÄÇÂ¶ÇÊûúËµã‰∫àËøô‰∫õÁ∫øÁ®ãÁöÑ‰ºòÂÖàÁ∫ßÊòØÂõ∫ÂÆö‰∏çÂèòÁöÑÔºåÂêå‰∏ÄÊâπÁ∫øÁ®ãÊÄªÊòØ‰ºöÊã•ÊúâÊõ¥È´òÁöÑ‰ºòÂÖàÁ∫ß„ÄÇ‰∏∫ÈÅøÂÖçËøô‰∏™ÈóÆÈ¢òÔºåÂèØ‰ª•Âú®Ê≠ªÈîÅÂèëÁîüÁöÑÊó∂ÂÄôËÆæÁΩÆÈöèÊú∫ÁöÑ‰ºòÂÖàÁ∫ß„ÄÇ</p>
<blockquote>
<ol>
<li><strong>Á†¥Âùè‰∫íÊñ•Êù°‰ª∂</strong> ÔºöËøô‰∏™Êù°‰ª∂Êàë‰ª¨Ê≤°ÊúâÂäûÊ≥ïÁ†¥ÂùèÔºåÂõ†‰∏∫Êàë‰ª¨Áî®ÈîÅÊú¨Êù•Â∞±ÊòØÊÉ≥ËÆ©‰ªñ‰ª¨‰∫íÊñ•ÁöÑÔºà‰∏¥ÁïåËµÑÊ∫êÈúÄË¶Å‰∫íÊñ•ËÆøÈóÆÔºâ„ÄÇ</li>
<li><strong>Á†¥ÂùèËØ∑Ê±Ç‰∏é‰øùÊåÅÊù°‰ª∂</strong> Ôºö‰∏ÄÊ¨°ÊÄßÁî≥ËØ∑ÊâÄÊúâÁöÑËµÑÊ∫ê„ÄÇ</li>
<li><strong>Á†¥Âùè‰∏çÂâ•Â§∫Êù°‰ª∂</strong> ÔºöÂç†Áî®ÈÉ®ÂàÜËµÑÊ∫êÁöÑÁ∫øÁ®ãËøõ‰∏ÄÊ≠•Áî≥ËØ∑ÂÖ∂‰ªñËµÑÊ∫êÊó∂ÔºåÂ¶ÇÊûúÁî≥ËØ∑‰∏çÂà∞ÔºåÂèØ‰ª•‰∏ªÂä®ÈáäÊîæÂÆÉÂç†ÊúâÁöÑËµÑÊ∫ê„ÄÇ</li>
<li><strong>Á†¥ÂùèÂæ™ÁéØÁ≠âÂæÖÊù°‰ª∂</strong> ÔºöÈù†ÊåâÂ∫èÁî≥ËØ∑ËµÑÊ∫êÊù•È¢ÑÈò≤„ÄÇÊåâÊüê‰∏ÄÈ°∫Â∫èÁî≥ËØ∑ËµÑÊ∫êÔºåÈáäÊîæËµÑÊ∫êÂàôÂèçÂ∫èÈáäÊîæ„ÄÇÁ†¥ÂùèÂæ™ÁéØÁ≠âÂæÖÊù°‰ª∂„ÄÇ</li>
</ol>
</blockquote>
<h2 id="Ê¥ªÈîÅ"><a href="#Ê¥ªÈîÅ" class="headerlink" title="Ê¥ªÈîÅ"></a>Ê¥ªÈîÅ</h2><p>Ê¥ªÈîÅÊòØ‰∏Ä‰∏™ÈÄíÂΩíÁöÑÊÉÖÂÜµÔºå‰∏§‰∏™ÊàñÊõ¥Â§öÁöÑÁ∫øÁ®ã‰ºö‰∏çÊñ≠ÈáçÂ§ç‰∏Ä‰∏™ÁâπÂÆöÁöÑ‰ª£Á†ÅÈÄªËæë„ÄÇÈ¢ÑÊúüÁöÑÈÄªËæëÈÄöÂ∏∏‰∏∫ÂÖ∂‰ªñÁ∫øÁ®ãÊèê‰æõÊú∫‰ºöÁªßÁª≠ÊîØÊåÅ‚Äôthis‚ÄôÁ∫øÁ®ã„ÄÇ</p>
<p>ÊÉ≥Ë±°ËøôÊ†∑‰∏Ä‰∏™‰æãÂ≠êÔºö‰∏§‰∏™‰∫∫Âú®Áã≠Á™ÑÁöÑËµ∞ÂªäÈáåÁõ∏ÈÅáÔºå‰∫åËÄÖÈÉΩÂæàÁ§ºË≤åÔºåËØïÂõæÁßªÂà∞ÊóÅËæπËÆ©ÂØπÊñπÂÖàÈÄöËøá„ÄÇ‰ΩÜÊòØ‰ªñ‰ª¨ÊúÄÁªàÂú®Ê≤°ÊúâÂèñÂæó‰ªª‰ΩïËøõÂ±ïÁöÑÊÉÖÂÜµ‰∏ãÂ∑¶Âè≥ÊëáÊëÜÔºåÂõ†‰∏∫‰ªñ‰ª¨ÈÉΩÂú®Âêå‰∏ÄÊó∂Èó¥ÂêëÁõ∏ÂêåÁöÑÊñπÂêëÁßªÂä®„ÄÇ</p>
<p><strong>ÈÅøÂÖçÊ¥ªÈîÅ</strong></p>
<p>Ëß£ÂÜ≥‚ÄúÊ¥ªÈîÅ‚ÄùÁöÑÊñπÊ°àÂæàÁÆÄÂçïÔºåË∞¶ËÆ©Êó∂ÔºåÂ∞ùËØïÁ≠âÂæÖ‰∏Ä‰∏™ÈöèÊú∫ÁöÑÊó∂Èó¥Â∞±ÂèØ‰ª•‰∫Ü„ÄÇÁî±‰∫éÁ≠âÂæÖÁöÑÊó∂Èó¥ÊòØÈöèÊú∫ÁöÑÔºåÊâÄ‰ª•ÂêåÊó∂Áõ∏ÊíûÂêéÂÜçÊ¨°Áõ∏ÊíûÁöÑÊ¶ÇÁéáÂ∞±Âæà‰Ωé‰∫Ü„ÄÇ‚ÄúÁ≠âÂæÖ‰∏Ä‰∏™ÈöèÊú∫Êó∂Èó¥‚ÄùÁöÑÊñπÊ°àËôΩÁÑ∂ÂæàÁÆÄÂçïÔºåÂç¥ÈùûÂ∏∏ÊúâÊïàÔºåRaft ËøôÊ†∑Áü•ÂêçÁöÑÂàÜÂ∏ÉÂºè‰∏ÄËá¥ÊÄßÁÆóÊ≥ï‰∏≠‰πüÁî®Âà∞‰∫ÜÂÆÉ„ÄÇ</p>
<h2 id="‰ªÄ‰πàÊòØÈ••È•ø"><a href="#‰ªÄ‰πàÊòØÈ••È•ø" class="headerlink" title="‰ªÄ‰πàÊòØÈ••È•ø"></a>‰ªÄ‰πàÊòØÈ••È•ø</h2><ul>
<li>È´ò‰ºòÂÖàÁ∫ßÁ∫øÁ®ãÂêûÂô¨ÊâÄÊúâÁöÑ‰Ωé‰ºòÂÖàÁ∫ßÁ∫øÁ®ãÁöÑ CPU Êó∂Èó¥„ÄÇ</li>
<li>Á∫øÁ®ãË¢´Ê∞∏‰πÖÂ†µÂ°ûÂú®‰∏Ä‰∏™Á≠âÂæÖËøõÂÖ•ÂêåÊ≠•ÂùóÁöÑÁä∂ÊÄÅÔºåÂõ†‰∏∫ÂÖ∂‰ªñÁ∫øÁ®ãÊÄªÊòØËÉΩÂú®ÂÆÉ‰πãÂâçÊåÅÁª≠Âú∞ÂØπËØ•ÂêåÊ≠•ÂùóËøõË°åËÆøÈóÆ„ÄÇ</li>
<li>Á∫øÁ®ãÂú®Á≠âÂæÖ‰∏Ä‰∏™Êú¨Ë∫´(Âú®ÂÖ∂‰∏äË∞ÉÁî® wait())‰πüÂ§Ñ‰∫éÊ∞∏‰πÖÁ≠âÂæÖÂÆåÊàêÁöÑÂØπË±°ÔºåÂõ†‰∏∫ÂÖ∂‰ªñÁ∫øÁ®ãÊÄªÊòØË¢´ÊåÅÁª≠Âú∞Ëé∑ÂæóÂî§ÈÜí„ÄÇ</li>
</ul>
<p><strong>Ëß£ÂÜ≥È••È•ø</strong></p>
<p>Java ‰∏çÂèØËÉΩÂÆûÁé∞ 100% ÁöÑÂÖ¨Âπ≥ÊÄßÔºåÊàë‰ª¨‰æùÁÑ∂ÂèØ‰ª•ÈÄöËøáÂêåÊ≠•ÁªìÊûÑÂú®Á∫øÁ®ãÈó¥ÂÆûÁé∞ÂÖ¨Âπ≥ÊÄßÁöÑÊèêÈ´ò„ÄÇ</p>
<p>Êúâ‰∏âÁßçÊñπÊ°àÔºö</p>
<ul>
<li>‰øùËØÅËµÑÊ∫êÂÖÖË∂≥</li>
<li>ÂÖ¨Âπ≥Âú∞ÂàÜÈÖçËµÑÊ∫ê</li>
<li>ÈÅøÂÖçÊåÅÊúâÈîÅÁöÑÁ∫øÁ®ãÈïøÊó∂Èó¥ÊâßË°å</li>
</ul>
<p>Ëøô‰∏â‰∏™ÊñπÊ°à‰∏≠ÔºåÊñπÊ°à‰∏ÄÂíåÊñπÊ°à‰∏âÁöÑÈÄÇÁî®Âú∫ÊôØÊØîËæÉÊúâÈôêÔºåÂõ†‰∏∫ÂæàÂ§öÂú∫ÊôØ‰∏ãÔºåËµÑÊ∫êÁöÑÁ®ÄÁº∫ÊÄßÊòØÊ≤°ÂäûÊ≥ïËß£ÂÜ≥ÁöÑÔºåÊåÅÊúâÈîÅÁöÑÁ∫øÁ®ãÊâßË°åÁöÑÊó∂Èó¥‰πüÂæàÈöæÁº©Áü≠„ÄÇÂÄíÊòØÊñπÊ°à‰∫åÁöÑÈÄÇÁî®Âú∫ÊôØÁõ∏ÂØπÊù•ËØ¥Êõ¥Â§ö‰∏Ä‰∫õ„ÄÇ</p>
<p>ÈÇ£Â¶Ç‰ΩïÂÖ¨Âπ≥Âú∞ÂàÜÈÖçËµÑÊ∫êÂë¢ÔºüÂú®Âπ∂ÂèëÁºñÁ®ãÈáåÔºå‰∏ªË¶ÅÊòØ‰ΩøÁî®ÂÖ¨Âπ≥ÈîÅ„ÄÇÊâÄË∞ìÂÖ¨Âπ≥ÈîÅÔºåÊòØ‰∏ÄÁßçÂÖàÊù•ÂêéÂà∞ÁöÑÊñπÊ°àÔºåÁ∫øÁ®ãÁöÑÁ≠âÂæÖÊòØÊúâÈ°∫Â∫èÁöÑÔºåÊéíÂú®Á≠âÂæÖÈòüÂàóÂâçÈù¢ÁöÑÁ∫øÁ®ã‰ºö‰ºòÂÖàËé∑ÂæóËµÑÊ∫ê„ÄÇ</p>
<h2 id="Âπ∂ÂèëÂíåÂπ∂Ë°å"><a href="#Âπ∂ÂèëÂíåÂπ∂Ë°å" class="headerlink" title="Âπ∂ÂèëÂíåÂπ∂Ë°å"></a>Âπ∂ÂèëÂíåÂπ∂Ë°å</h2><ul>
<li>Âπ∂ÂèëÔºö‰∏ÄÊÆµÊó∂Èó¥ÂÜÖÂèØ‰ª•ÊâßË°åÂ§ö‰∏™‰ªªÂä°Ôºå‰ΩÜ‰∏ç‰∏ÄÂÆöË¶ÅÂêåÊó∂ÊâßË°åÔºàÊã•ÊúâÂ§ÑÁêÜËøá‰∏™‰ªªÂä°ÁöÑËÉΩÂäõÔºå‰∏ç‰∏ÄÂÆöÂêåÊó∂Ôºâ</li>
<li>Âπ∂Ë°åÔºöÂêåÊó∂Â§ÑÁêÜÂ§ö‰∏™‰ªªÂä°ÔºàÊã•ÊúâÂêåÊó∂Â§ÑÁêÜÂ§ö‰∏™‰ªªÂä°ÁöÑËÉΩÂäõÔºâ</li>
</ul>
<p>ÂÖ≥ÈîÆÔºö Âπ∂ÂèëÂíåÂπ∂Ë°åÈÉΩÂèØ‰ª•Â§ÑÁêÜÂ§ö‰∏™‰ªªÂä°ÔºåÂÖ≥ÈîÆÁÇπÊòØÔºöÊòØÂê¶ÂêåÊó∂</p>
<h2 id="ÂêåÊ≠•ÂíåÂºÇÊ≠•"><a href="#ÂêåÊ≠•ÂíåÂºÇÊ≠•" class="headerlink" title="ÂêåÊ≠•ÂíåÂºÇÊ≠•"></a>ÂêåÊ≠•ÂíåÂºÇÊ≠•</h2><p>ÂêåÊ≠•ÔºöÊâÄË∞ìÂêåÊ≠•ÔºåÂ∞±ÊòØÂú®ÂèëËµ∑‰∏ÄÊ¨°Ë∞ÉÁî®Êó∂ÔºåÂú®Ê≤°ÊúâÂæóÂà∞ÁªìÊûú‰πãÂâçÔºåËØ•Ë∞ÉÁî®Â∞±‰∏çËøîÂõû„ÄÇ‰ΩÜÊòØ‰∏ÄÊó¶Ë∞ÉÁî®ËøîÂõûÔºåÂ∞±Ë¶ÅÂæóÂà∞ËøîÂõûÂÄº„ÄÇ</p>
<p>ÂºÇÊ≠•ÔºöÂºÇÊ≠•ÂàôÊÅ∞ÊÅ∞Áõ∏ÂèçÔºåË∞ÉÁî®ÂèëÂá∫‰πãÂêéÔºåËøôÊ¨°Ë∞ÉÁî®Â∞±Áõ¥Êé•ËøîÂõû‰∫Ü„ÄÇÊâÄ‰ª•Ê≤°ÊúâËøîÂõûÂÄº„ÄÇÊç¢Âè•ËØùËØ¥ÔºåÂΩì‰∏Ä‰∏™ÂºÇÊ≠•ËøáÁ®ãË∞ÉÁî®ÂèëÂá∫ÂêéÔºåË∞ÉÁî®ËÄÖ‰∏ç‰ºöÁ´ãÂàªÂæóÂà∞ÁªìÊûú„ÄÇËÄåÊòØÂú®Ë∞ÉÁî®ÂèëÂá∫ÂêéÔºåË¢´Ë∞ÉÁî®ËÄÖÈÄöËøáÁä∂ÊÄÅ„ÄÅÈÄöÁü•Êù•ÈÄöÁü•Ë∞ÉÁî®ËÄÖÔºåÊàñÈÄöËøáÂõûË∞ÉÂáΩÊï∞Â§ÑÁêÜËøô‰∏™Ë∞ÉÁî®„ÄÇ</p>
<h2 id="ÈòªÂ°ûÂíåÈùûÈòªÂ°û"><a href="#ÈòªÂ°ûÂíåÈùûÈòªÂ°û" class="headerlink" title="ÈòªÂ°ûÂíåÈùûÈòªÂ°û"></a>ÈòªÂ°ûÂíåÈùûÈòªÂ°û</h2><p>ÈòªÂ°ûÂíåÈùûÈòªÂ°ûÂÖ≥Ê≥®ÁöÑÊòØÁ®ãÂ∫èÂú®Á≠âÂæÖË∞ÉÁî®ÁªìÊûúÔºàÊ∂àÊÅØÔºåËøîÂõûÂÄºÔºâÊó∂ÁöÑÁä∂ÊÄÅ.</p>
<p>ÈòªÂ°ûË∞ÉÁî®ÊòØÊåáË∞ÉÁî®ÁªìÊûúËøîÂõû‰πãÂâçÔºåÂΩìÂâçÁ∫øÁ®ã‰ºöË¢´ÊåÇËµ∑„ÄÇË∞ÉÁî®Á∫øÁ®ãÂè™ÊúâÂú®ÂæóÂà∞ÁªìÊûú‰πãÂêéÊâç‰ºöËøîÂõû„ÄÇ</p>
<p>ÈùûÈòªÂ°ûË∞ÉÁî®ÊåáÂú®‰∏çËÉΩÁ´ãÂàªÂæóÂà∞ÁªìÊûú‰πãÂâçÔºåËØ•Ë∞ÉÁî®‰∏ç‰ºöÈòªÂ°ûÂΩìÂâçÁ∫øÁ®ã„ÄÇ</p>
<h2 id="Á´ûÊÄÅÊù°‰ª∂Âíå‰∏¥ÁïåÂå∫"><a href="#Á´ûÊÄÅÊù°‰ª∂Âíå‰∏¥ÁïåÂå∫" class="headerlink" title="Á´ûÊÄÅÊù°‰ª∂Âíå‰∏¥ÁïåÂå∫"></a>Á´ûÊÄÅÊù°‰ª∂Âíå‰∏¥ÁïåÂå∫</h2><p>Á´ûÊÄÅÊù°‰ª∂ÔºàRace ConditionÔºâÔºöÂΩì‰∏§‰∏™Á∫øÁ®ãÁ´û‰∫âÂêå‰∏ÄËµÑÊ∫êÊó∂ÔºåÂ¶ÇÊûúÂØπËµÑÊ∫êÁöÑËÆøÈóÆÈ°∫Â∫èÊïèÊÑüÔºåÂ∞±Áß∞Â≠òÂú®Á´ûÊÄÅÊù°‰ª∂„ÄÇ</p>
<p>‰∏¥ÁïåÂå∫ÔºàCritical SectionsÔºâÔºöÂØºËá¥Á´ûÊÄÅÊù°‰ª∂ÂèëÁîüÁöÑ‰ª£Á†ÅÂå∫Áß∞‰Ωú‰∏¥ÁïåÂå∫„ÄÇ</p>
<h2 id="ÁÆ°Á®ã"><a href="#ÁÆ°Á®ã" class="headerlink" title="ÁÆ°Á®ã"></a>ÁÆ°Á®ã</h2><p>ÁÆ°Á®ãÔºåÂØπÂ∫îÁöÑËã±ÊñáÊòØ MonitorÔºåÂæàÂ§ö Java È¢ÜÂüüÁöÑÂêåÂ≠¶ÈÉΩÂñúÊ¨¢Â∞ÜÂÖ∂ÁøªËØëÊàê‚ÄúÁõëËßÜÂô®‚ÄùÔºåËøôÊòØÁõ¥ËØë„ÄÇÊìç‰ΩúÁ≥ªÁªüÈ¢ÜÂüü‰∏ÄËà¨ÈÉΩÁøªËØëÊàê‚ÄúÁÆ°Á®ã‚ÄùÔºåËøô‰∏™ÊòØÊÑèËØëÔºåËÄåÊàëËá™Â∑±‰πüÊõ¥ÂÄæÂêë‰∫é‰ΩøÁî®‚ÄúÁÆ°Á®ã‚Äù„ÄÇ</p>
<p>ÊâÄË∞ìÁÆ°Á®ãÔºåÊåáÁöÑÊòØÁÆ°ÁêÜÂÖ±‰∫´ÂèòÈáè‰ª•ÂèäÂØπÂÖ±‰∫´ÂèòÈáèÁöÑÊìç‰ΩúËøáÁ®ãÔºåËÆ©‰ªñ‰ª¨ÊîØÊåÅÂπ∂Âèë„ÄÇÁøªËØë‰∏∫ Java È¢ÜÂüüÁöÑËØ≠Ë®ÄÔºåÂ∞±ÊòØÁÆ°ÁêÜÁ±ªÁöÑÊàêÂëòÂèòÈáèÂíåÊàêÂëòÊñπÊ≥ïÔºåËÆ©Ëøô‰∏™Á±ªÊòØÁ∫øÁ®ãÂÆâÂÖ®ÁöÑ„ÄÇ</p>
<p>Java ÈááÁî®ÁöÑÊòØÁÆ°Á®ãÊäÄÊúØÔºåsynchronized ÂÖ≥ÈîÆÂ≠óÂèä wait()„ÄÅnotify()„ÄÅnotifyAll() Ëøô‰∏â‰∏™ÊñπÊ≥ïÈÉΩÊòØÁÆ°Á®ãÁöÑÁªÑÊàêÈÉ®ÂàÜ„ÄÇËÄåÁÆ°Á®ãÂíå‰ø°Âè∑ÈáèÊòØÁ≠â‰ª∑ÁöÑÔºåÊâÄË∞ìÁ≠â‰ª∑ÊåáÁöÑÊòØÁî®ÁÆ°Á®ãËÉΩÂ§üÂÆûÁé∞‰ø°Âè∑ÈáèÔºå‰πüËÉΩÁî®‰ø°Âè∑ÈáèÂÆûÁé∞ÁÆ°Á®ã„ÄÇ</p>
<h2 id="‰øùËØÅÂπ∂ÂèëÂÆâÂÖ®ÁöÑÊÄùË∑Ø"><a href="#‰øùËØÅÂπ∂ÂèëÂÆâÂÖ®ÁöÑÊÄùË∑Ø" class="headerlink" title="‰øùËØÅÂπ∂ÂèëÂÆâÂÖ®ÁöÑÊÄùË∑Ø"></a>‰øùËØÅÂπ∂ÂèëÂÆâÂÖ®ÁöÑÊÄùË∑Ø</h2><p><strong>‰∫íÊñ•ÂêåÊ≠•ÔºàÈòªÂ°ûÂêåÊ≠•Ôºâ</strong></p>
<p>ÂêåÊ≠•ÊòØÊåáÂ§öÁ∫øÁ®ãÂπ∂ÂèëËÆøÈóÆÂÖ±‰∫´ËµÑÊ∫êÊó∂Ôºå‰øùËØÅÂÖ±‰∫´Êï∞ÊçÆÂêå‰∏ÄÊó∂ÂàªÂè™ËÉΩË¢´‰∏Ä‰∏™Á∫øÁ®ãËÆøÈóÆ„ÄÇ‰∫íÊñ•ÊòØÂÆûÁé∞ÂêåÊ≠•ÁöÑ‰∏ÄÁßçÊâãÊÆµ„ÄÇ‰∏¥ÁïåÂå∫ÔºàCritical SectionsÔºâ„ÄÅ‰∫íÊñ•ÈáèÔºàMutexÔºâÂíå‰ø°Âè∑ÈáèÔºàSemaphoreÔºâÈÉΩÊòØ‰∏ªË¶ÅÁöÑ‰∫íÊñ•ÂÆûÁé∞ÊñπÂºè„ÄÇÊúÄÂÖ∏ÂûãÁöÑÊ°à‰æãÊòØ‰ΩøÁî® synchronized Êàñ Lock „ÄÇ<br>‰∫íÊñ•ÂêåÊ≠•ÊúÄ‰∏ªË¶ÅÁöÑÈóÆÈ¢òÊòØÁ∫øÁ®ãÈòªÂ°ûÂíåÂî§ÈÜíÊâÄÂ∏¶Êù•ÁöÑÊÄßËÉΩÈóÆÈ¢òÔºå‰∫íÊñ•ÂêåÊ≠•Â±û‰∫é‰∏ÄÁßçÊÇ≤ËßÇÁöÑÂπ∂ÂèëÁ≠ñÁï•ÔºåÊÄªÊòØËÆ§‰∏∫Âè™Ë¶Å‰∏çÂéªÂÅöÊ≠£Á°ÆÁöÑÂêåÊ≠•Êé™ÊñΩÔºåÈÇ£Â∞±ËÇØÂÆö‰ºöÂá∫Áé∞ÈóÆÈ¢ò„ÄÇÊó†ËÆ∫ÂÖ±‰∫´Êï∞ÊçÆÊòØÂê¶ÁúüÁöÑ‰ºöÂá∫Áé∞Á´û‰∫âÔºåÂÆÉÈÉΩË¶ÅËøõË°åÂä†ÈîÅ„ÄÅÁî®Êà∑ÊÄÅÊ†∏ÂøÉÊÄÅËΩ¨Êç¢„ÄÅÁª¥Êä§ÈîÅËÆ°Êï∞Âô®ÂíåÊ£ÄÊü•ÊòØÂê¶ÊúâË¢´ÈòªÂ°ûÁöÑÁ∫øÁ®ãÈúÄË¶ÅÂî§ÈÜíÁ≠âÊìç‰Ωú„ÄÇ</p>
<p><strong>ÈùûÈòªÂ°ûÂêåÊ≠•</strong></p>
<p>ÈöèÁùÄÁ°¨‰ª∂Êåá‰ª§ÈõÜÁöÑÂèëÂ±ïÔºåÊàë‰ª¨ÂèØ‰ª•‰ΩøÁî®Âü∫‰∫éÂÜ≤Á™ÅÊ£ÄÊµãÁöÑ‰πêËßÇÂπ∂ÂèëÁ≠ñÁï•ÔºöÂÖàËøõË°åÊìç‰ΩúÔºåÂ¶ÇÊûúÊ≤°ÊúâÂÖ∂ÂÆÉÁ∫øÁ®ã‰∫âÁî®ÂÖ±‰∫´Êï∞ÊçÆÔºåÈÇ£Êìç‰ΩúÂ∞±ÊàêÂäü‰∫ÜÔºåÂê¶ÂàôÈááÂèñË°•ÂÅøÊé™ÊñΩÔºà‰∏çÊñ≠Âú∞ÈáçËØïÔºåÁõ¥Âà∞ÊàêÂäü‰∏∫Ê≠¢Ôºâ„ÄÇËøôÁßç‰πêËßÇÁöÑÂπ∂ÂèëÁ≠ñÁï•ÁöÑËÆ∏Â§öÂÆûÁé∞ÈÉΩ‰∏çÈúÄË¶ÅÂ∞ÜÁ∫øÁ®ãÈòªÂ°ûÔºåÂõ†Ê≠§ËøôÁßçÂêåÊ≠•Êìç‰ΩúÁß∞‰∏∫ÈùûÈòªÂ°ûÂêåÊ≠•„ÄÇ</p>
<p>‰∏∫‰ªÄ‰πàËØ¥‰πêËßÇÈîÅÈúÄË¶Å <strong>Á°¨‰ª∂Êåá‰ª§ÈõÜÁöÑÂèëÂ±ï</strong> ÊâçËÉΩËøõË°åÔºü</p>
<p>Âõ†‰∏∫ÈúÄË¶ÅÊìç‰ΩúÂíåÂÜ≤Á™ÅÊ£ÄÊµãËøô‰∏§‰∏™Ê≠•È™§ÂÖ∑Â§áÂéüÂ≠êÊÄß„ÄÇËÄåËøôÁÇπÊòØÁî±Á°¨‰ª∂Êù•ÂÆåÊàêÔºåÂ¶ÇÊûúÂÜç‰ΩøÁî®‰∫íÊñ•ÂêåÊ≠•Êù•‰øùËØÅÂ∞±Â§±ÂéªÊÑè‰πâ‰∫Ü„ÄÇ</p>
<p>Java ÂÖ∏ÂûãÂ∫îÁî®Âú∫ÊôØÔºöJ.U.C ÂåÖ‰∏≠ÁöÑÂéüÂ≠êÁ±ªÔºàÂü∫‰∫é Unsafe Á±ªÁöÑ CAS Êìç‰ΩúÔºâ</p>
<p>Ë¶Å‰øùËØÅÁ∫øÁ®ãÂÆâÂÖ®Ôºå‰∏ç‰∏ÄÂÆöÈùûË¶ÅËøõË°åÂêåÊ≠•„ÄÇÂêåÊ≠•Âè™ÊòØ‰øùËØÅÂÖ±‰∫´Êï∞ÊçÆ‰∫âÁî®Êó∂ÁöÑÊ≠£Á°ÆÊÄßÔºåÂ¶ÇÊûú‰∏Ä‰∏™ÊñπÊ≥ïÊú¨Êù•Â∞±‰∏çÊ∂âÂèäÂÖ±‰∫´Êï∞ÊçÆÔºåÈÇ£‰πàËá™ÁÑ∂Êó†È°ªÂêåÊ≠•„ÄÇ</p>
<p>Java ‰∏≠ÁöÑ Êó†ÂêåÊ≠•ÊñπÊ°à ÊúâÔºö</p>
<ul>
<li>ÂèØÈáçÂÖ•‰ª£Á†Å - ‰πüÂè´Á∫Ø‰ª£Á†Å„ÄÇÂ¶ÇÊûú‰∏Ä‰∏™ÊñπÊ≥ïÔºåÂÆÉÁöÑ ËøîÂõûÁªìÊûúÊòØÂèØ‰ª•È¢ÑÊµãÁöÑÔºåÂç≥Âè™Ë¶ÅËæìÂÖ•‰∫ÜÁõ∏ÂêåÁöÑÊï∞ÊçÆÔºåÂ∞±ËÉΩËøîÂõûÁõ∏ÂêåÁöÑÁªìÊûúÔºåÈÇ£ÂÆÉÂ∞±Êª°Ë∂≥ÂèØÈáçÂÖ•ÊÄßÔºåÂΩìÁÑ∂‰πüÊòØÁ∫øÁ®ãÂÆâÂÖ®ÁöÑ„ÄÇ</li>
<li>Á∫øÁ®ãÊú¨Âú∞Â≠òÂÇ® - ‰ΩøÁî® ThreadLocal ‰∏∫ÂÖ±‰∫´ÂèòÈáèÂú®ÊØè‰∏™Á∫øÁ®ã‰∏≠ÈÉΩÂàõÂª∫‰∫Ü‰∏Ä‰∏™Êú¨Âú∞ÂâØÊú¨ÔºåËøô‰∏™ÂâØÊú¨Âè™ËÉΩË¢´ÂΩìÂâçÁ∫øÁ®ãËÆøÈóÆÔºåÂÖ∂‰ªñÁ∫øÁ®ãÊó†Ê≥ïËÆøÈóÆÔºåÈÇ£‰πàËá™ÁÑ∂ÊòØÁ∫øÁ®ãÂÆâÂÖ®ÁöÑ„ÄÇ</li>
</ul>
<ul>
<li></li>
</ul>
<h2 id="ÂàõÂª∫Á∫øÁ®ãÊúâÂì™‰∫õÊñπÂºè"><a href="#ÂàõÂª∫Á∫øÁ®ãÊúâÂì™‰∫õÊñπÂºè" class="headerlink" title="ÂàõÂª∫Á∫øÁ®ãÊúâÂì™‰∫õÊñπÂºè"></a>ÂàõÂª∫Á∫øÁ®ãÊúâÂì™‰∫õÊñπÂºè</h2><ul>
<li>ÁªßÊâø Thread Á±ª</li>
<li>ÂÆûÁé∞ Runnable Êé•Âè£</li>
<li>ÈÄöËøáCallableÂíåFutureÂàõÂª∫Á∫øÁ®ã</li>
<li>Á∫øÁ®ãÊ±†</li>
</ul>
<p>ÂÆûÁé∞ Runnable Êé•Âè£‰ºò‰∫éÁªßÊâø Thread Á±ªÔºåÂõ†‰∏∫Ôºö</p>
<ul>
<li>Java ‰∏çÊîØÊåÅÂ§öÈáçÁªßÊâøÔºåÊâÄÊúâÁöÑÁ±ªÈÉΩÂè™ÂÖÅËÆ∏ÁªßÊâø‰∏Ä‰∏™Áà∂Á±ªÔºå‰ΩÜÂèØ‰ª•ÂÆûÁé∞Â§ö‰∏™Êé•Âè£„ÄÇÂ¶ÇÊûúÁªßÊâø‰∫Ü Thread Á±ªÂ∞±Êó†Ê≥ïÁªßÊâøÂÖ∂ÂÆÉÁ±ªÔºåËøô‰∏çÂà©‰∫éÊâ©Â±ï„ÄÇ</li>
<li>Á±ªÂèØËÉΩÂè™Ë¶ÅÊ±ÇÂèØÊâßË°åÂ∞±Ë°åÔºåÁªßÊâøÊï¥‰∏™ Thread Á±ªÂºÄÈîÄËøáÂ§ß„ÄÇ</li>
</ul>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/u012973218/article/details/51280044">https://blog.csdn.net/u012973218/article/details/51280044</a></p>
<h2 id="ËØ¥ËØ¥Á∫øÁ®ãÁöÑÁîüÂëΩÂë®ÊúüÂíåÁä∂ÊÄÅ"><a href="#ËØ¥ËØ¥Á∫øÁ®ãÁöÑÁîüÂëΩÂë®ÊúüÂíåÁä∂ÊÄÅ" class="headerlink" title="ËØ¥ËØ¥Á∫øÁ®ãÁöÑÁîüÂëΩÂë®ÊúüÂíåÁä∂ÊÄÅ?"></a>ËØ¥ËØ¥Á∫øÁ®ãÁöÑÁîüÂëΩÂë®ÊúüÂíåÁä∂ÊÄÅ?</h2><p><strong>Áä∂ÊÄÅÔºö</strong></p>
<ul>
<li>newÔºàÊñ∞Âª∫Ôºâ</li>
<li>runnnableÔºàÂèØËøêË°åÔºâ</li>
<li>blockedÔºàÈòªÂ°ûÔºâ</li>
<li>waitingÔºàÁ≠âÂæÖÔºâ</li>
<li>time waiting ÔºàÂÆöÊó∂Á≠âÂæÖÔºâ</li>
<li>terminatedÔºàÁªàÊ≠¢Ôºâ</li>
</ul>
<p>Á∫øÁ®ãÁä∂ÊÄÅÊµÅÁ®ãÂ¶Ç‰∏ãÔºö</p>
<ol>
<li>Á∫øÁ®ãÂàõÂª∫ÂêéÔºåËøõÂÖ• new Áä∂ÊÄÅ</li>
<li>Ë∞ÉÁî® start ÊàñËÄÖ run ÊñπÊ≥ïÔºåËøõÂÖ• runnable Áä∂ÊÄÅ</li>
<li>JVM ÊåâÁÖßÁ∫øÁ®ã‰ºòÂÖàÁ∫ßÂèäÊó∂Èó¥ÂàÜÁâáÁ≠âÊâßË°å runnable Áä∂ÊÄÅÁöÑÁ∫øÁ®ã„ÄÇÂºÄÂßãÊâßË°åÊó∂ÔºåËøõÂÖ• running Áä∂ÊÄÅ</li>
<li>Â¶ÇÊûúÁ∫øÁ®ãÊâßË°å sleep„ÄÅwait„ÄÅjoinÔºåÊàñËÄÖËøõÂÖ• IO ÈòªÂ°ûÁ≠â„ÄÇËøõÂÖ• wait ÊàñËÄÖ blocked Áä∂ÊÄÅ</li>
<li>Á∫øÁ®ãÊâßË°åÂÆåÊØïÂêéÔºåÁ∫øÁ®ãË¢´Á∫øÁ®ãÈòüÂàóÁßªÈô§„ÄÇÊúÄÂêé‰∏∫ terminated Áä∂ÊÄÅ</li>
</ol>
<p><img src="../img/java/8.png"></p>
<h2 id="ËØ¥ËØ¥-sleep-ÊñπÊ≥ïÂíå-wait-ÊñπÊ≥ïÂå∫Âà´ÂíåÂÖ±ÂêåÁÇπ"><a href="#ËØ¥ËØ¥-sleep-ÊñπÊ≥ïÂíå-wait-ÊñπÊ≥ïÂå∫Âà´ÂíåÂÖ±ÂêåÁÇπ" class="headerlink" title="ËØ¥ËØ¥ sleep() ÊñπÊ≥ïÂíå wait() ÊñπÊ≥ïÂå∫Âà´ÂíåÂÖ±ÂêåÁÇπ?"></a>ËØ¥ËØ¥ sleep() ÊñπÊ≥ïÂíå wait() ÊñπÊ≥ïÂå∫Âà´ÂíåÂÖ±ÂêåÁÇπ?</h2><ul>
<li>‰∏§ËÄÖÊúÄ‰∏ªË¶ÅÁöÑÂå∫Âà´Âú®‰∫éÔºö**<code>sleep()</code> ÊñπÊ≥ïÊ≤°ÊúâÈáäÊîæÈîÅÔºåËÄå <code>wait()</code> ÊñπÊ≥ïÈáäÊîæ‰∫ÜÈîÅ** „ÄÇ</li>
<li>‰∏§ËÄÖÈÉΩÂèØ‰ª•ÊöÇÂÅúÁ∫øÁ®ãÁöÑÊâßË°å„ÄÇ</li>
<li><code>wait()</code> ÈÄöÂ∏∏Ë¢´Áî®‰∫éÁ∫øÁ®ãÈó¥‰∫§‰∫í/ÈÄö‰ø°Ôºå<code>sleep() </code>ÈÄöÂ∏∏Ë¢´Áî®‰∫éÊöÇÂÅúÊâßË°å„ÄÇ</li>
<li><code>wait()</code> ÊñπÊ≥ïË¢´Ë∞ÉÁî®ÂêéÔºåÁ∫øÁ®ã‰∏ç‰ºöËá™Âä®ËãèÈÜíÔºåÈúÄË¶ÅÂà´ÁöÑÁ∫øÁ®ãË∞ÉÁî®Âêå‰∏Ä‰∏™ÂØπË±°‰∏äÁöÑ <code>notify() </code>ÊàñËÄÖ <code>notifyAll()</code> ÊñπÊ≥ï„ÄÇ<code>sleep() </code>ÊñπÊ≥ïÊâßË°åÂÆåÊàêÂêéÔºåÁ∫øÁ®ã‰ºöËá™Âä®ËãèÈÜí„ÄÇÊàñËÄÖÂèØ‰ª•‰ΩøÁî® <code>wait(long timeout)</code> Ë∂ÖÊó∂ÂêéÁ∫øÁ®ã‰ºöËá™Âä®ËãèÈÜí„ÄÇ</li>
</ul>
<h2 id="BLOCKED-Âíå-WAITING-ÁöÑÂå∫Âà´"><a href="#BLOCKED-Âíå-WAITING-ÁöÑÂå∫Âà´" class="headerlink" title="BLOCKED Âíå WAITING ÁöÑÂå∫Âà´"></a>BLOCKED Âíå WAITING ÁöÑÂå∫Âà´</h2><p>ËôΩÁÑ∂ BLOCKED Âíå WAITING ÈÉΩÊúâÁ≠âÂæÖÁöÑÂê´‰πâÔºå‰ΩÜ‰∫åËÄÖÊúâÁùÄÊú¨Ë¥®ÁöÑÂå∫Âà´„ÄÇ</p>
<p>È¶ñÂÖàÂÆÉ‰ª¨Áä∂ÊÄÅÂΩ¢ÊàêÁöÑË∞ÉÁî®ÊñπÊ≥ï‰∏çÂêåÔºåÂÖ∂Ê¨° BLOCKED ÂèØ‰ª•ÁêÜËß£‰∏∫ÂΩìÂâçÁ∫øÁ®ãËøòÂ§Ñ‰∫éÊ¥ªË∑ÉÁä∂ÊÄÅÔºåÂè™ÊòØÂú®ÈòªÂ°ûÁ≠âÂæÖÂÖ∂‰ªñÁ∫øÁ®ã‰ΩøÁî®ÂÆåÊüê‰∏™ÈîÅËµÑÊ∫êÔºõËÄå WAITING ÂàôÊòØÂõ†‰∏∫Ëá™Ë∫´Ë∞ÉÁî®‰∫Ü Object.wait() ÊàñÁùÄÊòØ Thread.join() ÂèàÊàñËÄÖÊòØ LockSupport.park() ËÄåËøõÂÖ•Á≠âÂæÖÁä∂ÊÄÅÔºåÂè™ËÉΩÁ≠âÂæÖÂÖ∂‰ªñÁ∫øÁ®ãÊâßË°åÊüê‰∏™ÁâπÂÆöÁöÑÂä®‰ΩúÊâçËÉΩË¢´ÁªßÁª≠Âî§ÈÜíÔºåÊØîÂ¶ÇÂΩìÁ∫øÁ®ãÂõ†‰∏∫Ë∞ÉÁî®‰∫Ü Object.wait() ËÄåËøõÂÖ• WAITING Áä∂ÊÄÅ‰πãÂêéÔºåÂàôÈúÄË¶ÅÁ≠âÂæÖÂè¶‰∏Ä‰∏™Á∫øÁ®ãÊâßË°å Object.notify() Êàñ Object.notifyAll() ÊâçËÉΩË¢´Âî§ÈÜí„ÄÇ</p>
<h2 id="start-Âíå-run-ÁöÑÂå∫Âà´"><a href="#start-Âíå-run-ÁöÑÂå∫Âà´" class="headerlink" title="start() Âíå run() ÁöÑÂå∫Âà´"></a>start() Âíå run() ÁöÑÂå∫Âà´</h2><p>È¶ñÂÖà‰ªé Thread Ê∫êÁ†ÅÊù•ÁúãÔºåstart() ÊñπÊ≥ïÂ±û‰∫é Thread Ëá™Ë∫´ÁöÑÊñπÊ≥ïÔºåÂπ∂‰∏î‰ΩøÁî®‰∫Ü synchronized Êù•‰øùËØÅÁ∫øÁ®ãÂÆâÂÖ®.</p>
<p>run() ÊñπÊ≥ï‰∏∫ Runnable ÁöÑÊäΩË±°ÊñπÊ≥ïÔºåÂøÖÈ°ªÁî±Ë∞ÉÁî®Á±ªÈáçÂÜôÊ≠§ÊñπÊ≥ïÔºåÈáçÂÜôÁöÑ run() ÊñπÊ≥ïÂÖ∂ÂÆûÂ∞±ÊòØÊ≠§Á∫øÁ®ãË¶ÅÊâßË°åÁöÑ‰∏öÂä°ÊñπÊ≥ï.</p>
<p>‰ªéÊâßË°åÁöÑÊïàÊûúÊù•ËØ¥Ôºåstart() ÊñπÊ≥ïÂèØ‰ª•ÂºÄÂêØÂ§öÁ∫øÁ®ãÔºåËÆ©Á∫øÁ®ã‰ªé NEW Áä∂ÊÄÅËΩ¨Êç¢Êàê RUNNABLE Áä∂ÊÄÅÔºåËÄå run() ÊñπÊ≥ïÂè™ÊòØ‰∏Ä‰∏™ÊôÆÈÄöÁöÑÊñπÊ≥ï„ÄÇ</p>
<p>ÂÖ∂Ê¨°ÔºåÂÆÉ‰ª¨ÂèØË∞ÉÁî®ÁöÑÊ¨°Êï∞‰∏çÂêåÔºåstart() ÊñπÊ≥ï‰∏çËÉΩË¢´Â§öÊ¨°Ë∞ÉÁî®ÔºåÂê¶Âàô‰ºöÊäõÂá∫ java.lang.IllegalStateExceptionÔºõËÄå run() ÊñπÊ≥ïÂèØ‰ª•ËøõË°åÂ§öÊ¨°Ë∞ÉÁî®ÔºåÂõ†‰∏∫ÂÆÉÂè™ÊòØ‰∏Ä‰∏™ÊôÆÈÄöÁöÑÊñπÊ≥ïËÄåÂ∑≤„ÄÇ</p>
<h2 id="‰∏∫‰ªÄ‰πàÊàë‰ª¨Ë∞ÉÁî®-start-ÊñπÊ≥ïÊó∂‰ºöÊâßË°å-run-ÊñπÊ≥ïÔºå‰∏∫‰ªÄ‰πàÊàë‰ª¨‰∏çËÉΩÁõ¥Êé•Ë∞ÉÁî®-run-ÊñπÊ≥ïÔºü"><a href="#‰∏∫‰ªÄ‰πàÊàë‰ª¨Ë∞ÉÁî®-start-ÊñπÊ≥ïÊó∂‰ºöÊâßË°å-run-ÊñπÊ≥ïÔºå‰∏∫‰ªÄ‰πàÊàë‰ª¨‰∏çËÉΩÁõ¥Êé•Ë∞ÉÁî®-run-ÊñπÊ≥ïÔºü" class="headerlink" title="‰∏∫‰ªÄ‰πàÊàë‰ª¨Ë∞ÉÁî® start() ÊñπÊ≥ïÊó∂‰ºöÊâßË°å run() ÊñπÊ≥ïÔºå‰∏∫‰ªÄ‰πàÊàë‰ª¨‰∏çËÉΩÁõ¥Êé•Ë∞ÉÁî® run() ÊñπÊ≥ïÔºü"></a>‰∏∫‰ªÄ‰πàÊàë‰ª¨Ë∞ÉÁî® start() ÊñπÊ≥ïÊó∂‰ºöÊâßË°å run() ÊñπÊ≥ïÔºå‰∏∫‰ªÄ‰πàÊàë‰ª¨‰∏çËÉΩÁõ¥Êé•Ë∞ÉÁî® run() ÊñπÊ≥ïÔºü</h2><p>new ‰∏Ä‰∏™ ThreadÔºåÁ∫øÁ®ãËøõÂÖ•‰∫ÜÊñ∞Âª∫Áä∂ÊÄÅ„ÄÇË∞ÉÁî® <code>start()</code>ÊñπÊ≥ïÔºå‰ºöÂêØÂä®‰∏Ä‰∏™Á∫øÁ®ãÂπ∂‰ΩøÁ∫øÁ®ãËøõÂÖ•‰∫ÜÂ∞±Áª™Áä∂ÊÄÅÔºåÂΩìÂàÜÈÖçÂà∞Êó∂Èó¥ÁâáÂêéÂ∞±ÂèØ‰ª•ÂºÄÂßãËøêË°å‰∫Ü„ÄÇ <code>start()</code> ‰ºöÊâßË°åÁ∫øÁ®ãÁöÑÁõ∏Â∫îÂáÜÂ§áÂ∑•‰ΩúÔºåÁÑ∂ÂêéËá™Âä®ÊâßË°å <code>run()</code> ÊñπÊ≥ïÁöÑÂÜÖÂÆπÔºåËøôÊòØÁúüÊ≠£ÁöÑÂ§öÁ∫øÁ®ãÂ∑•‰Ωú„ÄÇ ‰ΩÜÊòØÔºåÁõ¥Êé•ÊâßË°å <code>run()</code> ÊñπÊ≥ïÔºå‰ºöÊää <code>run()</code> ÊñπÊ≥ïÂΩìÊàê‰∏Ä‰∏™ main Á∫øÁ®ã‰∏ãÁöÑÊôÆÈÄöÊñπÊ≥ïÂéªÊâßË°åÔºåÂπ∂‰∏ç‰ºöÂú®Êüê‰∏™Á∫øÁ®ã‰∏≠ÊâßË°åÂÆÉÔºåÊâÄ‰ª•ËøôÂπ∂‰∏çÊòØÂ§öÁ∫øÁ®ãÂ∑•‰Ωú„ÄÇ</p>
<p><strong>ÊÄªÁªìÔºö Ë∞ÉÁî® <code>start()</code> ÊñπÊ≥ïÊñπÂèØÂêØÂä®Á∫øÁ®ãÂπ∂‰ΩøÁ∫øÁ®ãËøõÂÖ•Â∞±Áª™Áä∂ÊÄÅÔºåÁõ¥Êé•ÊâßË°å <code>run()</code> ÊñπÊ≥ïÁöÑËØù‰∏ç‰ºö‰ª•Â§öÁ∫øÁ®ãÁöÑÊñπÂºèÊâßË°å„ÄÇ</strong></p>
<h2 id="Á∫øÁ®ã‰ºòÂÖàÁ∫ß"><a href="#Á∫øÁ®ã‰ºòÂÖàÁ∫ß" class="headerlink" title="Á∫øÁ®ã‰ºòÂÖàÁ∫ß"></a>Á∫øÁ®ã‰ºòÂÖàÁ∫ß</h2><p>Âú® Thread Ê∫êÁ†Å‰∏≠ÂíåÁ∫øÁ®ã‰ºòÂÖàÁ∫ßÁõ∏ÂÖ≥ÁöÑÂ±ûÊÄßÊúâ 3 ‰∏™Ôºö</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">&#x2F;&#x2F;¬†Á∫øÁ®ãÂèØ‰ª•Êã•ÊúâÁöÑÊúÄÂ∞è‰ºòÂÖàÁ∫ß</span><br><span class="line">public¬†final¬†static¬†int¬†MIN_PRIORITY¬†&#x3D;¬†1;</span><br><span class="line"></span><br><span class="line">&#x2F;&#x2F;¬†Á∫øÁ®ãÈªòËÆ§‰ºòÂÖàÁ∫ß</span><br><span class="line">public¬†final¬†static¬†int¬†NORM_PRIORITY¬†&#x3D;¬†5;</span><br><span class="line"></span><br><span class="line">&#x2F;&#x2F;¬†Á∫øÁ®ãÂèØ‰ª•Êã•ÊúâÁöÑÊúÄÂ§ß‰ºòÂÖàÁ∫ß</span><br><span class="line">public¬†final¬†static¬†int¬†MAX_PRIORITY¬†&#x3D;¬†10</span><br></pre></td></tr></table></figure>

<p>Á∫øÁ®ãÁöÑ‰ºòÂÖàÁ∫ßÂèØ‰ª•ÁêÜËß£‰∏∫Á∫øÁ®ãÊä¢Âç† CPU Êó∂Èó¥ÁâáÁöÑÊ¶ÇÁéáÔºå‰ºòÂÖàÁ∫ßË∂äÈ´òÁöÑÁ∫øÁ®ã‰ºòÂÖàÊâßË°åÁöÑÊ¶ÇÁéáÂ∞±Ë∂äÂ§ßÔºå‰ΩÜÂπ∂‰∏çËÉΩ‰øùËØÅ‰ºòÂÖàÁ∫ßÈ´òÁöÑÁ∫øÁ®ã‰∏ÄÂÆöÂÖàÊâßË°å„ÄÇ</p>
<p>Âú®Á®ãÂ∫è‰∏≠Êàë‰ª¨ÂèØ‰ª•ÈÄöËøá Thread.setPriority() Êù•ËÆæÁΩÆ‰ºòÂÖàÁ∫ß</p>
<h2 id="ÊâßË°å‰∏§Ê¨°startÊñπÊ≥ï‰ºöÂ¶Ç‰ΩïÔºü"><a href="#ÊâßË°å‰∏§Ê¨°startÊñπÊ≥ï‰ºöÂ¶Ç‰ΩïÔºü" class="headerlink" title="ÊâßË°å‰∏§Ê¨°startÊñπÊ≥ï‰ºöÂ¶Ç‰ΩïÔºü"></a>ÊâßË°å‰∏§Ê¨°startÊñπÊ≥ï‰ºöÂ¶Ç‰ΩïÔºü</h2><p>JavaÁöÑÁ∫øÁ®ãÊòØ‰∏çÂÖÅËÆ∏ÂêØÂä®‰∏§Ê¨°ÁöÑÔºåÁ¨¨‰∫åÊ¨°Ë∞ÉÁî®ÂøÖÁÑ∂‰ºöÊäõÂ≤Ä IllegalThreadStateEXceptionÔºåËøôÊòØ‰∏ÄÁßçËøêË°åÊó∂ÂºÇÂ∏∏ÔºåÂ§öÊ¨°Ë∞ÉÁî® start Ë¢´ËÆ§‰∏∫ÊòØÁºñÁ®ãÈîôËØØ„ÄÇ</p>
<h2 id="ÂÆûÁé∞-Runnable-Êé•Âè£Âíå-Callable-Êé•Âè£ÁöÑÂå∫Âà´"><a href="#ÂÆûÁé∞-Runnable-Êé•Âè£Âíå-Callable-Êé•Âè£ÁöÑÂå∫Âà´" class="headerlink" title="ÂÆûÁé∞ Runnable Êé•Âè£Âíå Callable Êé•Âè£ÁöÑÂå∫Âà´"></a>ÂÆûÁé∞ Runnable Êé•Âè£Âíå Callable Êé•Âè£ÁöÑÂå∫Âà´</h2><p><code>Runnable</code>Ëá™ Java 1.0 ‰ª•Êù•‰∏ÄÁõ¥Â≠òÂú®Ôºå‰ΩÜ<code>Callable</code>‰ªÖÂú® Java 1.5 ‰∏≠ÂºïÂÖ•,ÁõÆÁöÑÂ∞±ÊòØ‰∏∫‰∫ÜÊù•Â§ÑÁêÜ<code>Runnable</code>‰∏çÊîØÊåÅÁöÑÁî®‰æã„ÄÇ**<code>Runnable</code> Êé•Âè£<strong>‰∏ç‰ºöËøîÂõûÁªìÊûúÊàñÊäõÂá∫Ê£ÄÊü•ÂºÇÂ∏∏Ôºå‰ΩÜÊòØ</strong><code>Callable</code> Êé•Âè£**ÂèØ‰ª•„ÄÇÊâÄ‰ª•ÔºåÂ¶ÇÊûú‰ªªÂä°‰∏çÈúÄË¶ÅËøîÂõûÁªìÊûúÊàñÊäõÂá∫ÂºÇÂ∏∏Êé®Ëçê‰ΩøÁî® <strong><code>Runnable</code> Êé•Âè£</strong>ÔºåËøôÊ†∑‰ª£Á†ÅÁúãËµ∑Êù•‰ºöÊõ¥Âä†ÁÆÄÊ¥Å„ÄÇ</p>
<p>Â∑•ÂÖ∑Á±ª <code>Executors</code> ÂèØ‰ª•ÂÆûÁé∞ <code>Runnable</code> ÂØπË±°Âíå <code>Callable</code> ÂØπË±°‰πãÈó¥ÁöÑÁõ∏‰∫íËΩ¨Êç¢„ÄÇÔºà<code>Executors.callableÔºàRunnable task</code>ÔºâÊàñ <code>Executors.callableÔºàRunnable taskÔºåObject resuleÔºâ</code>Ôºâ„ÄÇ</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">Runnable.java</span><br><span class="line"></span><br><span class="line"><span class="meta">@FunctionalInterface</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">Runnable</span> </span>&#123;</span><br><span class="line">   <span class="comment">/**</span></span><br><span class="line"><span class="comment">    * Ë¢´Á∫øÁ®ãÊâßË°åÔºåÊ≤°ÊúâËøîÂõûÂÄº‰πüÊó†Ê≥ïÊäõÂá∫ÂºÇÂ∏∏</span></span><br><span class="line"><span class="comment">    */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span></span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Callable.java</span><br><span class="line"></span><br><span class="line"><span class="meta">@FunctionalInterface</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">Callable</span>&lt;<span class="title">V</span>&gt; </span>&#123;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * ËÆ°ÁÆóÁªìÊûúÔºåÊàñÂú®Êó†Ê≥ïËøôÊ†∑ÂÅöÊó∂ÊäõÂá∫ÂºÇÂ∏∏„ÄÇ</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> ËÆ°ÁÆóÂæóÂá∫ÁöÑÁªìÊûú</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@throws</span> Â¶ÇÊûúÊó†Ê≥ïËÆ°ÁÆóÁªìÊûúÔºåÂàôÊäõÂá∫ÂºÇÂ∏∏</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function">V <span class="title">call</span><span class="params">()</span> <span class="keyword">throws</span> Exception</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="ÊûÑÈÄ†ÊñπÊ≥ïÂèØ‰ª•‰ΩøÁî®-synchronized-ÂÖ≥ÈîÆÂ≠ó‰øÆÈ•∞‰πàÔºü"><a href="#ÊûÑÈÄ†ÊñπÊ≥ïÂèØ‰ª•‰ΩøÁî®-synchronized-ÂÖ≥ÈîÆÂ≠ó‰øÆÈ•∞‰πàÔºü" class="headerlink" title="ÊûÑÈÄ†ÊñπÊ≥ïÂèØ‰ª•‰ΩøÁî® synchronized ÂÖ≥ÈîÆÂ≠ó‰øÆÈ•∞‰πàÔºü"></a>ÊûÑÈÄ†ÊñπÊ≥ïÂèØ‰ª•‰ΩøÁî® synchronized ÂÖ≥ÈîÆÂ≠ó‰øÆÈ•∞‰πàÔºü</h3><p>ÂÖàËØ¥ÁªìËÆ∫Ôºö<strong>ÊûÑÈÄ†ÊñπÊ≥ï‰∏çËÉΩ‰ΩøÁî® synchronized ÂÖ≥ÈîÆÂ≠ó‰øÆÈ•∞„ÄÇ</strong></p>
<p>ÊûÑÈÄ†ÊñπÊ≥ïÊú¨Ë∫´Â∞±Â±û‰∫éÁ∫øÁ®ãÂÆâÂÖ®ÁöÑÔºå‰∏çÂ≠òÂú®ÂêåÊ≠•ÁöÑÊûÑÈÄ†ÊñπÊ≥ï‰∏ÄËØ¥„ÄÇ</p>
<h3 id="ÈîÅÊ∂àÈô§"><a href="#ÈîÅÊ∂àÈô§" class="headerlink" title="ÈîÅÊ∂àÈô§"></a>ÈîÅÊ∂àÈô§</h3><p>ÈîÅÊ∂àÈô§ÁêÜËß£Ëµ∑Êù•ÂæàÁÆÄÂçïÔºåÂÆÉÊåáÁöÑÂ∞±ÊòØËôöÊãüÊú∫Âç≥‰ΩøÁºñËØëÂô®Âú®ËøêË°åÊó∂ÔºåÂ¶ÇÊûúÊ£ÄÊµãÂà∞ÈÇ£‰∫õÂÖ±‰∫´Êï∞ÊçÆ‰∏çÂèØËÉΩÂ≠òÂú®Á´û‰∫âÔºåÈÇ£‰πàÂ∞±ÊâßË°åÈîÅÊ∂àÈô§„ÄÇÈîÅÊ∂àÈô§ÂèØ‰ª•ËäÇÁúÅÊØ´Êó†ÊÑè‰πâÁöÑËØ∑Ê±ÇÈîÅÁöÑÊó∂Èó¥„ÄÇ</p>
<p>‰æãÂ¶ÇÔºöÂ≠óÁ¨¶‰∏≤ÁöÑÊãºÊé•Êìç‰ΩúÔºåjavacÁºñËØëÂô®‰ºöÂØπStringËøûÊé•ÂÅöËá™Âä®‰ºòÂåñ„ÄÇÂú®JDK1.5‰πãÂâç‰ºöËΩ¨Âåñ‰∏∫StringBufferÂØπË±°ÂÅöappendÊìç‰Ωú„ÄÇÂú®JDK1.5‰πãÂêéÁöÑÁâàÊú¨‰ºöËΩ¨Âåñ‰∏∫StringBuilderÁöÑËøûÁª≠appendÊìç‰Ωú„ÄÇ</p>
<p>StringBuffer.appendÔºàÔºâÊñπÊ≥ï‰∏≠ÈÉΩÊúâ‰∏Ä‰∏™ÂêåÊ≠•ÂùóÔºåÈîÅÂ∞±ÊòØsbÂØπË±°„ÄÇËôöÊãüÊú∫‰ºöËßÇÂØüÂèòÈáèsbÔºåÂèëÁé∞‰ªñÁöÑÂä®ÊÄÅ‰ΩúÁî®ÂüüË¢´ÈôêÂà∂Âú®concatStringÊñπÊ≥ïÂÜÖÈÉ®ÔºåÊ∞∏Ëøú‰∏ç‰ºöÈÄÉÈÄ∏Âà∞concatStringÊñπÊ≥ï‰πãÂ§ñÔºåÂÖ∂‰ªñÁ∫øÁ®ãÊó†Ê≥ïËÆøÈóÆ„ÄÇÂõ†Ê≠§ËøôÈáåÊúâÈîÅÔºå‰ΩÜÊòØ‰ºöË¢´ÂÆâÂÖ®ÁöÑÊ∂àÈô§Êéâ„ÄÇ</p>
<h3 id="ÈîÅÁ≤óÂåñ"><a href="#ÈîÅÁ≤óÂåñ" class="headerlink" title="ÈîÅÁ≤óÂåñ"></a>ÈîÅÁ≤óÂåñ</h3><p>ÂéüÂàô‰∏äÔºåÊàë‰ª¨Âú®ÁºñÂÜô‰ª£Á†ÅÁöÑÊó∂ÂÄôÔºåÊÄªÊòØÊé®ËçêÂ∞ÜÂêåÊ≠•ÂùóÁöÑ‰ΩúÁî®ËåÉÂõ¥ÈôêÂà∂ÂæóÂ∞ΩÈáèÂ∞èÔºå‚Äî‚ÄîÁõ¥Âú®ÂÖ±‰∫´Êï∞ÊçÆÁöÑÂÆûÈôÖ‰ΩúÁî®ÂüüÊâçËøõË°åÂêåÊ≠•ÔºåËøôÊ†∑ÊòØ‰∏∫‰∫Ü‰ΩøÂæóÈúÄË¶ÅÂêåÊ≠•ÁöÑÊìç‰ΩúÊï∞ÈáèÂ∞ΩÂèØËÉΩÂèòÂ∞èÔºåÂ¶ÇÊûúÂ≠òÂú®ÈîÅÁ´û‰∫âÔºåÈÇ£Á≠âÂæÖÁ∫øÁ®ã‰πüËÉΩÂ∞ΩÂø´ÊãøÂà∞ÈîÅ„ÄÇ</p>
<p>Â§ßÈÉ®ÂàÜÊÉÖÂÜµ‰∏ãÔºå‰∏äÈù¢ÁöÑÂéüÂàôÈÉΩÊòØÊ≤°ÊúâÈóÆÈ¢òÁöÑÔºå‰ΩÜÊòØÂ¶ÇÊûú‰∏ÄÁ≥ªÂàóÁöÑËøûÁª≠Êìç‰ΩúÈÉΩÂØπÂêå‰∏Ä‰∏™ÂØπË±°ÂèçÂ§çÂä†ÈîÅÂíåËß£ÈîÅÔºåÁîöËá≥Âä†ÈîÅÊìç‰ΩúÂá∫Áé∞Âú®Âæ™ÁéØ‰Ωì‰∏≠ÔºåÈÇ£Âç≥ÊòØÊ≤°ÊúâÁ∫øÁ®ãÁ´û‰∫âÔºåÈ¢ëÁπÅÁöÑËøõË°åÂêåÊ≠•Êìç‰Ωú‰πü‰ºöÂØºËá¥‰∏çÂøÖË¶ÅÁöÑÊÄßËÉΩÊ∂àËÄó„ÄÇ</p>
<p>Â≠óÁ¨¶‰∏≤ÊãºÊé•ÊñπÊ≥ï‰∏≠ËøûÁª≠ÁöÑappendÊìç‰ΩúÂ∞±Â±û‰∫éËøôÁßçÊÉÖÂÜµ„ÄÇÂ¶ÇÊûúËôöÊãüÊú∫Êé¢ÊµãÂà∞ÊúâËøôÊ†∑‰∏Ä‰∏≤Èõ∂Á¢éÁöÑÊìç‰ΩúÈÉΩÂØπÂêå‰∏Ä‰∏™ÂØπË±°Âä†ÈîÅÔºåÂ∞Ü‰ºöÊääÂä†ÈîÅÂêåÊ≠•ÁöÑËåÉÂõ¥Êâ©Â±ïÔºàÁ≤óÂåñÔºâÂà∞Êï¥‰∏™Êìç‰ΩúÂ∫èÂàóÁöÑÂ§ñÈù¢ÔºåËøôÊ†∑ÂèØ‰ª•ÂáèÂ∞ëÂä†ÈîÅÁöÑÊ¨°Êï∞„ÄÇ</p>
<h2 id="Ëá™ÊóãÈîÅÂíåÈÄÇÂ∫îÊÄßËá™ÊóãÈîÅ"><a href="#Ëá™ÊóãÈîÅÂíåÈÄÇÂ∫îÊÄßËá™ÊóãÈîÅ" class="headerlink" title="Ëá™ÊóãÈîÅÂíåÈÄÇÂ∫îÊÄßËá™ÊóãÈîÅ"></a>Ëá™ÊóãÈîÅÂíåÈÄÇÂ∫îÊÄßËá™ÊóãÈîÅ</h2><p>ÈòªÂ°ûÊàñÂî§ÈÜí‰∏Ä‰∏™JavaÁ∫øÁ®ãÈúÄË¶ÅÊìç‰ΩúÁ≥ªÁªüÂàáÊç¢CPUÁä∂ÊÄÅÊù•ÂÆåÊàêÔºåËøôÁßçÁä∂ÊÄÅËΩ¨Êç¢ÈúÄË¶ÅËÄóË¥πÂ§ÑÁêÜÂô®Êó∂Èó¥„ÄÇÂ¶ÇÊûúÂêåÊ≠•‰ª£Á†ÅÂùó‰∏≠ÁöÑÂÜÖÂÆπËøá‰∫éÁÆÄÂçïÔºåÁä∂ÊÄÅËΩ¨Êç¢Ê∂àËÄóÁöÑÊó∂Èó¥ÊúâÂèØËÉΩÊØîÁî®Êà∑‰ª£Á†ÅÊâßË°åÁöÑÊó∂Èó¥ËøòË¶ÅÈïø„ÄÇ</p>
<p>Âú®ËÆ∏Â§öÂú∫ÊôØ‰∏≠ÔºåÂêåÊ≠•ËµÑÊ∫êÁöÑÈîÅÂÆöÊó∂Èó¥ÂæàÁü≠Ôºå‰∏∫‰∫ÜËøô‰∏ÄÂ∞èÊÆµÊó∂Èó¥ÂéªÂàáÊç¢Á∫øÁ®ãÔºåÁ∫øÁ®ãÊåÇËµ∑ÂíåÊÅ¢Â§çÁé∞Âú∫ÁöÑËä±Ë¥πÂèØËÉΩ‰ºöËÆ©Á≥ªÁªüÂæó‰∏çÂÅøÂ§±„ÄÇÂ¶ÇÊûúÁâ©ÁêÜÊú∫Âô®ÊúâÂ§ö‰∏™Â§ÑÁêÜÂô®ÔºåËÉΩÂ§üËÆ©‰∏§‰∏™Êàñ‰ª•‰∏äÁöÑÁ∫øÁ®ãÂêåÊó∂Âπ∂Ë°åÊâßË°åÔºåÊàë‰ª¨Â∞±ÂèØ‰ª•ËÆ©ÂêéÈù¢ÈÇ£‰∏™ËØ∑Ê±ÇÈîÅÁöÑÁ∫øÁ®ã‰∏çÊîæÂºÉCPUÁöÑÊâßË°åÊó∂Èó¥ÔºåÁúãÁúãÊåÅÊúâÈîÅÁöÑÁ∫øÁ®ãÊòØÂê¶ÂæàÂø´Â∞±‰ºöÈáäÊîæÈîÅ„ÄÇ</p>
<p>ËÄå‰∏∫‰∫ÜËÆ©ÂΩìÂâçÁ∫øÁ®ã‚ÄúÁ®çÁ≠â‰∏Ä‰∏ã‚ÄùÔºåÊàë‰ª¨ÈúÄËÆ©ÂΩìÂâçÁ∫øÁ®ãËøõË°åËá™ÊóãÔºåÂ¶ÇÊûúÂú®Ëá™ÊóãÂÆåÊàêÂêéÂâçÈù¢ÈîÅÂÆöÂêåÊ≠•ËµÑÊ∫êÁöÑÁ∫øÁ®ãÂ∑≤ÁªèÈáäÊîæ‰∫ÜÈîÅÔºåÈÇ£‰πàÂΩìÂâçÁ∫øÁ®ãÂ∞±ÂèØ‰ª•‰∏çÂøÖÈòªÂ°ûËÄåÊòØÁõ¥Êé•Ëé∑ÂèñÂêåÊ≠•ËµÑÊ∫êÔºå‰ªéËÄåÈÅøÂÖçÂàáÊç¢Á∫øÁ®ãÁöÑÂºÄÈîÄ„ÄÇËøôÂ∞±ÊòØËá™ÊóãÈîÅ„ÄÇ</p>
<p><img src="../img/java/6.png"></p>
<p>Ëá™ÊóãÈîÅÊú¨Ë∫´ÊòØÊúâÁº∫ÁÇπÁöÑÔºåÂÆÉ‰∏çËÉΩ‰ª£ÊõøÈòªÂ°û„ÄÇËá™ÊóãÁ≠âÂæÖËôΩÁÑ∂ÈÅøÂÖç‰∫ÜÁ∫øÁ®ãÂàáÊç¢ÁöÑÂºÄÈîÄÔºå‰ΩÜÂÆÉË¶ÅÂç†Áî®Â§ÑÁêÜÂô®Êó∂Èó¥„ÄÇÂ¶ÇÊûúÈîÅË¢´Âç†Áî®ÁöÑÊó∂Èó¥ÂæàÁü≠ÔºåËá™ÊóãÁ≠âÂæÖÁöÑÊïàÊûúÂ∞±‰ºöÈùûÂ∏∏Â•Ω„ÄÇÂèç‰πãÔºåÂ¶ÇÊûúÈîÅË¢´Âç†Áî®ÁöÑÊó∂Èó¥ÂæàÈïøÔºåÈÇ£‰πàËá™ÊóãÁöÑÁ∫øÁ®ãÂè™‰ºöÁôΩÊµ™Ë¥πÂ§ÑÁêÜÂô®ËµÑÊ∫ê„ÄÇÊâÄ‰ª•ÔºåËá™ÊóãÁ≠âÂæÖÁöÑÊó∂Èó¥ÂøÖÈ°ªË¶ÅÊúâ‰∏ÄÂÆöÁöÑÈôêÂ∫¶ÔºåÂ¶ÇÊûúËá™ÊóãË∂ÖËøá‰∫ÜÈôêÂÆöÊ¨°Êï∞ÔºàÈªòËÆ§ÊòØ10Ê¨°ÔºåÂèØ‰ª•‰ΩøÁî®-XX:PreBlockSpinÊù•Êõ¥ÊîπÔºâÊ≤°ÊúâÊàêÂäüËé∑ÂæóÈîÅÔºåÂ∞±Â∫îÂΩìÊåÇËµ∑Á∫øÁ®ã„ÄÇ</p>
<p>Ëá™ÊóãÈîÅÂú®JDK1.4.2‰∏≠ÂºïÂÖ•Ôºå‰ΩøÁî®-XX:+UseSpinningÊù•ÂºÄÂêØ„ÄÇJDK 6‰∏≠Âèò‰∏∫ÈªòËÆ§ÂºÄÂêØÔºåÂπ∂‰∏îÂºïÂÖ•‰∫ÜËá™ÈÄÇÂ∫îÁöÑËá™ÊóãÈîÅÔºàÈÄÇÂ∫îÊÄßËá™ÊóãÈîÅÔºâ„ÄÇ</p>
<p>Ëá™ÈÄÇÂ∫îÊÑèÂë≥ÁùÄËá™ÊóãÁöÑÊó∂Èó¥ÔºàÊ¨°Êï∞Ôºâ‰∏çÂÜçÂõ∫ÂÆöÔºåËÄåÊòØÁî±Ââç‰∏ÄÊ¨°Âú®Âêå‰∏Ä‰∏™ÈîÅ‰∏äÁöÑËá™ÊóãÊó∂Èó¥ÂèäÈîÅÁöÑÊã•ÊúâËÄÖÁöÑÁä∂ÊÄÅÊù•ÂÜ≥ÂÆö„ÄÇÂ¶ÇÊûúÂú®Âêå‰∏Ä‰∏™ÈîÅÂØπË±°‰∏äÔºåËá™ÊóãÁ≠âÂæÖÂàöÂàöÊàêÂäüËé∑ÂæóËøáÈîÅÔºåÂπ∂‰∏îÊåÅÊúâÈîÅÁöÑÁ∫øÁ®ãÊ≠£Âú®ËøêË°å‰∏≠ÔºåÈÇ£‰πàËôöÊãüÊú∫Â∞±‰ºöËÆ§‰∏∫ËøôÊ¨°Ëá™Êóã‰πüÊòØÂæàÊúâÂèØËÉΩÂÜçÊ¨°ÊàêÂäüÔºåËøõËÄåÂÆÉÂ∞ÜÂÖÅËÆ∏Ëá™ÊóãÁ≠âÂæÖÊåÅÁª≠Áõ∏ÂØπÊõ¥ÈïøÁöÑÊó∂Èó¥„ÄÇÂ¶ÇÊûúÂØπ‰∫éÊüê‰∏™ÈîÅÔºåËá™ÊóãÂæàÂ∞ëÊàêÂäüËé∑ÂæóËøáÔºåÈÇ£Âú®‰ª•ÂêéÂ∞ùËØïËé∑ÂèñËøô‰∏™ÈîÅÊó∂Â∞ÜÂèØËÉΩÁúÅÁï•ÊéâËá™ÊóãËøáÁ®ãÔºåÁõ¥Êé•ÈòªÂ°ûÁ∫øÁ®ãÔºåÈÅøÂÖçÊµ™Ë¥πÂ§ÑÁêÜÂô®ËµÑÊ∫ê„ÄÇ</p>
<h2 id="JMM"><a href="#JMM" class="headerlink" title="JMM"></a>JMM</h2><p>Java ÂÜÖÂ≠òÊ®°ÂûãÔºàJMMÔºâÊòØ‰∏ÄÁßçÊäΩË±°ÁöÑÊ¶ÇÂøµÔºåÂπ∂‰∏çÁúüÂÆûÂ≠òÂú®ÔºåÂÆÉÊèèËø∞‰∫Ü‰∏ÄÁªÑËßÑÂàôÊàñËßÑËåÉÔºåÈÄöËøáËøôÁªÑËßÑËåÉÂÆö‰πâ‰∫ÜÁ®ãÂ∫è‰∏≠ÂêÑ‰∏™ÂèòÈáèÔºàÂåÖÊã¨ÂÆû‰æãÂ≠óÊÆµ„ÄÅÈùôÊÄÅÂ≠óÊÆµÂíåÊûÑÊàêÊï∞ÁªÑÂØπË±°ÁöÑÂÖÉÁ¥†ÔºâÁöÑËÆøÈóÆÊñπÂºè„ÄÇËØïÂõæÂ±èËîΩÂêÑÁßçÁ°¨‰ª∂ÂíåÊìç‰ΩúÁ≥ªÁªüÁöÑÂÜÖÂ≠òËÆøÈóÆÂ∑ÆÂºÇÔºå‰ª•ÂÆûÁé∞ËÆ© Java Á®ãÂ∫èÂú®ÂêÑÁßçÂπ≥Âè∞‰∏ãÈÉΩËÉΩËææÂà∞‰∏ÄËá¥ÁöÑÂÜÖÂ≠òËÆøÈóÆÊïàÊûú„ÄÇ</p>
<blockquote>
<p>Ê≥®ÊÑèJMM‰∏éJVMÂÜÖÂ≠òÂå∫ÂüüÂàíÂàÜÁöÑÂå∫Âà´Ôºö</p>
<ul>
<li>JMMÊèèËø∞ÁöÑÊòØ‰∏ÄÁªÑËßÑÂàôÔºåÂõ¥ÁªïÂéüÂ≠êÊÄß„ÄÅÊúâÂ∫èÊÄßÂíåÂèØËßÅÊÄßÂ±ïÂºÄÔºõ</li>
<li>Áõ∏‰ººÁÇπÔºöÂ≠òÂú®ÂÖ±‰∫´Âå∫ÂüüÂíåÁßÅÊúâÂå∫Âüü</li>
</ul>
</blockquote>
<p>ÈìæÊé•Ôºö<a target="_blank" rel="noopener" href="https://juejin.cn/post/6844903845152325639">https://juejin.cn/post/6844903845152325639</a></p>
<h2 id="JMM-Â¶Ç‰ΩïËß£ÂÜ≥ÂéüÂ≠êÊÄß-‰∏ÄËá¥ÊÄß-ÂèØËßÅÊÄß-ÈóÆÈ¢ò"><a href="#JMM-Â¶Ç‰ΩïËß£ÂÜ≥ÂéüÂ≠êÊÄß-‰∏ÄËá¥ÊÄß-ÂèØËßÅÊÄß-ÈóÆÈ¢ò" class="headerlink" title="JMM Â¶Ç‰ΩïËß£ÂÜ≥ÂéüÂ≠êÊÄß ‰∏ÄËá¥ÊÄß ÂèØËßÅÊÄß ÈóÆÈ¢ò"></a>JMM Â¶Ç‰ΩïËß£ÂÜ≥ÂéüÂ≠êÊÄß ‰∏ÄËá¥ÊÄß ÂèØËßÅÊÄß ÈóÆÈ¢ò</h2><blockquote>
<p>Âú®Java‰∏≠Êèê‰æõ‰∫Ü‰∏ÄÁ≥ªÂàóÂíåÂπ∂ÂèëÂ§ÑÁêÜÁõ∏ÂÖ≥ÁöÑÂÖ≥ÈîÆÂ≠óÔºåÊØîÂ¶Çvolatile„ÄÅSynchronized„ÄÅÔ¨Ånal„ÄÅjucÁ≠âÔºåËøô‰∫õÂ∞±ÊòØJavaÂÜÖÂ≠ò Ê®°ÂûãÂ∞ÅË£Ö‰∫ÜÂ∫ïÂ±ÇÁöÑÂÆûÁé∞ÂêéÊèê‰æõÁªôÂºÄÂèë‰∫∫Âëò‰ΩøÁî®ÁöÑÂÖ≥ÈîÆÂ≠óÔºåÂú®ÂºÄÂèëÂ§öÁ∫øÁ®ã‰ª£Á†ÅÁöÑÊó∂ÂÄôÔºåÊàë‰ª¨ÂèØ‰ª•Áõ¥Êé•‰ΩøÁî® synchronizedÁ≠âÂÖ≥ÈîÆËØçÊù•ÊéßÂà∂Âπ∂ÂèëÔºå‰ΩøÂæóÊàë‰ª¨‰∏çÈúÄË¶ÅÂÖ≥ÂøÉÂ∫ïÂ±ÇÁöÑÁºñËØëÂô®‰ºòÂåñ„ÄÅÁºìÂ≠ò‰∏ÄËá¥ÊÄßÁöÑÈóÆÈ¢ò‰∫ÜÔºåÊâÄ‰ª•Âú®JavaÂÜÖ Â≠òÊ®°Âûã‰∏≠ÔºåÈô§‰∫ÜÂÆö‰πâ‰∫Ü‰∏ÄÂ•óËßÑËåÉÔºåËøòÊèê‰æõ‰∫ÜÂºÄÊîæÁöÑÊåá‰ª§Âú®Â∫ïÂ±ÇËøõË°åÂ∞ÅË£ÖÂêéÔºåÊèê‰æõÁªôÂºÄÂèë‰∫∫Âëò‰ΩøÁî®„ÄÇ</p>
</blockquote>
<p><strong>ÂéüÂ≠êÊÄß</strong></p>
<p>Âú®java‰∏≠Êèê‰æõ‰∫Ü‰∏§‰∏™È´òÁ∫ßÁöÑÂ≠óËäÇÁ†ÅÊåá‰ª§monitorenterÂíåmonitorexitÔºåÂú®Java‰∏≠ÂØπÂ∫îÁöÑSynchronizedÊù•‰øùËØÅ‰ª£Á†ÅÂùó ÂÜÖÁöÑÊìç‰ΩúÊòØÂéüÂ≠êÁöÑ</p>
<p><strong>ÂèØËßÅÊÄß</strong></p>
<p>Java‰∏≠ÁöÑvolatileÂÖ≥ÈîÆÂ≠óÊèê‰æõ‰∫Ü‰∏Ä‰∏™ÂäüËÉΩÔºåÈÇ£Â∞±ÊòØË¢´ÂÖ∂‰øÆÈ•∞ÁöÑÂèòÈáèÂú®Ë¢´‰øÆÊîπÂêéÂèØ‰ª•Á´ãÂç≥ÂêåÊ≠•Âà∞‰∏ªÂÜÖÂ≠òÔºåË¢´ÂÖ∂‰øÆÈ•∞ÁöÑÂèò ÈáèÂú®ÊØèÊ¨°ÊòØÁî®‰πãÂâçÈÉΩ‰ªé‰∏ªÂÜÖÂ≠òÂà∑Êñ∞„ÄÇÂõ†Ê≠§ÔºåÂèØ‰ª•‰ΩøÁî®volatileÊù•‰øùËØÅÂ§öÁ∫øÁ®ãÊìç‰ΩúÊó∂ÂèòÈáèÁöÑÂèØËßÅÊÄß„ÄÇ</p>
<p>Èô§‰∫ÜvolatileÔºåJava‰∏≠ÁöÑsynchronizedÂíåÔ¨Ånal‰∏§‰∏™ÂÖ≥ÈîÆÂ≠ó‰πüÂèØ‰ª•ÂÆûÁé∞ÂèØËßÅÊÄß</p>
<p><strong>ÊúâÂ∫èÊÄß</strong></p>
<p>Âú®Java‰∏≠ÔºåÂèØ‰ª•‰ΩøÁî®synchronizedÂíåvolatileÊù•‰øùËØÅÂ§öÁ∫øÁ®ã‰πãÈó¥Êìç‰ΩúÁöÑÊúâÂ∫èÊÄßÔºàÁºñËØëÂô®ÂíåÂ§ÑÁêÜÂô®‰∏ç‰ºöÊîπÂèòÂ≠òÂú®Êï∞ÊçÆ‰æùËµñÂÖ≥Á≥ªÁöÑ‰∏§‰∏™Êìç‰ΩúÁöÑÊâßË°åÈ°∫Â∫èÔºâ„ÄÇÂÆûÁé∞ÊñπÂºèÊúâÊâÄÂå∫Âà´Ôºö</p>
<p>volatileÂÖ≥ÈîÆÂ≠ó‰ºöÁ¶ÅÊ≠¢Êåá‰ª§ÈáçÊéí„ÄÇsynchronizedÂÖ≥ÈîÆÂ≠ó‰øùËØÅÂêå‰∏ÄÊó∂ÂàªÂè™ÂÖÅËÆ∏‰∏ÄÊù°Á∫øÁ®ãÊìç‰Ωú„ÄÇ</p>
<p><a target="_blank" rel="noopener" href="https://developer.aliyun.com/article/659737">https://developer.aliyun.com/article/659737</a></p>
<h2 id="ÂêÑÁßçÈîÅ"><a href="#ÂêÑÁßçÈîÅ" class="headerlink" title="ÂêÑÁßçÈîÅ"></a>ÂêÑÁßçÈîÅ</h2><p><img src="../img/java/33.png"></p>
<p><a target="_blank" rel="noopener" href="https://tech.meituan.com/2018/11/15/java-lock.html">https://tech.meituan.com/2018/11/15/java-lock.html</a></p>
<h3 id="‰πêËßÇÈîÅ-amp-ÊÇ≤ËßÇÈîÅ"><a href="#‰πêËßÇÈîÅ-amp-ÊÇ≤ËßÇÈîÅ" class="headerlink" title="‰πêËßÇÈîÅ &amp; ÊÇ≤ËßÇÈîÅ"></a>‰πêËßÇÈîÅ &amp; ÊÇ≤ËßÇÈîÅ</h3><p>Ëøô‰∏™ÂàÜÁ±ª‰∏çÊòØÂÖ∑‰ΩìÈîÅÁöÑÂàÜÁ±ªÔºåËÄåÊòØÁúãÂæÖÂπ∂ÂèëÂêåÊ≠•ÁöÑËßíÂ∫¶Ôºõ</p>
<p>ÊÇ≤ËßÇÈîÅËÆ§‰∏∫ÂØπ‰∫éÂêå‰∏Ä‰∏™Êï∞ÊçÆÁöÑÂπ∂ÂèëÊìç‰Ωú‰∏ÄÂÆöÊòØ‰ºöÂèëÁîü‰øÆÊîπÁöÑÔºàÂì™ÊÄïÂÆûË¥®Ê≤°‰øÆÊîπ‰πüËÆ§‰∏∫‰ºö‰øÆÊîπÔºâÔºåÂõ†Ê≠§ÂØπ‰∫éÂêå‰∏Ä‰∏™Êï∞ÊçÆÁöÑÂπ∂ÂèëÊìç‰ΩúÔºåÊÇ≤ËßÇÈîÅÈááÂèñÂä†ÈîÅÁöÑÂΩ¢ÂºèÔºåÂõ†‰∏∫ÊÇ≤ËßÇÈîÅËÆ§‰∏∫‰∏çÂä†ÈîÅÁöÑÊìç‰Ωú‰∏ÄÂÆöÊúâÈóÆÈ¢òÔºõ</p>
<p>‰πêËßÇÈîÅÂàôËÆ§‰∏∫ÂØπ‰∫éÂêå‰∏Ä‰∏™Êï∞ÊçÆÁöÑÂπ∂ÂèëÊìç‰ΩúÊòØ‰∏ç‰ºöÂèëÁîü‰øÆÊîπÁöÑÔºåÂú®Êõ¥Êñ∞Êï∞ÊçÆÁöÑÊó∂ÂÄô‰ºöÈááÁî®‰∏çÊñ≠ÁöÑÂ∞ùËØïÊõ¥Êñ∞Ôºå‰πêËßÇÈîÅËÆ§‰∏∫‰∏çÂä†ÈîÅÁöÑÂπ∂ÂèëÊìç‰ΩúÊòØÊ≤°‰∫ãÁöÑÔºõ</p>
<p>Áî±Ê≠§ÂèØ‰ª•ÁúãÂá∫ÊÇ≤ËßÇÈîÅÈÄÇÂêàÂÜôÊìç‰ΩúÈùûÂ∏∏Â§öÁöÑÂú∫ÊôØÔºå‰πêËßÇÈîÅÈÄÇÂêàËØªÊìç‰ΩúÈùûÂ∏∏Â§öÁöÑÂú∫ÊôØÔºå‰∏çÂä†ÈîÅ‰ºöÂ∏¶Êù•Â§ßÈáèÁöÑÊÄßËÉΩÊèêÂçáÔºåÊÇ≤ËßÇÈîÅÂú® java ‰∏≠ÂæàÂ∏∏ËßÅÔºàsynchronizedÂÖ≥ÈîÆÂ≠óÂíåLockÁöÑÂÆûÁé∞Á±ªÈÉΩÊòØÊÇ≤ËßÇÈîÅÔºâÔºå‰πêËßÇÈîÅÂÖ∂ÂÆûÂ∞±ÊòØÂü∫‰∫é CAS ÁöÑÊó†ÈîÅÁºñÁ®ãÔºåË≠¨Â¶Ç java ÁöÑÂéüÂ≠êÁ±ªÂ∞±ÊòØÈÄöËøá CAS Ëá™ÊóãÂÆûÁé∞ÁöÑ„ÄÇ</p>
<h3 id="ÂÖ¨Âπ≥ÈîÅ-VS-ÈùûÂÖ¨Âπ≥ÈîÅ"><a href="#ÂÖ¨Âπ≥ÈîÅ-VS-ÈùûÂÖ¨Âπ≥ÈîÅ" class="headerlink" title="ÂÖ¨Âπ≥ÈîÅ VS ÈùûÂÖ¨Âπ≥ÈîÅ"></a>ÂÖ¨Âπ≥ÈîÅ VS ÈùûÂÖ¨Âπ≥ÈîÅ</h3><p>ÂÖ¨Âπ≥ÈîÅÊåáÂ§ö‰∏™Á∫øÁ®ãÊåâÁÖßÁî≥ËØ∑ÈîÅÁöÑÈ°∫Â∫èÊù•Ëé∑ÂèñÈîÅÔºåÈùûÂÖ¨Âπ≥ÈîÅÂ∞±ÊòØÊ≤°ÊúâÈ°∫Â∫èÂÆåÂÖ®ÈöèÊú∫ÔºåÊâÄ‰ª•ËÉΩ‰ºöÈÄ†Êàê‰ºòÂÖàÁ∫ßÂèçËΩ¨ÊàñËÄÖÈ••È•øÁé∞Ë±°Ôºõ</p>
<p>synchronized ÂÆûÁé∞ÁöÑÊòØÈùûÂÖ¨Âπ≥ÈîÅÔºåReentrantLock ÈÄöËøáÊûÑÈÄ†ÂèÇÊï∞ÂèØ‰ª•ÂÜ≥ÂÆöÊòØÈùûÂÖ¨Âπ≥ÈîÅËøòÊòØÂÖ¨Âπ≥ÈîÅÔºåÈªòËÆ§ÊûÑÈÄ†ÊòØÈùûÂÖ¨Âπ≥ÈîÅÔºõÈùûÂÖ¨Âπ≥ÈîÅÁöÑÂêûÂêêÈáèÊÄßËÉΩÊØîÂÖ¨Âπ≥ÈîÅÂ§ßÂ•Ω„ÄÇ</p>
<p>ReentrantLockÁöÑÂÆûÁé∞‰∏≠ÔºöÂÖ¨Âπ≥ÈîÅ‰∏éÈùûÂÖ¨Âπ≥ÈîÅÁöÑlock()ÊñπÊ≥ïÂîØ‰∏ÄÁöÑÂå∫Âà´Â∞±Âú®‰∫éÂÖ¨Âπ≥ÈîÅÂú®Ëé∑ÂèñÂêåÊ≠•Áä∂ÊÄÅÊó∂Â§ö‰∫Ü‰∏Ä‰∏™ÈôêÂà∂Êù°‰ª∂ÔºöhasQueuedPredecessors()„ÄÇ</p>
<p><img src="../img/java/34.png"></p>
<h3 id="ÂèØÈáçÂÖ•ÈîÅ"><a href="#ÂèØÈáçÂÖ•ÈîÅ" class="headerlink" title="ÂèØÈáçÂÖ•ÈîÅ"></a>ÂèØÈáçÂÖ•ÈîÅ</h3><p>ÂèØÈáçÂÖ•ÈîÅÂèàÂêçÈÄíÂΩíÈîÅÔºåÊòØÊåáÂú®Âêå‰∏Ä‰∏™Á∫øÁ®ãÂú®Â§ñÂ±ÇÊñπÊ≥ïËé∑ÂèñÈîÅÁöÑÊó∂ÂÄôÔºåÂÜçËøõÂÖ•ËØ•Á∫øÁ®ãÁöÑÂÜÖÂ±ÇÊñπÊ≥ï‰ºöËá™Âä®Ëé∑ÂèñÈîÅÔºàÂâçÊèêÈîÅÂØπË±°ÂæóÊòØÂêå‰∏Ä‰∏™ÂØπË±°ÊàñËÄÖclassÔºâÔºå‰∏ç‰ºöÂõ†‰∏∫‰πãÂâçÂ∑≤ÁªèËé∑ÂèñËøáËøòÊ≤°ÈáäÊîæËÄåÈòªÂ°û„ÄÇ</p>
<p>Java‰∏≠ReentrantLockÂíåsynchronizedÈÉΩÊòØÂèØÈáçÂÖ•ÈîÅÔºåÂèØÈáçÂÖ•ÈîÅÁöÑ‰∏Ä‰∏™‰ºòÁÇπÊòØÂèØ‰∏ÄÂÆöÁ®ãÂ∫¶ÈÅøÂÖçÊ≠ªÈîÅ„ÄÇ</p>
<blockquote>
<p>synchronized ÈáçÂÖ•ÁöÑÂÆûÁé∞Êú∫Âà∂</p>
<p>ÊØè‰∏™ÈîÅÂØπË±°ÈÉΩÊã•ÊúâÔºö</p>
<ol>
<li>ÈîÅËÆ°Êï∞Âô®  </li>
<li>ÊåáÂêëÊã•ÊúâËØ•ÈîÅÁöÑÁ∫øÁ®ãÁöÑÊåáÈíà</li>
</ol>
<p>ÂΩìÊâßË°åmonitorenterÊó∂ÔºåÂ¶ÇÊûúÁõÆÊ†áÈîÅÂØπË±°ÁöÑËÆ°Êï∞Âô®‰∏∫0 ÔºåÈÇ£‰πàËØ¥Êòé‰ªñÊ≤°ÊúâË¢´ÂÖ∂‰ªñÁ∫øÁ®ãÊåÅÊúâ„ÄÇËøôÊó∂ÔºåJVM‰ºöÂ∞ÜËØ•ÈîÅÂØπË±°ÁöÑÊåÅÊúâÁ∫øÁ®ãËÆæÁΩÆ‰∏∫ÂΩìÂâçÁ∫øÁ®ãÔºåÂπ∂Â∞ÜËÆ°Êï∞Âô®Âä†1.</p>
<p>Âú®ÁõÆÊ†áÈîÅÂØπË±°ÁöÑËÆ°Êï∞Âô®‰∏ç‰∏∫0ÁöÑÊÉÖÂÜµ‰∏ãÔºåÂ¶ÇÊûúÈîÅÂØπË±°ÁöÑÊåÅÊúâÁ∫øÁ®ãÊòØÂΩìÂâçÁ∫øÁ®ãÈÇ£‰πàJVMÂèØ‰ª•Â∞ÜÂÖ∂ËÆ°Êï∞Âô®Âä†1ÔºåÂê¶ÂàôÈúÄË¶ÅÁ≠âÂæÖÔºåÁõ¥Ëá≥ÊåÅÊúâÁ∫øÁ®ãÈáäÊîæÈîÅ„ÄÇ</p>
<p>ÂΩìÊâßË°åmonitorexitÊó∂ÔºåJVMÂàôÈúÄË¶ÅÂ∞ÜÈîÅÂØπË±°ÁöÑËÆ°Êï∞Âô®Âáè1ÔºåËÆ°Êï∞Âô®Êï∞ÂÄº‰∏∫0‰ª£Ë°®ÈîÅÂ∑≤Ë¢´ÈáäÊîæ„ÄÇ</p>
</blockquote>
<h3 id="Áã¨‰∫´ÈîÅ-amp-ÂÖ±‰∫´ÈîÅ"><a href="#Áã¨‰∫´ÈîÅ-amp-ÂÖ±‰∫´ÈîÅ" class="headerlink" title="Áã¨‰∫´ÈîÅ &amp; ÂÖ±‰∫´ÈîÅ"></a>Áã¨‰∫´ÈîÅ &amp; ÂÖ±‰∫´ÈîÅ</h3><p>Áã¨‰∫´ÈîÅ‰πüÂè´Êéí‰ªñÈîÅÔºåÊòØÊåáËØ•ÈîÅ‰∏ÄÊ¨°Âè™ËÉΩË¢´‰∏Ä‰∏™Á∫øÁ®ãÊâÄÊåÅÊúâ„ÄÇÂ¶ÇÊûúÁ∫øÁ®ãTÂØπÊï∞ÊçÆAÂä†‰∏äÊéíÂÆÉÈîÅÂêéÔºåÂàôÂÖ∂‰ªñÁ∫øÁ®ã‰∏çËÉΩÂÜçÂØπAÂä†‰ªª‰ΩïÁ±ªÂûãÁöÑÈîÅ„ÄÇËé∑ÂæóÊéíÂÆÉÈîÅÁöÑÁ∫øÁ®ãÂç≥ËÉΩËØªÊï∞ÊçÆÂèàËÉΩ‰øÆÊîπÊï∞ÊçÆ„ÄÇJDK‰∏≠ÁöÑsynchronizedÂíåJUC‰∏≠LockÁöÑÂÆûÁé∞Á±ªÂ∞±ÊòØ‰∫íÊñ•ÈîÅ„ÄÇ</p>
<p>ÂÖ±‰∫´ÈîÅÊòØÊåáËØ•ÈîÅÂèØË¢´Â§ö‰∏™Á∫øÁ®ãÊâÄÊåÅÊúâ„ÄÇÂ¶ÇÊûúÁ∫øÁ®ãTÂØπÊï∞ÊçÆAÂä†‰∏äÂÖ±‰∫´ÈîÅÂêéÔºåÂàôÂÖ∂‰ªñÁ∫øÁ®ãÂè™ËÉΩÂØπAÂÜçÂä†ÂÖ±‰∫´ÈîÅÔºå‰∏çËÉΩÂä†ÊéíÂÆÉÈîÅ„ÄÇËé∑ÂæóÂÖ±‰∫´ÈîÅÁöÑÁ∫øÁ®ãÂè™ËÉΩËØªÊï∞ÊçÆÔºå‰∏çËÉΩ‰øÆÊîπÊï∞ÊçÆ„ÄÇ</p>
<p>Áã¨‰∫´ÈîÅ‰∏éÂÖ±‰∫´ÈîÅ‰πüÊòØÈÄöËøáAQSÊù•ÂÆûÁé∞ÁöÑÔºåÈÄöËøáÂÆûÁé∞‰∏çÂêåÁöÑÊñπÊ≥ïÔºåÊù•ÂÆûÁé∞Áã¨‰∫´ÊàñËÄÖÂÖ±‰∫´„ÄÇ</p>
<h2 id="Lock-amp-Condition"><a href="#Lock-amp-Condition" class="headerlink" title="Lock &amp; Condition"></a>Lock &amp; Condition</h2><p>Âú®‰º†ÁªüÁöÑsynchronized‰∏≠ÔºåÂèØ‰ª•ÈÄöËøáwait/notify/notifyAllËøõË°åÁ≠âÂæÖÈÄöÁü•Êìç‰ΩúÔºå‰ΩÜsynchronizedÂè™Êèê‰æõ‰∫Ü‰∏Ä‰∏™ÂêåÊ≠•ÈòüÂàóÂíå‰∏Ä‰∏™Á≠âÂæÖ/ÈÄöÁü•ÈòüÂàóÔºåLockÂàôÊèê‰æõ‰∫Ü‰∏Ä‰∏™ÂêåÊ≠•ÈòüÂàóÂíåÂ§ö‰∏™Á≠âÂæÖ/ÈÄöÁü•ÈòüÂàóÊ®°Âûã„ÄÇ</p>
<p>ConditionÂØπË±°ÊòØ‰ªéLock‰∏≠Ëé∑ÂèñÔºåÂÖ∂ËøîÂõûÁöÑÂÆûÈôÖ‰∏äÊòØAQSÁöÑÂÜÖÈÉ®Á±ªConditionObjectÔºåÂõ†‰∏∫ConditionÊú∫Âà∂‰æùËµñ‰∫éAQSÂü∫‰∫éÁä∂ÊÄÅÁöÑÂêåÊ≠•Êú∫Âà∂„ÄÇÂú®‰ΩøÁî®Êó∂ÔºåÂèØ‰ª•ÂàõÂª∫Â§ö‰∏™ConditionÂØπË±°ÔºåÊØè‰∏™ConditionÂØπË±°ÈÉΩÂØπÂ∫î‰∏Ä‰∏™Á≠âÂæÖÈòüÂàóÔºåÈòüÂàó‰∏≠ÁöÑÊï∞ÊçÆÊòØAQSÁöÑNodeËäÇÁÇπÁ±ªÂûã„ÄÇ</p>
<p>ÂΩìË∞ÉÁî®await()ÊñπÊ≥ïÊó∂ÔºåÂõ†‰∏∫ÂΩìÂâçÁ∫øÁ®ã‰∏ÄÂÆöÁöÑËé∑Âèñ‰∫ÜLockÈîÅÁöÑÁ∫øÁ®ãÔºå‰πüÂ∞±ÁÆóÂêåÊ≠•ÈòüÂàóÁöÑÂ§¥ËäÇÁÇπÔºåÊâÄ‰ª•‰ºöÊääËøô‰∏™ËäÇÁÇπ‰ªéÂêåÊ≠•ÈòüÂàó‰∏≠ÁßªÈô§ÔºåÊûÑÈÄ†‰∏Ä‰∏™Êñ∞ÁöÑËäÇÁÇπÂπ∂Âä†ÂÖ•Âà∞Á≠âÂæÖÈòüÂàó‰∏≠(Ê≤°ÊúâÂà©Áî®casÔºåÂõ†‰∏∫ÂΩìÂâçÁ∫øÁ®ãÂ∞±Êï∞Ëé∑ÂèñÈîÅÁöÑÁ∫øÁ®ã)ÔºåÂΩìË∞ÉÁî®signal()/signalAll()Êó∂ÔºåÂ∞ÜÁ≠âÂæÖÈòüÂàó‰∏≠ÁöÑÂΩìÂâçÁ∫øÁ®ãËäÇÁÇπÁßªÈô§ÔºåÈáçÊñ∞Âä†ÂÖ•Âà∞ÂêåÊ≠•ÈòüÂàóËøõË°åÂêåÊ≠•Áä∂ÊÄÅÁöÑÁ´û‰∫âÔºàÂ¶ÇÊûúÊòØÈùûÂÖ¨Âπ≥ÈîÅÔºåÂàôËøõË°åÂêåÊ≠•Áä∂ÊÄÅÁöÑÊä¢Âç†ÔºåÂ¶ÇÊûúÊä¢Âç†Â§±Ë¥•ÔºåÂàôÂä†ÂÖ•Âà∞ÂêåÊ≠•ÈòüÂàóÂ∞æÈÉ®ÔºåÂ¶ÇÊûúÊòØÂÖ¨Âπ≥ÈîÅÔºåÈÇ£‰πàÂ∞±ËÄÅËÄÅÂÆûÂÆûÁöÑÂà©Áî®casÂ∞ÜËäÇÁÇπÂä†ÂÖ•Âà∞ÂêåÊ≠•ÈòüÂàóÁöÑÂ∞æÈÉ®Ôºâ</p>
<h2 id="ËÆ©Á∫øÁ®ãÁ≠âÂæÖ-amp-Âî§ÈÜíÁöÑÊñπÊ≥ï"><a href="#ËÆ©Á∫øÁ®ãÁ≠âÂæÖ-amp-Âî§ÈÜíÁöÑÊñπÊ≥ï" class="headerlink" title="ËÆ©Á∫øÁ®ãÁ≠âÂæÖ&amp;Âî§ÈÜíÁöÑÊñπÊ≥ï"></a>ËÆ©Á∫øÁ®ãÁ≠âÂæÖ&amp;Âî§ÈÜíÁöÑÊñπÊ≥ï</h2><ul>
<li>ÊñπÂºè‰∏ÄÔºö‰ΩøÁî® Object ‰∏≠ÁöÑ wait() ÊñπÊ≥ïËÆ©Á∫øÁ®ãÁ≠âÂæÖÔºå‰ΩøÁî® Object ‰∏≠ÁöÑ notify() ÊñπÊ≥ïÂî§ÈÜíÁ∫øÁ®ã</li>
<li>ÊñπÂºè‰∫åÔºö‰ΩøÁî® JUC ÂåÖ‰∏≠ Condition ÁöÑ await() ÊñπÊ≥ïËÆ©Á∫øÁ®ãÁ≠âÂæÖÔºå‰ΩøÁî® signal() ÊñπÊ≥ïÂî§ÈÜíÁ∫øÁ®ã</li>
<li>ÊñπÂºè‰∏âÔºöLockSupport Á±ªÂèØ‰ª•ÈòªÂ°ûÂΩìÂâçÁ∫øÁ®ã‰ª•ÂèäÂî§ÈÜíÊåáÂÆöË¢´ÈòªÂ°ûÁöÑÁ∫øÁ®ã„ÄÇ</li>
</ul>
<p><code>Object.wait()</code>„ÄÅ<code>Object.notify()</code>ÊñπÊ≥ïÂøÖÈ°ªÂÜç<code>synchronized</code>‰øÆÈ•∞ÁöÑ‰ª£Á†ÅÂùó‰∏≠ÊâçËÉΩÊ≠£Â∏∏‰ΩøÁî®ÔºåÂê¶Âàô‰ºöÊä•ÂºÇÂ∏∏(<code>ËØ≠Ê≥ï‰∏ç‰ºöÊòæÁ§∫ÊúâÈîôËØØ</code>)</p>
<p>ConditionÈúÄË¶ÅÂú®ReentrantLock‰∏ã‰ΩøÁî®Ôºå‰πüÂ∞±ÊòØÈúÄË¶Å‰∏äÈîÅÂíåÈáäÊîæÈîÅÔºåÂê¶Âàô‰πü‰ºöÊä•<code>java.lang.IllegalMonitorStateException</code></p>
<h2 id="LockSupport"><a href="#LockSupport" class="headerlink" title="LockSupport"></a>LockSupport</h2><p>LookSupport ÊòØÁî®Êù•ÂàõÂª∫ÈîÅÂíåÂÖ∂‰ªñÂêåÊ≠•Á±ªÁöÑÁ∫øÁ®ãÈòªÂ°ûÂéüËØ≠„ÄÇ</p>
<p>LookSupport ÊòØ‰∏Ä‰∏™Á∫øÁ®ãÈòªÂ°ûÂ∑•ÂÖ∑Á±ªÔºåÊâÄÊúâÁöÑÊñπÊ≥ïÈÉΩÊòØÈùôÊÄÅÊñπÊ≥ïÔºåÂèØ‰ª•ËÆ©Á∫øÁ®ãÂú®‰ªªÊÑè‰ΩçÁΩÆÈòªÂ°ûÔºåÈòªÂ°û‰πãÂêé‰πüÊúâÂØπÂ∫îÁöÑÂî§ÈÜíÊñπÊ≥ï„ÄÇ</p>
<p>LookSupport Ë∞ÉÁî®ÁöÑÊòØ UnsafeÁöÑnative ‰ª£Á†Å„ÄÇ</p>
<p>ÈÄöËøá parkÔºàÔºâÂíå unparkÔºàÔºâÊñπÊ≥ïÊù•ÂÆûÁé∞ÔºåÁ∫øÁ®ãÁöÑÈòªÂ°ûÂíåÈáäÊîæÊìç‰Ωú„ÄÇ</p>
<p>LockSupportÂ∞±ÊòØÈÄöËøáÊéßÂà∂ÂèòÈáè<code>_counter</code>ÔºàÁ±ª‰ºº‰∫épemitËÆ∏ÂèØËØÅÔºåÈªòËÆ§‰∏∫0ÔºâÊù•ÂØπÁ∫øÁ®ãÈòªÂ°ûÂî§ÈÜíËøõË°åÊéßÂà∂ÁöÑ„ÄÇÂéüÁêÜÊúâÁÇπÁ±ª‰ºº‰∫é‰ø°Âè∑ÈáèÊú∫Âà∂„ÄÇ</p>
<ul>
<li>ÂΩìË∞ÉÁî®<code>park()</code>ÊñπÊ≥ïÊó∂Ôºå‰ºöÂ∞Ü_counterÁΩÆ‰∏∫0ÔºåÂêåÊó∂Âà§Êñ≠ÂâçÂÄºÔºåÁ≠â‰∫é1ËØ¥ÊòéÂâçÈù¢Ë¢´<code>unpark</code>Ëøá,ÂàôÁõ¥Êé•ÈÄÄÂá∫ÔºåÂê¶ÂàôÂ∞Ü‰ΩøËØ•Á∫øÁ®ãÈòªÂ°û„ÄÇ</li>
<li>ÂΩìË∞ÉÁî®<code>unpark()</code>ÊñπÊ≥ïÊó∂Ôºå‰ºöÂ∞Ü_counterÁΩÆ‰∏∫1ÔºåÂêåÊó∂Âà§Êñ≠ÂâçÂÄºÔºåÂ∞è‰∫é1‰ºöËøõË°åÁ∫øÁ®ãÂî§ÈÜíÔºåÂê¶ÂàôÁõ¥Êé•ÈÄÄÂá∫„ÄÇ<br>ÂΩ¢Ë±°ÁöÑÁêÜËß£ÔºåÁ∫øÁ®ãÈòªÂ°ûÈúÄË¶ÅÊ∂àËÄóÂá≠ËØÅ(permit)ÔºåËøô‰∏™Âá≠ËØÅÊúÄÂ§öÂè™Êúâ1‰∏™„ÄÇÂΩìË∞ÉÁî®parkÊñπÊ≥ïÊó∂ÔºåÂ¶ÇÊûúÊúâÂá≠ËØÅÔºåÂàô‰ºöÁõ¥Êé•Ê∂àËÄóÊéâËøô‰∏™Âá≠ËØÅÁÑ∂ÂêéÊ≠£Â∏∏ÈÄÄÂá∫Ôºõ‰ΩÜÊòØÂ¶ÇÊûúÊ≤°ÊúâÂá≠ËØÅÔºåÂ∞±ÂøÖÈ°ªÈòªÂ°ûÁ≠âÂæÖÂá≠ËØÅÂèØÁî®ÔºõËÄåunparkÂàôÁõ∏ÂèçÔºåÂÆÉ‰ºöÂ¢ûÂä†‰∏Ä‰∏™Âá≠ËØÅÔºå‰ΩÜÂá≠ËØÅÊúÄÂ§öÂè™ËÉΩÊúâ1‰∏™„ÄÇ</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">    Thread a = <span class="keyword">new</span> Thread(() -&gt; &#123;</span><br><span class="line">        System.out.println(Thread.currentThread().getName() + <span class="string">&quot;\t&quot;</span> + <span class="string">&quot;----- come in&quot;</span>);</span><br><span class="line">        LockSupport.park();</span><br><span class="line">        System.out.println(Thread.currentThread().getName() + <span class="string">&quot;\t&quot;</span> + <span class="string">&quot;----- Ë¢´Âî§ÈÜí&quot;</span>);</span><br><span class="line">    &#125;, <span class="string">&quot;a&quot;</span>);</span><br><span class="line">    a.start();</span><br><span class="line"></span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        TimeUnit.SECONDS.sleep(<span class="number">3L</span>);</span><br><span class="line">    &#125; <span class="keyword">catch</span> (InterruptedException e) &#123;</span><br><span class="line">        e.printStackTrace();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    Thread b = <span class="keyword">new</span> Thread(() -&gt; &#123;</span><br><span class="line">        LockSupport.unpark(a);</span><br><span class="line">        System.out.println(Thread.currentThread().getName() + <span class="string">&quot;\t&quot;</span> + <span class="string">&quot;----- ÈÄöÁü• a&quot;</span>);</span><br><span class="line">    &#125;, <span class="string">&quot;b&quot;</span>);</span><br><span class="line">    b.start();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">a	----- come in</span><br><span class="line">b	----- ÈÄöÁü• a </span><br><span class="line">a	----- Ë¢´Âî§ÈÜí</span><br><span class="line">    </span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">    Thread t1 = <span class="keyword">new</span> Thread(() -&gt; &#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            TimeUnit.SECONDS.sleep(<span class="number">1L</span>);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (InterruptedException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        System.out.println(Thread.currentThread().getName() + <span class="string">&quot;\t&quot;</span> + System.currentTimeMillis() + <span class="string">&quot;\t&quot;</span> + <span class="string">&quot;----- come in&quot;</span>);</span><br><span class="line">        LockSupport.park();</span><br><span class="line">        System.out.println(Thread.currentThread().getName() + <span class="string">&quot;\t&quot;</span> + System.currentTimeMillis() + <span class="string">&quot;\t&quot;</span> + <span class="string">&quot;----- Ë¢´Âî§ÈÜí&quot;</span>);</span><br><span class="line">    &#125;, <span class="string">&quot;t1&quot;</span>);</span><br><span class="line">    t1.start();</span><br><span class="line"></span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        TimeUnit.SECONDS.sleep(<span class="number">3L</span>);</span><br><span class="line">    &#125; <span class="keyword">catch</span> (InterruptedException e) &#123;</span><br><span class="line">        e.printStackTrace();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    LockSupport.unpark(t1);</span><br><span class="line">    System.out.println(Thread.currentThread().getName() + <span class="string">&quot;\t&quot;</span> + System.currentTimeMillis() + <span class="string">&quot;----- unpark over&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">t1	<span class="number">1612934983962</span>	----- come in</span><br><span class="line">main	<span class="number">1612934985962</span>----- unpark over</span><br><span class="line">t1	<span class="number">1612934985962</span>	----- Ë¢´Âî§ÈÜí</span><br></pre></td></tr></table></figure>

<h3 id="‰∏∫‰ªÄ‰πàÂèØ‰ª•ÂÖàÂî§ÈÜíÁ∫øÁ®ãÂêéÈòªÂ°ûÁ∫øÁ®ãÔºü"><a href="#‰∏∫‰ªÄ‰πàÂèØ‰ª•ÂÖàÂî§ÈÜíÁ∫øÁ®ãÂêéÈòªÂ°ûÁ∫øÁ®ãÔºü" class="headerlink" title="‰∏∫‰ªÄ‰πàÂèØ‰ª•ÂÖàÂî§ÈÜíÁ∫øÁ®ãÂêéÈòªÂ°ûÁ∫øÁ®ãÔºü"></a>‰∏∫‰ªÄ‰πàÂèØ‰ª•ÂÖàÂî§ÈÜíÁ∫øÁ®ãÂêéÈòªÂ°ûÁ∫øÁ®ãÔºü</h3><p>Âõ†‰∏∫unparkËé∑Âæó‰∫Ü‰∏Ä‰∏™Âá≠ËØÅ,‰πãÂêéË∞ÉÁî®parkÂõ†‰∏∫ÊúâÂá≠ËØÅÊ∂àË¥πÔºåÊïÖ‰∏ç‰ºöÈòªÂ°û„ÄÇ</p>
<h3 id="‰∏∫‰ªÄ‰πàÂî§ÈÜí‰∏§Ê¨°ÂêéÈòªÂ°û‰∏§Ê¨°‰ºöÈòªÂ°ûÁ∫øÁ®ã„ÄÇ"><a href="#‰∏∫‰ªÄ‰πàÂî§ÈÜí‰∏§Ê¨°ÂêéÈòªÂ°û‰∏§Ê¨°‰ºöÈòªÂ°ûÁ∫øÁ®ã„ÄÇ" class="headerlink" title="‰∏∫‰ªÄ‰πàÂî§ÈÜí‰∏§Ê¨°ÂêéÈòªÂ°û‰∏§Ê¨°‰ºöÈòªÂ°ûÁ∫øÁ®ã„ÄÇ"></a>‰∏∫‰ªÄ‰πàÂî§ÈÜí‰∏§Ê¨°ÂêéÈòªÂ°û‰∏§Ê¨°‰ºöÈòªÂ°ûÁ∫øÁ®ã„ÄÇ</h3><p>Âõ†‰∏∫Âá≠ËØÅÁöÑÊï∞ÈáèÊúÄÂ§ö‰∏∫1ÔºåËøûÁª≠Ë∞ÉÁî®‰∏§Ê¨°unparkÂíåË∞ÉÁî®‰∏ÄÊ¨°unparkÊïàÊûú‰∏ÄÊ†∑ÔºåÂè™‰ºöÂ¢ûÂä†‰∏Ä‰∏™Âá≠ËØÅÔºõËÄåË∞ÉÁî®‰∏§Ê¨°parkÂç¥ÈúÄË¶ÅÊ∂àË¥π‰∏§‰∏™Âá≠ËØÅ„ÄÇ</p>
<h2 id="ThreadLocal"><a href="#ThreadLocal" class="headerlink" title="ThreadLocal"></a>ThreadLocal</h2><p><a target="_blank" rel="noopener" href="https://www.jianshu.com/p/377bb840802f">https://www.jianshu.com/p/377bb840802f</a></p>
<p><a target="_blank" rel="noopener" href="https://www.cnblogs.com/wupeixuan/p/12638203.html">https://www.cnblogs.com/wupeixuan/p/12638203.html</a></p>
<p>ÈÄöÂ∏∏ÊÉÖÂÜµ‰∏ãÔºåÊàë‰ª¨ÂàõÂª∫ÁöÑÂèòÈáèÊòØÂèØ‰ª•Ë¢´‰ªª‰Ωï‰∏Ä‰∏™Á∫øÁ®ãËÆøÈóÆÂπ∂‰øÆÊîπÁöÑ„ÄÇÂ¶ÇÊûúÊÉ≥ÂÆûÁé∞ÊØè‰∏Ä‰∏™Á∫øÁ®ãÈÉΩÊúâËá™Â∑±ÁöÑ‰∏ìÂ±ûÊú¨Âú∞ÂèòÈáèËØ•Â¶Ç‰ΩïËß£ÂÜ≥Âë¢ÔºüJDK ‰∏≠Êèê‰æõÁöÑ<code>ThreadLocal</code>Á±ªÊ≠£ÊòØ‰∏∫‰∫ÜËß£ÂÜ≥ËøôÊ†∑ÁöÑÈóÆÈ¢ò„ÄÇ</p>
<p> <strong><code>ThreadLocal</code>Á±ª‰∏ªË¶ÅËß£ÂÜ≥ÁöÑÂ∞±ÊòØËÆ©ÊØè‰∏™Á∫øÁ®ãÁªëÂÆöËá™Â∑±ÁöÑÂÄºÔºåÂèØ‰ª•Â∞Ü<code>ThreadLocal</code>Á±ªÂΩ¢Ë±°ÁöÑÊØîÂñªÊàêÂ≠òÊîæÊï∞ÊçÆÁöÑÁõíÂ≠êÔºåÁõíÂ≠ê‰∏≠ÂèØ‰ª•Â≠òÂÇ®ÊØè‰∏™Á∫øÁ®ãÁöÑÁßÅÊúâÊï∞ÊçÆ„ÄÇ</strong></p>
<p>Â¶ÇÊûú‰Ω†ÂàõÂª∫‰∫Ü‰∏Ä‰∏™<code>ThreadLocal</code>ÂèòÈáèÔºåÈÇ£‰πàËÆøÈóÆËøô‰∏™ÂèòÈáèÁöÑÊØè‰∏™Á∫øÁ®ãÈÉΩ‰ºöÊúâËøô‰∏™ÂèòÈáèÁöÑÊú¨Âú∞ÂâØÊú¨ÔºåËøô‰πüÊòØ<code>ThreadLocal</code>ÂèòÈáèÂêçÁöÑÁî±Êù•„ÄÇ‰ªñ‰ª¨ÂèØ‰ª•‰ΩøÁî® <code>getÔºàÔºâ</code> Âíå <code>setÔºàÔºâ</code> ÊñπÊ≥ïÊù•Ëé∑ÂèñÈªòËÆ§ÂÄºÊàñÂ∞ÜÂÖ∂ÂÄºÊõ¥Êîπ‰∏∫ÂΩìÂâçÁ∫øÁ®ãÊâÄÂ≠òÁöÑÂâØÊú¨ÁöÑÂÄºÔºå‰ªéËÄåÈÅøÂÖç‰∫ÜÁ∫øÁ®ãÂÆâÂÖ®ÈóÆÈ¢ò„ÄÇ</p>
<h3 id="Á§∫‰æã"><a href="#Á§∫‰æã" class="headerlink" title="Á§∫‰æã"></a>Á§∫‰æã</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.text.SimpleDateFormat;</span><br><span class="line"><span class="keyword">import</span> java.util.Random;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ThreadLocalExample</span> <span class="keyword">implements</span> <span class="title">Runnable</span></span>&#123;</span><br><span class="line"></span><br><span class="line">     <span class="comment">// SimpleDateFormat ‰∏çÊòØÁ∫øÁ®ãÂÆâÂÖ®ÁöÑÔºåÊâÄ‰ª•ÊØè‰∏™Á∫øÁ®ãÈÉΩË¶ÅÊúâËá™Â∑±Áã¨Á´ãÁöÑÂâØÊú¨</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> ThreadLocal&lt;SimpleDateFormat&gt; formatter = ThreadLocal.withInitial(() -&gt; <span class="keyword">new</span> SimpleDateFormat(<span class="string">&quot;yyyyMMdd HHmm&quot;</span>));</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> InterruptedException </span>&#123;</span><br><span class="line">        ThreadLocalExample obj = <span class="keyword">new</span> ThreadLocalExample();</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span> ; i&lt;<span class="number">10</span>; i++)&#123;</span><br><span class="line">            Thread t = <span class="keyword">new</span> Thread(obj, <span class="string">&quot;&quot;</span>+i);</span><br><span class="line">            Thread.sleep(<span class="keyword">new</span> Random().nextInt(<span class="number">1000</span>));</span><br><span class="line">            t.start();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;Thread Name= &quot;</span>+Thread.currentThread().getName()+<span class="string">&quot; default Formatter = &quot;</span>+formatter.get().toPattern());</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            Thread.sleep(<span class="keyword">new</span> Random().nextInt(<span class="number">1000</span>));</span><br><span class="line">        &#125; <span class="keyword">catch</span> (InterruptedException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">//formatter pattern is changed here by thread, but it won&#x27;t reflect to other threads</span></span><br><span class="line">        formatter.set(<span class="keyword">new</span> SimpleDateFormat());</span><br><span class="line"></span><br><span class="line">        System.out.println(<span class="string">&quot;Thread Name= &quot;</span>+Thread.currentThread().getName()+<span class="string">&quot; formatter = &quot;</span>+formatter.get().toPattern());</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">Thread Name= <span class="number">0</span> <span class="keyword">default</span> Formatter = yyyyMMdd HHmm</span><br><span class="line">Thread Name= <span class="number">0</span> formatter = yy-M-d ah:mm</span><br><span class="line">Thread Name= <span class="number">1</span> <span class="keyword">default</span> Formatter = yyyyMMdd HHmm</span><br><span class="line">Thread Name= <span class="number">2</span> <span class="keyword">default</span> Formatter = yyyyMMdd HHmm</span><br><span class="line">Thread Name= <span class="number">1</span> formatter = yy-M-d ah:mm</span><br><span class="line">Thread Name= <span class="number">3</span> <span class="keyword">default</span> Formatter = yyyyMMdd HHmm</span><br><span class="line">Thread Name= <span class="number">2</span> formatter = yy-M-d ah:mm</span><br><span class="line">Thread Name= <span class="number">4</span> <span class="keyword">default</span> Formatter = yyyyMMdd HHmm</span><br><span class="line">Thread Name= <span class="number">3</span> formatter = yy-M-d ah:mm</span><br><span class="line">Thread Name= <span class="number">4</span> formatter = yy-M-d ah:mm</span><br><span class="line">Thread Name= <span class="number">5</span> <span class="keyword">default</span> Formatter = yyyyMMdd HHmm</span><br><span class="line">Thread Name= <span class="number">5</span> formatter = yy-M-d ah:mm</span><br><span class="line">Thread Name= <span class="number">6</span> <span class="keyword">default</span> Formatter = yyyyMMdd HHmm</span><br><span class="line">Thread Name= <span class="number">6</span> formatter = yy-M-d ah:mm</span><br><span class="line">Thread Name= <span class="number">7</span> <span class="keyword">default</span> Formatter = yyyyMMdd HHmm</span><br><span class="line">Thread Name= <span class="number">7</span> formatter = yy-M-d ah:mm</span><br><span class="line">Thread Name= <span class="number">8</span> <span class="keyword">default</span> Formatter = yyyyMMdd HHmm</span><br><span class="line">Thread Name= <span class="number">9</span> <span class="keyword">default</span> Formatter = yyyyMMdd HHmm</span><br><span class="line">Thread Name= <span class="number">8</span> formatter = yy-M-d ah:mm</span><br><span class="line">Thread Name= <span class="number">9</span> formatter = yy-M-d ah:mm</span><br></pre></td></tr></table></figure>

<p>‰ªéËæìÂá∫‰∏≠ÂèØ‰ª•ÁúãÂá∫ÔºåThread-0 Â∑≤ÁªèÊîπÂèò‰∫Ü formatter ÁöÑÂÄºÔºå‰ΩÜ‰ªçÁÑ∂ÊòØ thread-2 ÈªòËÆ§Ê†ºÂºèÂåñÁ®ãÂ∫è‰∏éÂàùÂßãÂåñÂÄºÁõ∏ÂêåÔºåÂÖ∂‰ªñÁ∫øÁ®ã‰πü‰∏ÄÊ†∑„ÄÇ</p>
<p>‰∏äÈù¢Êúâ‰∏ÄÊÆµ‰ª£Á†ÅÁî®Âà∞‰∫ÜÂàõÂª∫ <code>ThreadLocal</code> ÂèòÈáèÁöÑÈÇ£ÊÆµ‰ª£Á†ÅÁî®Âà∞‰∫Ü Java8 ÁöÑÁü•ËØÜÔºåÂÆÉÁ≠â‰∫é‰∏ãÈù¢ËøôÊÆµ‰ª£Á†ÅÔºåÂ¶ÇÊûú‰Ω†ÂÜô‰∫Ü‰∏ãÈù¢ËøôÊÆµ‰ª£Á†ÅÁöÑËØùÔºåIDEA ‰ºöÊèêÁ§∫‰Ω†ËΩ¨Êç¢‰∏∫ Java8 ÁöÑÊ†ºÂºè(IDEA ÁúüÁöÑ‰∏çÈîôÔºÅ)„ÄÇÂõ†‰∏∫ ThreadLocal Á±ªÂú® Java 8 ‰∏≠Êâ©Â±ïÔºå‰ΩøÁî®‰∏Ä‰∏™Êñ∞ÁöÑÊñπÊ≥ï<code>withInitial()</code>ÔºåÂ∞Ü Supplier ÂäüËÉΩÊé•Âè£‰Ωú‰∏∫ÂèÇÊï∞„ÄÇ</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> ThreadLocal&lt;SimpleDateFormat&gt; formatter = <span class="keyword">new</span> ThreadLocal&lt;SimpleDateFormat&gt;()&#123;</span><br><span class="line">       <span class="meta">@Override</span></span><br><span class="line">       <span class="function"><span class="keyword">protected</span> SimpleDateFormat <span class="title">initialValue</span><span class="params">()</span></span></span><br><span class="line"><span class="function">       </span>&#123;</span><br><span class="line">           <span class="keyword">return</span> <span class="keyword">new</span> SimpleDateFormat(<span class="string">&quot;yyyyMMdd HHmm&quot;</span>);</span><br><span class="line">       &#125;</span><br><span class="line">   &#125;;</span><br></pre></td></tr></table></figure>

<h3 id="ÂéüÁêÜ-3"><a href="#ÂéüÁêÜ-3" class="headerlink" title="ÂéüÁêÜ"></a>ÂéüÁêÜ</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Thread</span> <span class="keyword">implements</span> <span class="title">Runnable</span> </span>&#123;</span><br><span class="line"> ......</span><br><span class="line"><span class="comment">//‰∏éÊ≠§Á∫øÁ®ãÊúâÂÖ≥ÁöÑThreadLocalÂÄº„ÄÇÁî±ThreadLocalÁ±ªÁª¥Êä§</span></span><br><span class="line">ThreadLocal.ThreadLocalMap threadLocals = <span class="keyword">null</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">//‰∏éÊ≠§Á∫øÁ®ãÊúâÂÖ≥ÁöÑInheritableThreadLocalÂÄº„ÄÇÁî±InheritableThreadLocalÁ±ªÁª¥Êä§</span></span><br><span class="line">ThreadLocal.ThreadLocalMap inheritableThreadLocals = <span class="keyword">null</span>;</span><br><span class="line"> ......</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>‰ªé‰∏äÈù¢<code>Thread</code>Á±ª Ê∫ê‰ª£Á†ÅÂèØ‰ª•ÁúãÂá∫<code>Thread</code> Á±ª‰∏≠Êúâ‰∏Ä‰∏™ <code>threadLocals</code> Âíå ‰∏Ä‰∏™ <code>inheritableThreadLocals</code> ÂèòÈáèÔºåÂÆÉ‰ª¨ÈÉΩÊòØ <code>ThreadLocalMap</code> Á±ªÂûãÁöÑÂèòÈáè,Êàë‰ª¨ÂèØ‰ª•Êää <code>ThreadLocalMap</code> ÁêÜËß£‰∏∫<code>ThreadLocal</code> Á±ªÂÆûÁé∞ÁöÑÂÆöÂà∂ÂåñÁöÑ <code>HashMap</code>„ÄÇÈªòËÆ§ÊÉÖÂÜµ‰∏ãËøô‰∏§‰∏™ÂèòÈáèÈÉΩÊòØ nullÔºåÂè™ÊúâÂΩìÂâçÁ∫øÁ®ãË∞ÉÁî® <code>ThreadLocal</code> Á±ªÁöÑ <code>set</code>Êàñ<code>get</code>ÊñπÊ≥ïÊó∂ÊâçÂàõÂª∫ÂÆÉ‰ª¨ÔºåÂÆûÈôÖ‰∏äË∞ÉÁî®Ëøô‰∏§‰∏™ÊñπÊ≥ïÁöÑÊó∂ÂÄôÔºåÊàë‰ª¨Ë∞ÉÁî®ÁöÑÊòØ<code>ThreadLocalMap</code>Á±ªÂØπÂ∫îÁöÑ <code>get()</code>„ÄÅ<code>set()</code>ÊñπÊ≥ï„ÄÇ</p>
<p><code>ThreadLocal</code>Á±ªÁöÑ<code>set()</code>ÊñπÊ≥ï</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">set</span><span class="params">(T value)</span> </span>&#123;</span><br><span class="line">    Thread t = Thread.currentThread();</span><br><span class="line">    ThreadLocalMap map = getMap(t);</span><br><span class="line">    <span class="keyword">if</span> (map != <span class="keyword">null</span>)</span><br><span class="line">        map.set(<span class="keyword">this</span>, value);</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">        createMap(t, value);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">ThreadLocalMap <span class="title">getMap</span><span class="params">(Thread t)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> t.threadLocals;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>ÈÄöËøá‰∏äÈù¢Ëøô‰∫õÂÜÖÂÆπÔºåÊàë‰ª¨Ë∂≥‰ª•ÈÄöËøáÁåúÊµãÂæóÂá∫ÁªìËÆ∫Ôºö<strong>ÊúÄÁªàÁöÑÂèòÈáèÊòØÊîæÂú®‰∫ÜÂΩìÂâçÁ∫øÁ®ãÁöÑ <code>ThreadLocalMap</code> ‰∏≠ÔºåÂπ∂‰∏çÊòØÂ≠òÂú® <code>ThreadLocal</code> ‰∏äÔºå<code>ThreadLocal</code> ÂèØ‰ª•ÁêÜËß£‰∏∫Âè™ÊòØ<code>ThreadLocalMap</code>ÁöÑÂ∞ÅË£ÖÔºå‰º†ÈÄí‰∫ÜÂèòÈáèÂÄº„ÄÇ</strong> <code>ThrealLocal</code> Á±ª‰∏≠ÂèØ‰ª•ÈÄöËøá<code>Thread.currentThread()</code>Ëé∑ÂèñÂà∞ÂΩìÂâçÁ∫øÁ®ãÂØπË±°ÂêéÔºåÁõ¥Êé•ÈÄöËøá<code>getMap(Thread t)</code>ÂèØ‰ª•ËÆøÈóÆÂà∞ËØ•Á∫øÁ®ãÁöÑ<code>ThreadLocalMap</code>ÂØπË±°„ÄÇ</p>
<p><strong>ÊØè‰∏™<code>Thread</code>‰∏≠ÈÉΩÂÖ∑Â§á‰∏Ä‰∏™<code>ThreadLocalMap</code>ÔºåËÄå<code>ThreadLocalMap</code>ÂèØ‰ª•Â≠òÂÇ®‰ª•<code>ThreadLocal</code>‰∏∫ key ÔºåObject ÂØπË±°‰∏∫ value ÁöÑÈîÆÂÄºÂØπ„ÄÇ</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">ThreadLocalMap(ThreadLocal&lt;?&gt; firstKey, Object firstValue) &#123;</span><br><span class="line"> ......</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>ÊØîÂ¶ÇÊàë‰ª¨Âú®Âêå‰∏Ä‰∏™Á∫øÁ®ã‰∏≠Â£∞Êòé‰∫Ü‰∏§‰∏™ <code>ThreadLocal</code> ÂØπË±°ÁöÑËØùÔºå‰ºö‰ΩøÁî® <code>Thread</code>ÂÜÖÈÉ®ÈÉΩÊòØ‰ΩøÁî®‰ªÖÊúâÈÇ£‰∏™<code>ThreadLocalMap</code> Â≠òÊîæÊï∞ÊçÆÁöÑÔºå<code>ThreadLocalMap</code>ÁöÑ key Â∞±ÊòØ <code>ThreadLocal</code>ÂØπË±°Ôºåvalue Â∞±ÊòØ <code>ThreadLocal</code> ÂØπË±°Ë∞ÉÁî®<code>set</code>ÊñπÊ≥ïËÆæÁΩÆÁöÑÂÄº„ÄÇ</p>
<p><img src="../img/java/12.png"></p>
<p><code>ThreadLocalMap</code>ÊòØ<code>ThreadLocal</code>ÁöÑÈùôÊÄÅÂÜÖÈÉ®Á±ª„ÄÇ</p>
<h3 id="ThreadLocal-ÂÜÖÂ≠òÊ≥ÑÈú≤ÈóÆÈ¢ò"><a href="#ThreadLocal-ÂÜÖÂ≠òÊ≥ÑÈú≤ÈóÆÈ¢ò" class="headerlink" title="ThreadLocal ÂÜÖÂ≠òÊ≥ÑÈú≤ÈóÆÈ¢ò"></a>ThreadLocal ÂÜÖÂ≠òÊ≥ÑÈú≤ÈóÆÈ¢ò</h3><p><code>ThreadLocalMap</code> ‰∏≠‰ΩøÁî®ÁöÑ key ‰∏∫ <code>ThreadLocal</code> ÁöÑÂº±ÂºïÁî®,ËÄå value ÊòØÂº∫ÂºïÁî®„ÄÇÊâÄ‰ª•ÔºåÂ¶ÇÊûú <code>ThreadLocal</code> Ê≤°ÊúâË¢´Â§ñÈÉ®Âº∫ÂºïÁî®ÁöÑÊÉÖÂÜµ‰∏ãÔºåÂú®ÂûÉÂúæÂõûÊî∂ÁöÑÊó∂ÂÄôÔºåkey ‰ºöË¢´Ê∏ÖÁêÜÊéâÔºåËÄå value ‰∏ç‰ºöË¢´Ê∏ÖÁêÜÊéâ„ÄÇËøôÊ†∑‰∏ÄÊù•Ôºå<code>ThreadLocalMap</code> ‰∏≠Â∞±‰ºöÂá∫Áé∞ key ‰∏∫ null ÁöÑ Entry„ÄÇÂÅáÂ¶ÇÊàë‰ª¨‰∏çÂÅö‰ªª‰ΩïÊé™ÊñΩÁöÑËØùÔºåvalue Ê∞∏ËøúÊó†Ê≥ïË¢´ GC ÂõûÊî∂ÔºåËøô‰∏™Êó∂ÂÄôÂ∞±ÂèØËÉΩ‰ºö‰∫ßÁîüÂÜÖÂ≠òÊ≥ÑÈú≤„ÄÇThreadLocalMap ÂÆûÁé∞‰∏≠Â∑≤ÁªèËÄÉËôë‰∫ÜËøôÁßçÊÉÖÂÜµÔºåÂú®Ë∞ÉÁî® <code>set()</code>„ÄÅ<code>get()</code>„ÄÅ<code>remove()</code> ÊñπÊ≥ïÁöÑÊó∂ÂÄôÔºå‰ºöÊ∏ÖÁêÜÊéâ key ‰∏∫ null ÁöÑËÆ∞ÂΩï„ÄÇ‰ΩøÁî®ÂÆå <code>ThreadLocal</code>ÊñπÊ≥ïÂêé ÊúÄÂ•ΩÊâãÂä®Ë∞ÉÁî®<code>remove()</code>ÊñπÊ≥ï</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">static</span> <span class="class"><span class="keyword">class</span> <span class="title">Entry</span> <span class="keyword">extends</span> <span class="title">WeakReference</span>&lt;<span class="title">ThreadLocal</span>&lt;?&gt;&gt; </span>&#123;</span><br><span class="line">    <span class="comment">/** The value associated with this ThreadLocal. */</span></span><br><span class="line">    Object value;</span><br><span class="line"></span><br><span class="line">    Entry(ThreadLocal&lt;?&gt; k, Object v) &#123;</span><br><span class="line">        <span class="keyword">super</span>(k);</span><br><span class="line">        value = v;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h2 id="Atomic-ÂéüÂ≠êÁ±ª"><a href="#Atomic-ÂéüÂ≠êÁ±ª" class="headerlink" title="Atomic ÂéüÂ≠êÁ±ª"></a>Atomic ÂéüÂ≠êÁ±ª</h2><p><code>Atomic</code> ÁøªËØëÊàê‰∏≠ÊñáÊòØÂéüÂ≠êÁöÑÊÑèÊÄù„ÄÇÂú®ÂåñÂ≠¶‰∏äÔºåÊàë‰ª¨Áü•ÈÅìÂéüÂ≠êÊòØÊûÑÊàê‰∏ÄËà¨Áâ©Ë¥®ÁöÑÊúÄÂ∞èÂçï‰ΩçÔºåÂú®ÂåñÂ≠¶ÂèçÂ∫î‰∏≠ÊòØ‰∏çÂèØÂàÜÂâ≤ÁöÑ„ÄÇÂú®Êàë‰ª¨ËøôÈáå Atomic ÊòØÊåá‰∏Ä‰∏™Êìç‰ΩúÊòØ‰∏çÂèØ‰∏≠Êñ≠ÁöÑ„ÄÇÂç≥‰ΩøÊòØÂú®Â§ö‰∏™Á∫øÁ®ã‰∏ÄËµ∑ÊâßË°åÁöÑÊó∂ÂÄôÔºå‰∏Ä‰∏™Êìç‰Ωú‰∏ÄÊó¶ÂºÄÂßãÔºåÂ∞±‰∏ç‰ºöË¢´ÂÖ∂‰ªñÁ∫øÁ®ãÂπ≤Êâ∞„ÄÇ</p>
<p>ÊâÄ‰ª•ÔºåÊâÄË∞ìÂéüÂ≠êÁ±ªËØ¥ÁÆÄÂçïÁÇπÂ∞±ÊòØÂÖ∑ÊúâÂéüÂ≠ê/ÂéüÂ≠êÊìç‰ΩúÁâπÂæÅÁöÑÁ±ª„ÄÇ</p>
<p>Âπ∂ÂèëÂåÖ <code>java.util.concurrent</code> ÁöÑÂéüÂ≠êÁ±ªÈÉΩÂ≠òÊîæÂú®<code>java.util.concurrent.atomic</code>‰∏ã„ÄÇ</p>
<p><strong>Âü∫Êú¨Á±ªÂûã</strong></p>
<p>‰ΩøÁî®ÂéüÂ≠êÁöÑÊñπÂºèÊõ¥Êñ∞Âü∫Êú¨Á±ªÂûã</p>
<ul>
<li><code>AtomicInteger</code>ÔºöÊï¥ÂΩ¢ÂéüÂ≠êÁ±ª</li>
<li><code>AtomicLong</code>ÔºöÈïøÊï¥ÂûãÂéüÂ≠êÁ±ª</li>
<li><code>AtomicBoolean</code>ÔºöÂ∏ÉÂ∞îÂûãÂéüÂ≠êÁ±ª</li>
</ul>
<p><strong>Êï∞ÁªÑÁ±ªÂûã</strong></p>
<p>‰ΩøÁî®ÂéüÂ≠êÁöÑÊñπÂºèÊõ¥Êñ∞Êï∞ÁªÑÈáåÁöÑÊüê‰∏™ÂÖÉÁ¥†</p>
<ul>
<li><code>AtomicIntegerArray</code>ÔºöÊï¥ÂΩ¢Êï∞ÁªÑÂéüÂ≠êÁ±ª</li>
<li><code>AtomicLongArray</code>ÔºöÈïøÊï¥ÂΩ¢Êï∞ÁªÑÂéüÂ≠êÁ±ª</li>
<li><code>AtomicReferenceArray</code>ÔºöÂºïÁî®Á±ªÂûãÊï∞ÁªÑÂéüÂ≠êÁ±ª</li>
</ul>
<p><strong>ÂºïÁî®Á±ªÂûã</strong></p>
<ul>
<li><code>AtomicReference</code>ÔºöÂºïÁî®Á±ªÂûãÂéüÂ≠êÁ±ª</li>
<li><code>AtomicStampedReference</code>ÔºöÂéüÂ≠êÊõ¥Êñ∞Â∏¶ÊúâÁâàÊú¨Âè∑ÁöÑÂºïÁî®Á±ªÂûã„ÄÇËØ•Á±ªÂ∞ÜÊï¥Êï∞ÂÄº‰∏éÂºïÁî®ÂÖ≥ËÅîËµ∑Êù•ÔºåÂèØÁî®‰∫éËß£ÂÜ≥ÂéüÂ≠êÁöÑÊõ¥Êñ∞Êï∞ÊçÆÂíåÊï∞ÊçÆÁöÑÁâàÊú¨Âè∑ÔºåÂèØ‰ª•Ëß£ÂÜ≥‰ΩøÁî® CAS ËøõË°åÂéüÂ≠êÊõ¥Êñ∞Êó∂ÂèØËÉΩÂá∫Áé∞ÁöÑ ABA ÈóÆÈ¢ò„ÄÇ</li>
<li><code>AtomicMarkableReference</code> ÔºöÂéüÂ≠êÊõ¥Êñ∞Â∏¶ÊúâÊ†áËÆ∞‰ΩçÁöÑÂºïÁî®Á±ªÂûã</li>
</ul>
<p><strong>ÂØπË±°ÁöÑÂ±ûÊÄß‰øÆÊîπÁ±ªÂûã</strong></p>
<ul>
<li><code>AtomicIntegerFieldUpdater</code>ÔºöÂéüÂ≠êÊõ¥Êñ∞Êï¥ÂΩ¢Â≠óÊÆµÁöÑÊõ¥Êñ∞Âô®</li>
<li><code>AtomicLongFieldUpdater</code>ÔºöÂéüÂ≠êÊõ¥Êñ∞ÈïøÊï¥ÂΩ¢Â≠óÊÆµÁöÑÊõ¥Êñ∞Âô®</li>
<li><code>AtomicReferenceFieldUpdater</code>ÔºöÂéüÂ≠êÊõ¥Êñ∞ÂºïÁî®Á±ªÂûãÂ≠óÊÆµÁöÑÊõ¥Êñ∞Âô®</li>
</ul>
<h3 id="AtomicInteger-ÁöÑ‰ΩøÁî®"><a href="#AtomicInteger-ÁöÑ‰ΩøÁî®" class="headerlink" title="AtomicInteger ÁöÑ‰ΩøÁî®"></a>AtomicInteger ÁöÑ‰ΩøÁî®</h3><p><strong>AtomicInteger Á±ªÂ∏∏Áî®ÊñπÊ≥ï</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">public final int get() &#x2F;&#x2F;Ëé∑ÂèñÂΩìÂâçÁöÑÂÄº</span><br><span class="line">public final int getAndSet(int newValue)&#x2F;&#x2F;Ëé∑ÂèñÂΩìÂâçÁöÑÂÄºÔºåÂπ∂ËÆæÁΩÆÊñ∞ÁöÑÂÄº</span><br><span class="line">public final int getAndIncrement()&#x2F;&#x2F;Ëé∑ÂèñÂΩìÂâçÁöÑÂÄºÔºåÂπ∂Ëá™Â¢û</span><br><span class="line">public final int getAndDecrement() &#x2F;&#x2F;Ëé∑ÂèñÂΩìÂâçÁöÑÂÄºÔºåÂπ∂Ëá™Âáè</span><br><span class="line">public final int getAndAdd(int delta) &#x2F;&#x2F;Ëé∑ÂèñÂΩìÂâçÁöÑÂÄºÔºåÂπ∂Âä†‰∏äÈ¢ÑÊúüÁöÑÂÄº</span><br><span class="line">boolean compareAndSet(int expect, int update) &#x2F;&#x2F;Â¶ÇÊûúËæìÂÖ•ÁöÑÊï∞ÂÄºÁ≠â‰∫éÈ¢ÑÊúüÂÄºÔºåÂàô‰ª•ÂéüÂ≠êÊñπÂºèÂ∞ÜËØ•ÂÄºËÆæÁΩÆ‰∏∫ËæìÂÖ•ÂÄºÔºàupdateÔºâ</span><br><span class="line">public final void lazySet(int newValue)&#x2F;&#x2F;ÊúÄÁªàËÆæÁΩÆ‰∏∫newValue,‰ΩøÁî® lazySet ËÆæÁΩÆ‰πãÂêéÂèØËÉΩÂØºËá¥ÂÖ∂‰ªñÁ∫øÁ®ãÂú®‰πãÂêéÁöÑ‰∏ÄÂ∞èÊÆµÊó∂Èó¥ÂÜÖËøòÊòØÂèØ‰ª•ËØªÂà∞ÊóßÁöÑÂÄº„ÄÇ</span><br></pre></td></tr></table></figure>

<p><strong>AtomicInteger Á±ªÁöÑ‰ΩøÁî®Á§∫‰æã</strong></p>
<p>‰ΩøÁî® AtomicInteger ‰πãÂêéÔºå‰∏çÁî®ÂØπ increment() ÊñπÊ≥ïÂä†ÈîÅ‰πüÂèØ‰ª•‰øùËØÅÁ∫øÁ®ãÂÆâÂÖ®„ÄÇ</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">class AtomicIntegerTest &#123;</span><br><span class="line">        private AtomicInteger count &#x3D; new AtomicInteger();</span><br><span class="line">      &#x2F;&#x2F;‰ΩøÁî®AtomicInteger‰πãÂêéÔºå‰∏çÈúÄË¶ÅÂØπËØ•ÊñπÊ≥ïÂä†ÈîÅÔºå‰πüÂèØ‰ª•ÂÆûÁé∞Á∫øÁ®ãÂÆâÂÖ®„ÄÇ</span><br><span class="line">        public void increment() &#123;</span><br><span class="line">                  count.incrementAndGet();</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">       public int getCount() &#123;</span><br><span class="line">                return count.get();</span><br><span class="line">        &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="‰ªãÁªç‰∏Ä‰∏ã-AtomicInteger-Á±ªÁöÑÂéüÁêÜ"><a href="#‰ªãÁªç‰∏Ä‰∏ã-AtomicInteger-Á±ªÁöÑÂéüÁêÜ" class="headerlink" title="‰ªãÁªç‰∏Ä‰∏ã AtomicInteger Á±ªÁöÑÂéüÁêÜ"></a>‰ªãÁªç‰∏Ä‰∏ã AtomicInteger Á±ªÁöÑÂéüÁêÜ</h3><p>AtomicInteger Á±ªÁöÑÈÉ®ÂàÜÊ∫êÁ†ÅÔºö</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">&#x2F;&#x2F; setup to use Unsafe.compareAndSwapInt for updatesÔºàÊõ¥Êñ∞Êìç‰ΩúÊó∂Êèê‰æõ‚ÄúÊØîËæÉÂπ∂ÊõøÊç¢‚ÄùÁöÑ‰ΩúÁî®Ôºâ</span><br><span class="line">private static final Unsafe unsafe &#x3D; Unsafe.getUnsafe();</span><br><span class="line">private static final long valueOffset;</span><br><span class="line"></span><br><span class="line">static &#123;</span><br><span class="line">    try &#123;</span><br><span class="line">        valueOffset &#x3D; unsafe.objectFieldOffset</span><br><span class="line">            (AtomicInteger.class.getDeclaredField(&quot;value&quot;));</span><br><span class="line">    &#125; catch (Exception ex) &#123; throw new Error(ex); &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">private volatile int value;</span><br></pre></td></tr></table></figure>

<p>AtomicInteger Á±ª‰∏ªË¶ÅÂà©Áî® <strong>CAS (compare and swap) + volatile Âíå native ÊñπÊ≥ï</strong>Êù•‰øùËØÅÂéüÂ≠êÊìç‰ΩúÔºå‰ªéËÄåÈÅøÂÖç synchronized ÁöÑÈ´òÂºÄÈîÄÔºåÊâßË°åÊïàÁéáÂ§ß‰∏∫ÊèêÂçá„ÄÇ</p>
<p>CAS ÁöÑÂéüÁêÜÊòØÊãøÊúüÊúõÁöÑÂÄºÂíåÂéüÊú¨ÁöÑ‰∏Ä‰∏™ÂÄº‰ΩúÊØîËæÉÔºåÂ¶ÇÊûúÁõ∏ÂêåÂàôÊõ¥Êñ∞ÊàêÊñ∞ÁöÑÂÄº„ÄÇUnSafe Á±ªÁöÑ objectFieldOffset() ÊñπÊ≥ïÊòØ‰∏Ä‰∏™Êú¨Âú∞ÊñπÊ≥ïÔºåËøô‰∏™ÊñπÊ≥ïÊòØÁî®Êù•ÊãøÂà∞‚ÄúÂéüÊù•ÁöÑÂÄº‚ÄùÁöÑÂÜÖÂ≠òÂú∞ÂùÄÔºåËøîÂõûÂÄºÊòØ valueOffset„ÄÇÂè¶Â§ñ value ÊòØ‰∏Ä‰∏™ volatile ÂèòÈáèÔºåÂú®ÂÜÖÂ≠ò‰∏≠ÂèØËßÅÔºåÂõ†Ê≠§ JVM ÂèØ‰ª•‰øùËØÅ‰ªª‰ΩïÊó∂Âàª‰ªª‰ΩïÁ∫øÁ®ãÊÄªËÉΩÊãøÂà∞ËØ•ÂèòÈáèÁöÑÊúÄÊñ∞ÂÄº„ÄÇ</p>
<h3 id="AtomicInteger-‰∏∫‰ªÄ‰πàÁî®CASËÄå‰∏çÊòØsynchronized"><a href="#AtomicInteger-‰∏∫‰ªÄ‰πàÁî®CASËÄå‰∏çÊòØsynchronized" class="headerlink" title="AtomicInteger ‰∏∫‰ªÄ‰πàÁî®CASËÄå‰∏çÊòØsynchronized"></a>AtomicInteger ‰∏∫‰ªÄ‰πàÁî®CASËÄå‰∏çÊòØsynchronized</h3><p>synchronizedÈááÁî®ÁöÑÊòØÊÇ≤ËßÇÈîÅÔºåÊòØ‰∏ÄÁßçÁã¨Âç†ÈîÅÔºåÁã¨Âç†ÈîÅÂ∞±ÊÑèÂë≥ÁùÄ ÂÖ∂‰ªñÁ∫øÁ®ãÂè™ËÉΩ‰æùÈù†ÈòªÂ°û[Â∞±ÊòØÂÖ∂‰ªñÁ∫øÁ®ã‰∏çÂÅúÁöÑËØ¢ÈóÆ]Êù•Á≠âÂæÖÁ∫øÁ®ãÈáäÊîæÈîÅ„ÄÇËÄåÂú® CPU ËΩ¨Êç¢Á∫øÁ®ãÈòªÂ°ûÊó∂‰ºöÂºïËµ∑Á∫øÁ®ã‰∏ä‰∏ãÊñáÂàáÊç¢ÔºåÂΩìÊúâÂæàÂ§öÁ∫øÁ®ãÁ´û‰∫âÈîÅÁöÑÊó∂ÂÄôÔºå‰ºöÂºïËµ∑ CPU È¢ëÁπÅÁöÑ‰∏ä‰∏ãÊñáÂàáÊç¢ÂØºËá¥ÊïàÁéáÂæà‰Ωé</p>
<p>CASÈááÁî®ÁöÑÊòØ‰∏ÄÁßç‰πêËßÇÈîÅÁöÑÊú∫Âà∂ÔºåÂÆÉ‰∏ç‰ºöÈòªÂ°û‰ªª‰ΩïÁ∫øÁ®ãÔºåÊâÄ‰ª•Âú®ÊïàÁéá‰∏äÔºåÂÆÉ‰ºöÊØî synchronized Ë¶ÅÈ´ò„ÄÇÊâÄË∞ì‰πêËßÇÈîÅÂ∞±ÊòØÔºöÊØèÊ¨°‰∏çÂä†ÈîÅËÄåÊòØÂÅáËÆæÊ≤°ÊúâÂÜ≤Á™ÅËÄåÂéªÂÆåÊàêÊüêÈ°πÊìç‰ΩúÔºåÂ¶ÇÊûúÂõ†‰∏∫ÂÜ≤Á™ÅÂ§±Ë¥•Â∞±ÈáçËØïÔºåÁõ¥Âà∞ÊàêÂäü‰∏∫Ê≠¢„ÄÇ</p>
<h3 id="AtomicLong-ÂèØÂê¶Ë¢´-LongAdder-Êõø‰ª£Ôºü"><a href="#AtomicLong-ÂèØÂê¶Ë¢´-LongAdder-Êõø‰ª£Ôºü" class="headerlink" title="AtomicLong ÂèØÂê¶Ë¢´ LongAdder Êõø‰ª£Ôºü"></a>AtomicLong ÂèØÂê¶Ë¢´ LongAdder Êõø‰ª£Ôºü</h3><p>Êúâ‰∫ÜÊõ¥È´òÊïàÁöÑ <code>LongAdder</code>ÔºåÈÇ£<code> AtomicLong</code> ÂèØÂê¶‰∏ç‰ΩøÁî®‰∫ÜÂë¢ÔºüÊòØÂê¶Âá°ÊòØÁî®Âà∞ <code>AtomicLong </code>ÁöÑÂú∞ÊñπÔºåÈÉΩÂèØ‰ª•Áî®<code>LongAdder</code>ÊõøÊç¢ÊéâÂë¢ÔºüÁ≠îÊ°àÊòØ‰∏çÊòØÁöÑÔºåËøôÈúÄË¶ÅÂå∫ÂàÜÂú∫ÊôØ„ÄÇ</p>
<p><code>LongAdder</code> Âè™Êèê‰æõ‰∫Ü <code>add</code>„ÄÅ<code>increment</code> Á≠âÁÆÄÂçïÁöÑÊñπÊ≥ïÔºåÈÄÇÂêàÁöÑÊòØÁªüËÆ°Ê±ÇÂíåËÆ°Êï∞ÁöÑÂú∫ÊôØÔºåÂú∫ÊôØÊØîËæÉÂçï‰∏ÄÔºåËÄå <code>AtomicLong</code> ËøòÂÖ∑Êúâ <code>compareAndSet</code> Á≠âÈ´òÁ∫ßÊñπÊ≥ïÔºåÂèØ‰ª•Â∫îÂØπÈô§‰∫ÜÂä†Âáè‰πãÂ§ñÁöÑÊõ¥Â§çÊùÇÁöÑÈúÄË¶Å<code> CAS</code> ÁöÑÂú∫ÊôØ„ÄÇ</p>
<p>ÁªìËÆ∫ÔºöÂ¶ÇÊûúÊàë‰ª¨ÁöÑÂú∫ÊôØ‰ªÖ‰ªÖÊòØÈúÄË¶ÅÁî®Âà∞Âä†ÂíåÂáèÊìç‰ΩúÁöÑËØùÔºåÈÇ£‰πàÂèØ‰ª•Áõ¥Êé•‰ΩøÁî®Êõ¥È´òÊïàÁöÑ <code>LongAdder</code>Ôºå‰ΩÜÂ¶ÇÊûúÊàë‰ª¨ÈúÄË¶ÅÂà©Áî® <code>CAS</code> ÊØîÂ¶Ç<code>compareAndSet</code> Á≠âÊìç‰ΩúÁöÑËØùÔºåÂ∞±ÈúÄË¶Å‰ΩøÁî® <code>AtomicLong</code> Êù•ÂÆåÊàê„ÄÇ</p>
<blockquote>
<p>Áõ¥ËææÈìæÊé•Ôºö<a target="_blank" rel="noopener" href="https://mp.weixin.qq.com/s/5hDtf7siTCX3QPEAsbNPCA">Á™ÅÂáªÂπ∂ÂèëÁºñÁ®ãJUCÁ≥ªÂàó-JDK1.8 Êâ©Â±ïÁ±ªÂûã LongAdder</a></p>
</blockquote>
<h2 id="Âπ∂ÂèëÂ∑•ÂÖ∑-JUC"><a href="#Âπ∂ÂèëÂ∑•ÂÖ∑-JUC" class="headerlink" title="Âπ∂ÂèëÂ∑•ÂÖ∑ JUC"></a>Âπ∂ÂèëÂ∑•ÂÖ∑ JUC</h2><p><a target="_blank" rel="noopener" href="https://segmentfault.com/a/1190000037600050">https://segmentfault.com/a/1190000037600050</a></p>
<h3 id="CountDownLatch"><a href="#CountDownLatch" class="headerlink" title="CountDownLatch"></a>CountDownLatch</h3><p><code>CountDownLatch</code>Âü∫‰∫éÁ∫øÁ®ãËÆ°Êï∞Âô®Êù•ÂÆûÁé∞Âπ∂ÂèëËÆøÈóÆÊéßÂà∂Ôºå‰∏ªË¶ÅÁî®‰∫é‰∏ªÁ∫øÁ®ãÁ≠âÂæÖÂÖ∂‰ªñÂ≠êÁ∫øÁ®ãÈÉΩÊâßË°åÂÆåÊØïÂêéÊâßË°åÁõ∏ÂÖ≥Êìç‰Ωú„ÄÇÂÖ∂‰ΩøÁî®ËøáÁ®ã‰∏∫ÔºöÂú®‰∏ªÁ∫øÁ®ã‰∏≠ÂÆö‰πâ<code>CountDownLatch</code>ÔºåÂπ∂Â∞ÜÁ∫øÁ®ãËÆ°Êï∞Âô®ÁöÑÂàùÂßãÂÄºËÆæÁΩÆ‰∏∫Â≠êÁ∫øÁ®ãÁöÑ‰∏™Êï∞ÔºåÂ§ö‰∏™Â≠êÁ∫øÁ®ãÂπ∂ÂèëÊâßË°åÔºåÊØè‰∏™Â≠êÁ∫øÁ®ãÂú®ÊâßË°åÂÆåÊØïÂêéÈÉΩ‰ºöË∞ÉÁî®<code>countDown</code>ÂáΩÊï∞Â∞ÜËÆ°Êï∞Âô®ÁöÑÂÄºÂáè1ÔºåÁõ¥Âà∞Á∫øÁ®ãËÆ°Êï∞Âô®‰∏∫0ÔºåË°®Á§∫ÊâÄÊúâÁöÑÂ≠êÁ∫øÁ®ã‰ªªÂä°ÈÉΩÂ∑≤ÊâßË°åÂÆåÊØïÔºåÊ≠§Êó∂Âú®<code>CountDownLatch</code>‰∏äÁ≠âÂæÖÁöÑ‰∏ªÁ∫øÁ®ãÂ∞ÜË¢´Âî§ÈÜíÂπ∂ÁªßÁª≠ÊâßË°å„ÄÇ</p>
<blockquote>
<p><a target="_blank" rel="noopener" href="https://mp.weixin.qq.com/s/unPaVioEQIcW1Co1uyUpCg">Á™ÅÂáªÂπ∂ÂèëÁºñÁ®ãJUCÁ≥ªÂàó-Âπ∂ÂèëÂ∑•ÂÖ∑ CountDownLatch</a></p>
</blockquote>
<h3 id="CyclicBarrier"><a href="#CyclicBarrier" class="headerlink" title="CyclicBarrier"></a>CyclicBarrier</h3><p><code>CyclicBarrier</code>ÔºàÂæ™ÁéØÂ±èÈöúÔºâÊòØ‰∏Ä‰∏™ÂêåÊ≠•Â∑•ÂÖ∑ÔºåÂèØ‰ª•ÂÆûÁé∞ËÆ©‰∏ÄÁªÑÁ∫øÁ®ãÁ≠âÂæÖËá≥Êüê‰∏™Áä∂ÊÄÅ‰πãÂêéÂÜçÂÖ®ÈÉ®ÂêåÊó∂ÊâßË°å„ÄÇÂú®ÊâÄÊúâÁ≠âÂæÖÁ∫øÁ®ãÈÉΩË¢´ÈáäÊîæ‰πãÂêéÔºå<code>CyclicBarrier</code>ÂèØ‰ª•Ë¢´ÈáçÁî®„ÄÇ<code>CyclicBarrier</code>ÁöÑËøêË°åÁä∂ÊÄÅÂè´‰Ωú<code>Barrier</code>Áä∂ÊÄÅÔºåÂú®Ë∞ÉÁî®<code>await</code>ÊñπÊ≥ïÂêéÔºåÁ∫øÁ®ãÂ∞±Â§Ñ‰∫é<code>Barrier</code>Áä∂ÊÄÅ„ÄÇ</p>
<p><code>CyclicBarrier</code>‰∏≠ÊúÄÈáçË¶ÅÁöÑÊñπÊ≥ïÊòØawaitÊñπÊ≥ïÔºåÂÆÉÊúâ‰∏§ÁßçÂÆûÁé∞„ÄÇ</p>
<ul>
<li><code>public int await()</code>ÔºöÊåÇËµ∑ÂΩìÂâçÁ∫øÁ®ãÁõ¥Âà∞ÊâÄÊúâÁ∫øÁ®ãÈÉΩ‰∏∫BarrierÁä∂ÊÄÅÂÜçÂêåÊó∂ÊâßË°åÂêéÁª≠ÁöÑ‰ªªÂä°„ÄÇ</li>
<li><code>public int await(long timeout, TimeUnit unit)</code>ÔºöËÆæÁΩÆ‰∏Ä‰∏™Ë∂ÖÊó∂Êó∂Èó¥ÔºåÂú®Ë∂ÖÊó∂Êó∂Èó¥ËøáÂêéÔºåÂ¶ÇÊûúËøòÊúâÁ∫øÁ®ãÊú™ËææÂà∞<code>Barrier</code>Áä∂ÊÄÅÔºåÂàô‰∏çÂÜçÁ≠âÂæÖÔºåËÆ©ËææÂà∞BarrierÁä∂ÊÄÅÁöÑÁ∫øÁ®ãÁªßÁª≠ÊâßË°åÂêéÁª≠ÁöÑ‰ªªÂä°„ÄÇ</li>
</ul>
<blockquote>
<p><a target="_blank" rel="noopener" href="https://mp.weixin.qq.com/s/tvb3w1muV_qV9UJD99QDyw">Á™ÅÂáªÂπ∂ÂèëÁºñÁ®ãJUCÁ≥ªÂàó-Âπ∂ÂèëÂ∑•ÂÖ∑ CyclicBarrier</a></p>
</blockquote>
<h3 id="Semaphore"><a href="#Semaphore" class="headerlink" title="Semaphore"></a>Semaphore</h3><p><code>Semaphore</code>Êåá‰ø°Âè∑ÈáèÔºåÁî®‰∫éÊéßÂà∂ÂêåÊó∂ËÆøÈóÆÊüê‰∫õËµÑÊ∫êÁöÑÁ∫øÁ®ã‰∏™Êï∞ÔºåÂÖ∑‰ΩìÂÅöÊ≥ï‰∏∫ÈÄöËøáË∞ÉÁî®<code>acquire()</code>Ëé∑Âèñ‰∏Ä‰∏™ËÆ∏ÂèØÔºåÂ¶ÇÊûúÊ≤°ÊúâËÆ∏ÂèØÔºåÂàôÁ≠âÂæÖÔºåÂú®ËÆ∏ÂèØ‰ΩøÁî®ÂÆåÊØïÂêéÈÄöËøá<code>release()</code>ÈáäÊîæËØ•ËÆ∏ÂèØÔºå‰ª•‰æøÂÖ∂‰ªñÁ∫øÁ®ã‰ΩøÁî®„ÄÇ</p>
<blockquote>
<p><a target="_blank" rel="noopener" href="https://mp.weixin.qq.com/s/DipflI2wQghzx6LwT3OhRA">Á™ÅÂáªÂπ∂ÂèëÁºñÁ®ãJUCÁ≥ªÂàó-Âπ∂ÂèëÂ∑•ÂÖ∑ Semaphore</a></p>
</blockquote>
<h4 id="CyclicBarrier-Âíå-CountdownLatch-Êúâ‰ªÄ‰πàÂºÇÂêåÔºü"><a href="#CyclicBarrier-Âíå-CountdownLatch-Êúâ‰ªÄ‰πàÂºÇÂêåÔºü" class="headerlink" title="CyclicBarrier Âíå CountdownLatch Êúâ‰ªÄ‰πàÂºÇÂêåÔºü"></a>CyclicBarrier Âíå CountdownLatch Êúâ‰ªÄ‰πàÂºÇÂêåÔºü</h4><p>Áõ∏ÂêåÁÇπÔºöÈÉΩËÉΩÈòªÂ°û‰∏Ä‰∏™Êàñ‰∏ÄÁªÑÁ∫øÁ®ãÔºåÁõ¥Âà∞Êüê‰∏™È¢ÑËÆæÁöÑÊù°‰ª∂ËææÊàêÂèëÁîüÔºåÂÜçÁªü‰∏ÄÂá∫Âèë„ÄÇ<br>‰ΩÜÊòØÂÆÉ‰ª¨‰πüÊúâÂæàÂ§ö‰∏çÂêåÁÇπÔºåÂÖ∑‰ΩìÂ¶Ç‰∏ã„ÄÇ</p>
<ul>
<li>‰ΩúÁî®ÂØπË±°‰∏çÂêåÔºö<code>CyclicBarrier</code> Ë¶ÅÁ≠âÂõ∫ÂÆöÊï∞ÈáèÁöÑÁ∫øÁ®ãÈÉΩÂà∞Ëææ‰∫ÜÊ†ÖÊ†è‰ΩçÁΩÆÊâçËÉΩÁªßÁª≠ÊâßË°åÔºåËÄå <code>CountDownLatch</code> Âè™ÈúÄÁ≠âÂæÖÊï∞Â≠óÂÄíÊï∞Âà∞ 0Ôºå‰πüÂ∞±ÊòØËØ¥ <code>CountDownLatch</code> ‰ΩúÁî®‰∫é‰∫ã‰ª∂Ôºå‰ΩÜ <code>CyclicBarrier</code> ‰ΩúÁî®‰∫éÁ∫øÁ®ãÔºõ<code>CountDownLatch</code> ÊòØÂú®Ë∞ÉÁî®‰∫Ü <code>countDown</code> ÊñπÊ≥ï‰πãÂêéÊääÊï∞Â≠óÂÄíÊï∞Âáè 1ÔºåËÄå <code>CyclicBarrier</code> ÊòØÂú®ÊüêÁ∫øÁ®ãÂºÄÂßãÁ≠âÂæÖÂêéÊääËÆ°Êï∞Âáè 1„ÄÇ</li>
<li>ÂèØÈáçÁî®ÊÄß‰∏çÂêåÔºö<code>CountDownLatch</code> Âú®ÂÄíÊï∞Âà∞ 0 Âπ∂‰∏îËß¶ÂèëÈó®Èó©ÊâìÂºÄÂêéÔºåÂ∞±‰∏çËÉΩÂÜçÊ¨°‰ΩøÁî®‰∫ÜÔºåÈô§ÈùûÊñ∞Âª∫‰∏Ä‰∏™Êñ∞ÁöÑÂÆû‰æãÔºõËÄå <strong><code>CyclicBarrier</code> ÂèØ‰ª•ÈáçÂ§ç‰ΩøÁî®</strong>„ÄÇ<code>CyclicBarrier </code>ËøòÂèØ‰ª•ÈöèÊó∂Ë∞ÉÁî® reset ÊñπÊ≥ïËøõË°åÈáçÁΩÆÔºåÂ¶ÇÊûúÈáçÁΩÆÊó∂ÊúâÁ∫øÁ®ãÂ∑≤ÁªèË∞ÉÁî®‰∫Ü await ÊñπÊ≥ïÂπ∂ÂºÄÂßãÁ≠âÂæÖÔºåÈÇ£‰πàËøô‰∫õÁ∫øÁ®ãÂàô‰ºöÊäõÂá∫ <code>BrokenBarrierException </code>ÂºÇÂ∏∏„ÄÇ</li>
<li>ÊâßË°åÂä®‰Ωú‰∏çÂêåÔºö<code>CyclicBarrier</code> ÊúâÊâßË°åÂä®‰Ωú <code>barrierAction</code>ÔºåËÄå <code>CountDownLatch </code>Ê≤°Ëøô‰∏™ÂäüËÉΩ„ÄÇ</li>
</ul>
<h3 id="CountDownLatch„ÄÅCyclicBarrier„ÄÅSemaphoreÁöÑÂå∫Âà´Â¶Ç‰∏ã„ÄÇ"><a href="#CountDownLatch„ÄÅCyclicBarrier„ÄÅSemaphoreÁöÑÂå∫Âà´Â¶Ç‰∏ã„ÄÇ" class="headerlink" title="CountDownLatch„ÄÅCyclicBarrier„ÄÅSemaphoreÁöÑÂå∫Âà´Â¶Ç‰∏ã„ÄÇ"></a>CountDownLatch„ÄÅCyclicBarrier„ÄÅSemaphoreÁöÑÂå∫Âà´Â¶Ç‰∏ã„ÄÇ</h3><ul>
<li><code>CountDownLatch</code>Âíå<code>CyclicBarrier</code>ÈÉΩÁî®‰∫éÂÆûÁé∞Â§öÁ∫øÁ®ã‰πãÈó¥ÁöÑÁõ∏‰∫íÁ≠âÂæÖÔºå‰ΩÜ‰∫åËÄÖÁöÑÂÖ≥Ê≥®ÁÇπ‰∏çÂêå„ÄÇ<code>CountDownLatch</code>‰∏ªË¶ÅÁî®‰∫é‰∏ªÁ∫øÁ®ãÁ≠âÂæÖÂÖ∂‰ªñÂ≠êÁ∫øÁ®ã‰ªªÂä°ÂùáÊâßË°åÂÆåÊØïÂêéÂÜçÊâßË°åÊé•‰∏ãÊù•ÁöÑ‰∏öÂä°ÈÄªËæëÂçïÂÖÉÔºåËÄå<code>CyclicBarrier</code>‰∏ªË¶ÅÁî®‰∫é‰∏ÄÁªÑÁ∫øÁ®ã‰∫íÁõ∏Á≠âÂæÖÂ§ßÂÆ∂ÈÉΩËææÂà∞Êüê‰∏™Áä∂ÊÄÅÂêéÔºåÂÜçÂêåÊó∂ÊâßË°åÊé•‰∏ãÊù•ÁöÑ‰∏öÂä°ÈÄªËæëÂçïÂÖÉ„ÄÇÊ≠§Â§ñÔºå<code>CountDownLatch</code>ÊòØ‰∏çÂèØ‰ª•ÈáçÁî®ÁöÑÔºåËÄå<code>CyclicBarrier</code>ÊòØÂèØ‰ª•ÈáçÁî®ÁöÑ„ÄÇ</li>
<li><code>Semaphore</code>Âíå<code>Java</code>‰∏≠ÁöÑÈîÅÂäüËÉΩÁ±ª‰ººÔºå‰∏ªË¶ÅÁî®‰∫éÊéßÂà∂ËµÑÊ∫êÁöÑÂπ∂ÂèëËÆøÈóÆ„ÄÇ</li>
</ul>
<h2 id="ÈòªÂ°ûÈòüÂàó"><a href="#ÈòªÂ°ûÈòüÂàó" class="headerlink" title="ÈòªÂ°ûÈòüÂàó"></a>ÈòªÂ°ûÈòüÂàó</h2><p><a target="_blank" rel="noopener" href="https://mp.weixin.qq.com/s/w5MRjG59Sjnwi5g4lCEo5w">https://mp.weixin.qq.com/s/w5MRjG59Sjnwi5g4lCEo5w</a></p>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/dl674756321/article/details/100155641">https://blog.csdn.net/dl674756321/article/details/100155641</a></p>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/luzhensmart/article/details/81712583">https://blog.csdn.net/luzhensmart/article/details/81712583</a></p>
<p>ÈòªÂ°ûÈòüÂàóÔºà<code>BlockingQueue</code>ÔºâÊòØ‰∏Ä‰∏™ÊîØÊåÅ‰∏§‰∏™ÈôÑÂä†Êìç‰ΩúÁöÑÈòüÂàó„ÄÇËøô‰∏§‰∏™ÈôÑÂä†ÁöÑÊìç‰ΩúÊîØÊåÅÈòªÂ°ûÁöÑÊèíÂÖ•ÂíåÁßªÈô§ÊñπÊ≥ï„ÄÇ</p>
<ul>
<li>ÊîØÊåÅÈòªÂ°ûÁöÑÊèíÂÖ•ÊñπÊ≥ïÔºöÊÑèÊÄùÊòØÂΩìÈòüÂàóÊª°Êó∂ÔºåÈòüÂàó‰ºöÈòªÂ°ûÊèíÂÖ•ÂÖÉÁ¥†ÁöÑÁ∫øÁ®ãÔºåÁõ¥Âà∞ÈòüÂàó‰∏çÊª°„ÄÇ</li>
<li>ÊîØÊåÅÈòªÂ°ûÁöÑÁßªÈô§ÊñπÊ≥ïÔºöÊÑèÊÄùÊòØÂú®ÈòüÂàó‰∏∫Á©∫Êó∂ÔºåËé∑ÂèñÂÖÉÁ¥†ÁöÑÁ∫øÁ®ã‰ºöÁ≠âÂæÖÈòüÂàóÂèò‰∏∫ÈùûÁ©∫„ÄÇ</li>
</ul>
<p><strong>ÈòªÂ°ûÈòüÂàóÂ∏∏Áî®‰∫éÁîü‰∫ßËÄÖÂíåÊ∂àË¥πËÄÖÁöÑÂú∫ÊôØ</strong>ÔºåÁîü‰∫ßËÄÖÊòØÂêëÈòüÂàóÈáåÊ∑ªÂä†ÂÖÉÁ¥†ÁöÑÁ∫øÁ®ãÔºåÊ∂àË¥πËÄÖÊòØ‰ªéÈòüÂàóÈáåÂèñÂÖÉÁ¥†ÁöÑÁ∫øÁ®ã„ÄÇÈòªÂ°ûÈòüÂàóÂ∞±ÊòØÁîü‰∫ßËÄÖÁî®Êù•Â≠òÊîæÂÖÉÁ¥†„ÄÅÊ∂àË¥πËÄÖÁî®Êù•Ëé∑ÂèñÂÖÉÁ¥†ÁöÑÂÆπÂô®„ÄÇ</p>
<table>
<thead>
<tr>
<th align="left">ÊñπÊ≥ï/Â§ÑÁêÜÊñπÂºè</th>
<th align="left">ÊäõÂá∫ÂºÇÂ∏∏</th>
<th align="left">ËøîÂõûÁâπÊÆäÂÄº</th>
<th align="left">‰∏ÄÁõ¥ÈòªÂ°û</th>
<th align="left">Ë∂ÖÊó∂ÈÄÄÂá∫</th>
</tr>
</thead>
<tbody><tr>
<td align="left">ÊèíÂÖ•ÊñπÊ≥ï</td>
<td align="left">add(e)</td>
<td align="left">offer(e)</td>
<td align="left">put(e)</td>
<td align="left">offer(e,time,unit)</td>
</tr>
<tr>
<td align="left">ÁßªÈô§ÊñπÊ≥ï</td>
<td align="left">remove()</td>
<td align="left">poll()</td>
<td align="left">take()</td>
<td align="left">poll(time,unit)</td>
</tr>
<tr>
<td align="left">Ê£ÄÊü•ÊñπÊ≥ï</td>
<td align="left">element()</td>
<td align="left">peek()</td>
<td align="left">‰∏çÂèØÁî®</td>
<td align="left">‰∏çÂèØÁî®</td>
</tr>
</tbody></table>
<ul>
<li>ÊäõÂá∫ÂºÇÂ∏∏ÔºöÂΩìÈòüÂàóÊª°Êó∂ÔºåÂ¶ÇÊûúÂÜçÂæÄÈòüÂàóÈáåÊèíÂÖ•ÂÖÉÁ¥†Ôºå‰ºöÊäõÂá∫ <code>IllegalStateException</code> Ôºà‚ÄùQueue full‚ÄùÔºâÂºÇÂ∏∏„ÄÇÂΩìÈòüÂàóÁ©∫Êó∂Ôºå‰ªéÈòüÂàóÈáåËé∑ÂèñÂÖÉÁ¥†‰ºöÊäõÂá∫<code>NoSuchElementException</code> ÂºÇÂ∏∏„ÄÇ</li>
<li>ËøîÂõûÁâπÊÆäÂÄºÔºöÂΩìÂæÄÈòüÂàóÊèíÂÖ•ÂÖÉÁ¥†Êó∂Ôºå‰ºöËøîÂõûÂÖÉÁ¥†ÊòØÂê¶ÊèíÂÖ•ÊàêÂäüÔºåÊàêÂäüËøîÂõûtrue„ÄÇÂ¶ÇÊûúÊòØÁßªÈô§ÊñπÊ≥ïÔºåÂàôÊòØ‰ªéÈòüÂàóÈáåÂèñÂá∫‰∏Ä‰∏™ÂÖÉÁ¥†ÔºåÂ¶ÇÊûúÊ≤°ÊúâÂàôËøîÂõû null „ÄÇ</li>
<li>‰∏ÄÁõ¥ÈòªÂ°ûÔºöÂΩìÈòªÂ°ûÈòüÂàóÊª°Êó∂ÔºåÂ¶ÇÊûúÁîü‰∫ßËÄÖÁ∫øÁ®ãÂæÄÈòüÂàóÈáå put ÂÖÉÁ¥†ÔºåÈòüÂàó‰ºö‰∏ÄÁõ¥ÈòªÂ°ûÁîü‰∫ßËÄÖÁ∫øÁ®ãÔºåÁõ¥Âà∞ÈòüÂàóÂèØÁî®ÊàñËÄÖÂìçÂ∫î‰∏≠Êñ≠ÈÄÄÂá∫„ÄÇÂΩìÈòüÂàóÁ©∫Êó∂ÔºåÂ¶ÇÊûúÊ∂àË¥πËÄÖÁ∫øÁ®ã‰ªéÈòüÂàóÈáå take ÂÖÉÁ¥†ÔºåÈòüÂàó‰ºöÈòªÂ°û‰ΩèÊ∂àË¥πËÄÖÁ∫øÁ®ãÔºåÁõ¥Âà∞ÈòüÂàó‰∏ç‰∏∫Á©∫„ÄÇ</li>
<li>Ë∂ÖÊó∂ÈÄÄÂá∫ÔºöÂΩìÈòªÂ°ûÈòüÂàóÊª°Êó∂ÔºåÂ¶ÇÊûúÁîü‰∫ßËÄÖÁ∫øÁ®ãÂæÄÈòüÂàóÈáåÊèíÂÖ•ÂÖÉÁ¥†ÔºåÈòüÂàó‰ºöÈòªÂ°ûÁîü‰∫ßËÄÖÁ∫øÁ®ã‰∏ÄÊÆµÊó∂Èó¥ÔºåÂ¶ÇÊûúË∂ÖËøá‰∫ÜÊåáÂÆöÁöÑÊó∂Èó¥ÔºåÁîü‰∫ßËÄÖÁ∫øÁ®ãÂ∞±‰ºöÈÄÄÂá∫„ÄÇ</li>
</ul>
<blockquote>
<p>Â¶ÇÊûúÊòØÊó†ÁïåÈòªÂ°ûÈòüÂàóÔºåÈòüÂàó‰∏çÂèØËÉΩ‰ºöÂá∫Áé∞Êª°ÁöÑÊÉÖÂÜµÔºåÊâÄ‰ª•‰ΩøÁî® put Êàñ offer ÊñπÊ≥ïÊ∞∏Ëøú‰∏ç‰ºöË¢´ÈòªÂ°ûÔºåËÄå‰∏î‰ΩøÁî®offerÊñπÊ≥ïÊó∂ÔºåËØ•ÊñπÊ≥ïÊ∞∏ËøúËøîÂõû true„ÄÇ</p>
</blockquote>
<h3 id="Âàó‰∏æÂá†‰∏™Â∏∏ËßÅÁöÑÈòªÂ°ûÈòüÂàó"><a href="#Âàó‰∏æÂá†‰∏™Â∏∏ËßÅÁöÑÈòªÂ°ûÈòüÂàó" class="headerlink" title="Âàó‰∏æÂá†‰∏™Â∏∏ËßÅÁöÑÈòªÂ°ûÈòüÂàó"></a>Âàó‰∏æÂá†‰∏™Â∏∏ËßÅÁöÑÈòªÂ°ûÈòüÂàó</h3><ul>
<li><code>ArrayBlockingQueue</code>ÔºöÈááÁî®<strong>Êï∞ÁªÑ</strong>ÂÆûÁé∞ÁöÑÊúâÁïåÈòªÂ°ûÈòüÂàóÔºåÊåâÁÖßÂÖàËøõÂÖàÂá∫ÁöÑÂéüÂàôÔºåÂàùÂßãÂåñÊó∂ÔºåÈúÄË¶ÅÊåáÂÆöÂÆπÈáèÁöÑÂ§ßÂ∞èÔºå‰∏ÄÊó¶ÂàõÂª∫ÔºåÂÆπÈáèÂ∞±‰∏çËÉΩÊîπÂèò„ÄÇÈááÁî®ÂèØÈáçÂÖ•ÈîÅËøõË°åÂπ∂ÂèëÊéßÂà∂ÔºåÊ∑ªÂä†ÂíåÂà†Èô§Êìç‰ΩúÈááÁî®ÁöÑÊòØÂêå‰∏Ä‰∏™ÈîÅ„ÄÇ</li>
<li><code>LinkedBlockingQueue</code>ÔºöÈááÁî®<strong>ÂçïÂêëÈìæË°®</strong>ÂÆûÁé∞ÁöÑÈòªÂ°ûÈòüÂàóÔºåÂèØ‰ª•Êó†Áïå‰πüÂèØ‰ª•ÊúâÁïåÔºåÊåâÁÖßÂÖàËøõÂÖàÂá∫ÁöÑÂéüÂàôÔºåÈªòËÆ§ÂÆπÈáè‰∏∫ Integer.MAX_VALUE„ÄÇÈîÅÊòØÂàÜÁ¶ªÁöÑÔºåÊ∑ªÂä†ÂíåÂà†Èô§Êìç‰Ωú‰ΩøÁî®‰∏§‰∏™‰∏çÂêåÁöÑÈîÅÔºåÂú®È´òÂπ∂ÂèëÂú∫ÊôØ‰∏ãÔºåÁîü‰∫ßËÄÖÂíåÊ∂àË¥πËÄÖÂèØ‰ª•Âπ∂Ë°åÁöÑÊìç‰ΩúÈòüÂàó‰∏≠ÁöÑÊï∞ÊçÆÔºåÊâÄ‰ª•ÊèêÈ´ò‰∫ÜÂπ∂ÂèëÊÄßËÉΩ„ÄÇ</li>
<li><code>PriorityBlockingQueue</code>Ôºö‰∏Ä‰∏™ÊîØÊåÅ‰ºòÂÖàÁ∫ßÊéíÂ∫èÁöÑÊó†ÁïåÈòªÂ°ûÈòüÂàó„ÄÇÂèØ‰ª•ÈÄöËøáÂÆûÁé∞ compareTo ÊñπÊ≥ïÊù•ÊåáÂÆöÂÖÉÁ¥†ÊØîËæÉËßÑÂàôÔºå‰πüÂèØ‰ª•‰ΩøÁî® Comparator ÊØîËæÉÂô®Êù•ÊåáÂÆöÊØîËæÉËßÑÂàô„ÄÇ</li>
<li><code>SynchronousQueue</code>Ôºö‰∏Ä‰∏™‰∏çÂ≠òÂÇ®ÂÖÉÁ¥†ÁöÑÈòªÂ°ûÈòüÂàó„ÄÇÈÄöËøáÊñ∞Âª∫‰∏Ä‰∏™Á∫øÁ®ãÊù•Â§ÑÁêÜÊñ∞‰ªªÂä°„ÄÇÊòØ‰∏ÄÁßçËΩªÈáèÁ∫ßÁöÑArrayBlockingQueueÔºåÂú®Âè™Êúâ‰∏Ä‰∏™Áîü‰∫ßËÄÖÂíå‰∏Ä‰∏™Ê∂àË¥πËÄÖÁöÑÂú∫ÊôØ‰∏ãÊÄßËÉΩËæÉÂ•Ω„ÄÇ</li>
<li><code>DelayQueue</code>ÔºöÊòØ‰∏Ä‰∏™ÊîØÊåÅÂª∂Êó∂Ëé∑ÂèñÂÖÉÁ¥†ÁöÑÊó†ÁïåÈòªÂ°ûÈòüÂàó„ÄÇÈòüÂàó‰ΩøÁî®<code>PriorityQueue</code>Êù•ÂÆûÁé∞„ÄÇÈòüÂàó‰∏≠ÁöÑÂÖÉÁ¥†ÂøÖÈ°ªÂÆûÁé∞<code>Delayed</code>Êé•Âè£ÔºåÂú®ÂàõÂª∫ÂÖÉÁ¥†Êó∂ÂèØ‰ª•ÊåáÂÆöÂ§ö‰πÖÊâçËÉΩ‰ªéÈòüÂàó‰∏≠Ëé∑ÂèñÂΩìÂâçÂÖÉÁ¥†„ÄÇÂè™ÊúâÂú®Âª∂ËøüÊúüÊª°Êó∂ÊâçËÉΩ‰ªéÈòüÂàó‰∏≠ÊèêÂèñÂÖÉÁ¥†„ÄÇ<strong>Â∫îÁî®Âú∫ÊôØÔºö</strong> ÁºìÂ≠òÁ≥ªÁªüÔºåËÆæÁΩÆÁºìÂ≠òÂÖÉÁ¥†ÁöÑÊúâÊïàÊúüÔºõÂÆöÊó∂‰ªªÂä°Ë∞ÉÂ∫¶„ÄÇ</li>
<li><code>LinkedTransferQueue</code>Ôºö‰∏Ä‰∏™Áî±ÈìæË°®ÁªìÊûÑÁªÑÊàêÁöÑÊó†ÁïåÈòªÂ°ûÈòüÂàó„ÄÇ</li>
<li><code>LinkedBlockingDeque</code>Ôºö‰∏Ä‰∏™Áî±ÈìæË°®ÁªìÊûÑÁªÑÊàêÁöÑÂèåÂêëÈòªÂ°ûÈòüÂàó„ÄÇ</li>
</ul>
<h3 id="LinkedBlockingQueueÂíåArrayBlockingQueueÁöÑÂå∫Âà´"><a href="#LinkedBlockingQueueÂíåArrayBlockingQueueÁöÑÂå∫Âà´" class="headerlink" title="LinkedBlockingQueueÂíåArrayBlockingQueueÁöÑÂå∫Âà´"></a>LinkedBlockingQueueÂíåArrayBlockingQueueÁöÑÂå∫Âà´</h3><p><strong>ÂÖ±ÊÄßÔºö</strong></p>
<p>ÂÆÉ‰ª¨ÈÉΩÁªßÊâø‰∫ÜBlockingQueueÁöÑÊé•Âè£Ôºå‰πüÂ∞±ÊòØËØ¥ÔºåÂÆÉ‰ª¨ÈÉΩÊòØÈòªÂ°ûÂºèÁöÑÈòüÂàóÔºåËøôÈáåÁöÑÈòªÂ°ûÊÉÖÂÜµÊó†Â§ñ‰πé2ÁßçÔºö‰∏ÄÁßçÊòØÈòüÂàóÊª°Êó∂ÈòªÂ°ûÁ≠âÂæÖÔºåÂè¶‰∏ÄÁßçÂ∞±ÊòØÈòüÂàóÁ©∫Êó∂ÈòªÂ°ûÁ≠âÂæÖÔºåÂâçËÄÖÁ≠âÂæÖÁöÑÁîüÊàêËÄÖÔºåÂêéËÄÖÂàôÊòØÊ∂àË¥πËÄÖ„ÄÇÊâÄ‰ª•ËøôÁßçÁªìÊûÑÁî®Âú®Áîü‰∫ßËÄÖ-Ê∂àË¥πËÄÖÁöÑ‰ΩøÁî®Âú∫ÊôØ‰∏≠ÊòØÊØîËæÉÈÄÇÁî®ÁöÑ„ÄÇËøòÊúâ‰∏ÄÁÇπÔºåÂõ†‰∏∫ÊòØÈòüÂàóÔºåÊâÄ‰ª•ËÇØÂÆö‰øùËØÅFIFOÈ°∫Â∫èÊÄßÁöÑ„ÄÇ</p>
<p>ÂÆÉ‰ª¨ÊâÄÂØπÂ§ñÊèê‰æõÁöÑÊñπÊ≥ï‰πüÊòØ‰∏ÄËá¥ÁöÑÔºåadd/offer/putÔºåtake/poll/remove„ÄÇËøôÈáåÈù¢ËøòËÉΩÂ§üÊîØÊåÅÈòªÂ°ûÔºåÈùûÈòªÂ°ûÁöÑË∞ÉÁî®ÂΩ¢ÂºèÔºåÊÄª‰ΩìÊù•ËØ¥ËøòÊòØÈùûÂ∏∏ÁÅµÊ¥ªÁöÑ„ÄÇ</p>
<p><strong>Âå∫Âà´Ôºö</strong></p>
<p>ArrayBlockingQueueÊòØÊúâÁïåÁöÑÔºåËÄåLinkedBlockingQueueÈªòËÆ§ÊòØÊó†ÁïåÁöÑÔºàÂèØ‰ª•ÈÄöËøáÊåáÂÆöÂ§ßÂ∞èÊù•Âèò‰∏∫ÊúâÁïåÔºâ„ÄÇArrayBlockingQueueÊúâÁïåÂ∞±ÊÑèÂë≥ÁùÄÊàë‰ª¨‰ΩøÁî®ArrayBlockingQueueÂøÖÈ°ªÊåáÂÆöcapacityÂ§ßÂ∞è„ÄÇËøôÊ†∑ÁöÑËØùÔºåÂÜÖÂ≠òÁ©∫Èó¥‰ºöÁõ¥Êé•È¢ÑÂÖàÂàÜÈÖçÂ•ΩÔºåÊâÄ‰ª•Âú®‰ΩøÁî®LinkedBlockingQueueÊó†ÁïåÊÉÖÂÜµ‰∏ãÊó∂Ë¶ÅËÄÉËôëÂà∞ÂÜÖÂ≠òÂÆûÈôÖ‰ΩøÁî®ÈóÆÈ¢òÔºåÈò≤Ê≠¢ÂÜÖÂ≠òÊ∫¢Âá∫ÈóÆÈ¢òÁöÑÂèëÁîü„ÄÇ</p>
<p>ÈîÅ‰ΩøÁî®ÁöÑÊØîËæÉ„ÄÇArrayBlockingQueueÂÜÖÈÉ®‰ΩøÁî®1‰∏™ÈîÅÊù•ÊéßÂà∂ÈòüÂàóÈ°πÁöÑÊèíÂÖ•„ÄÅÂèñÂá∫Êìç‰ΩúÔºåËÄåLinkedBlockingQueueÂàôÊòØ‰ΩøÁî®‰∫Ü2‰∏™ÈîÅÊù•ÊéßÂà∂Ôºå‰∏Ä‰∏™Âêç‰∏∫putLockÔºåÂè¶‰∏Ä‰∏™ÊòØtakeLockÔºå‰ΩÜÊòØÈîÅÁöÑÊú¨Ë¥®ÈÉΩÊòØReentrantLock„ÄÇÂõ†‰∏∫LinkedBlockingQueue‰ΩøÁî®‰∫Ü2‰∏™ÈîÅÁöÑÊÉÖÂÜµ‰∏ãÔºåÊâÄ‰ª•Âú®‰∏ÄÂÆöÁ®ãÂ∫¶‰∏äLinkedBlockingQueueËÉΩÊõ¥Â•ΩÊîØÊåÅÈ´òÂπ∂ÂèëÁöÑÂú∫ÊôØÊìç‰ΩúÔºåËøôÈáåÊåáÁöÑÊòØÂπ∂ÂèëÊÄß‰∏äÔºå‰∏çÊòØÂêûÂêêÈáè„ÄÇ</p>
<h2 id="Âπ∂ÂèëÁõ∏ÂÖ≥È¢òÁõÆ"><a href="#Âπ∂ÂèëÁõ∏ÂÖ≥È¢òÁõÆ" class="headerlink" title="Âπ∂ÂèëÁõ∏ÂÖ≥È¢òÁõÆ"></a>Âπ∂ÂèëÁõ∏ÂÖ≥È¢òÁõÆ</h2><p>Â§öÁ∫øÁ®ã‰πãÈó¥ÊåâÈ°∫Â∫èË∞ÉÁî®ÔºåÂÆûÁé∞ A ‚Äì&gt; B ‚Äì&gt; C ‰∏â‰∏™Á∫øÁ®ãÂêØÂä®ÔºåË¶ÅÊ±ÇÂ¶Ç‰∏ãÔºö</p>
<p>AÊâìÂç∞5Ê¨°ÔºåBÊâìÂç∞10Ê¨°ÔºåCÊâìÂç∞15Ê¨°</p>
<p>Êé•ÁùÄ</p>
<p>AÊâìÂç∞5Ê¨°ÔºåBÊâìÂç∞10Ê¨°ÔºåCÊâìÂç∞15Ê¨°</p>
<p>„ÄÇ„ÄÇ„ÄÇ</p>
<p>Êù•10ËΩÆ</p>

  
  
  <div class="footer">
      <script src="//m.servedby-buysellads.com/monetization.js" type="text/javascript"></script>
<div id="bsa-native"></div>
<script>
_bsa.init('custom', 'CKYD62QM', 'placement:vuejsorg',
  {
    target: '#bsa-native',
    template: '<a class="native-box" href="##statlink##"><div class="native-sponsor">Sponsor</div><div class="native-text"><strong>##company##</strong> ‚Äî ##description##</div></a>'
  }
);
</script>


    Caught a mistake or want to contribute to the documentation?
    <a href="https://github.com/vuejs/vuejs.org/blob/master/src/data/Java/java_concurrent.md" rel="noopener" target="_blank">
      Edit this on GitHub!
    </a>
    <!-- Deployed on
    <a href="https://url.netlify.com/HJ8X2mxP8" rel="noopener" target="_blank">
      Netlify
    </a>. -->
  </div>
</div>

      </div>
      <script src="/js/smooth-scroll.min.js"></script>
    

    <!-- main custom script for sidebars, version selects etc. -->
    <script src="/js/css.escape.js"></script>
    <script src="/js/common.js"></script>

    <!-- search -->
    <link href="https://cdn.jsdelivr.net/docsearch.js/1/docsearch.min.css" rel='stylesheet' type='text/css'>
    
<link rel="stylesheet" href="/css/search.css">

    <script src="https://cdn.jsdelivr.net/docsearch.js/1/docsearch.min.js"></script>
    <script>
    [
      '#search-query-nav',
      '#search-query-sidebar',
      '#search-query-menu'
    ].forEach(function (selector) {
      if (!document.querySelector(selector)) return
      // search index defaults to v2
      var match = window.location.pathname.match(/^\/(v\d+)/)
      var version = match ? match[1] : 'v2'
      docsearch({
      appId: 'BH4D9OD16A',
      apiKey: '85cc3221c9f23bfbaa4e3913dd7625ea',
      indexName: 'vuejs',
      inputSelector: selector,
      algoliaOptions: { facetFilters: ["version:" + version] },
      autocompleteOptions: { hint: false, appendTo: 'body'}
      })
    })
    </script>
  </body>
</html>
